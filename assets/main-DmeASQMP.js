var Fs=Object.defineProperty;var Ls=(t,n,o)=>n in t?Fs(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;var Nn=(t,n,o)=>Ls(t,typeof n!="symbol"?n+"":n,o);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))i(u);new MutationObserver(u=>{for(const c of u)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function o(u){const c={};return u.integrity&&(c.integrity=u.integrity),u.referrerPolicy&&(c.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?c.credentials="include":u.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(u){if(u.ep)return;u.ep=!0;const c=o(u);fetch(u.href,c)}})();var Zr=!1,ti=!1,fe=[],ei=-1;function Ns(t){Ks(t)}function Ks(t){fe.includes(t)||fe.push(t),qs()}function Bs(t){let n=fe.indexOf(t);n!==-1&&n>ei&&fe.splice(n,1)}function qs(){!ti&&!Zr&&(Zr=!0,queueMicrotask(Hs))}function Hs(){Zr=!1,ti=!0;for(let t=0;t<fe.length;t++)fe[t](),ei=t;fe.length=0,ei=-1,ti=!1}var Ie,ye,$e,qo,ni=!0;function Us(t){ni=!1,t(),ni=!0}function Ws(t){Ie=t.reactive,$e=t.release,ye=n=>t.effect(n,{scheduler:o=>{ni?Ns(o):o()}}),qo=t.raw}function So(t){ye=t}function zs(t){let n=()=>{};return[i=>{let u=ye(i);return t._x_effects||(t._x_effects=new Set,t._x_runEffects=()=>{t._x_effects.forEach(c=>c())}),t._x_effects.add(u),n=()=>{u!==void 0&&(t._x_effects.delete(u),$e(u))},u},()=>{n()}]}function Ho(t,n){let o=!0,i,u=ye(()=>{let c=t();JSON.stringify(c),o?i=c:queueMicrotask(()=>{n(c,i),i=c}),o=!1});return()=>$e(u)}var Uo=[],Wo=[],zo=[];function Js(t){zo.push(t)}function vi(t,n){typeof n=="function"?(t._x_cleanups||(t._x_cleanups=[]),t._x_cleanups.push(n)):(n=t,Wo.push(n))}function Jo(t){Uo.push(t)}function Vo(t,n,o){t._x_attributeCleanups||(t._x_attributeCleanups={}),t._x_attributeCleanups[n]||(t._x_attributeCleanups[n]=[]),t._x_attributeCleanups[n].push(o)}function Yo(t,n){t._x_attributeCleanups&&Object.entries(t._x_attributeCleanups).forEach(([o,i])=>{(n===void 0||n.includes(o))&&(i.forEach(u=>u()),delete t._x_attributeCleanups[o])})}function Vs(t){for(t._x_effects?.forEach(Bs);t._x_cleanups?.length;)t._x_cleanups.pop()()}var wi=new MutationObserver(xi),bi=!1;function _i(){wi.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),bi=!0}function Go(){Ys(),wi.disconnect(),bi=!1}var Qe=[];function Ys(){let t=wi.takeRecords();Qe.push(()=>t.length>0&&xi(t));let n=Qe.length;queueMicrotask(()=>{if(Qe.length===n)for(;Qe.length>0;)Qe.shift()()})}function st(t){if(!bi)return t();Go();let n=t();return _i(),n}var Si=!1,Vn=[];function Gs(){Si=!0}function Xs(){Si=!1,xi(Vn),Vn=[]}function xi(t){if(Si){Vn=Vn.concat(t);return}let n=[],o=new Set,i=new Map,u=new Map;for(let c=0;c<t.length;c++)if(!t[c].target._x_ignoreMutationObserver&&(t[c].type==="childList"&&(t[c].removedNodes.forEach(d=>{d.nodeType===1&&d._x_marker&&o.add(d)}),t[c].addedNodes.forEach(d=>{if(d.nodeType===1){if(o.has(d)){o.delete(d);return}d._x_marker||n.push(d)}})),t[c].type==="attributes")){let d=t[c].target,h=t[c].attributeName,m=t[c].oldValue,T=()=>{i.has(d)||i.set(d,[]),i.get(d).push({name:h,value:d.getAttribute(h)})},O=()=>{u.has(d)||u.set(d,[]),u.get(d).push(h)};d.hasAttribute(h)&&m===null?T():d.hasAttribute(h)?(O(),T()):O()}u.forEach((c,d)=>{Yo(d,c)}),i.forEach((c,d)=>{Uo.forEach(h=>h(d,c))});for(let c of o)n.some(d=>d.contains(c))||Wo.forEach(d=>d(c));for(let c of n)c.isConnected&&zo.forEach(d=>d(c));n=null,o=null,i=null,u=null}function Xo(t){return sn(Pe(t))}function an(t,n,o){return t._x_dataStack=[n,...Pe(o||t)],()=>{t._x_dataStack=t._x_dataStack.filter(i=>i!==n)}}function Pe(t){return t._x_dataStack?t._x_dataStack:typeof ShadowRoot=="function"&&t instanceof ShadowRoot?Pe(t.host):t.parentNode?Pe(t.parentNode):[]}function sn(t){return new Proxy({objects:t},Qs)}var Qs={ownKeys({objects:t}){return Array.from(new Set(t.flatMap(n=>Object.keys(n))))},has({objects:t},n){return n==Symbol.unscopables?!1:t.some(o=>Object.prototype.hasOwnProperty.call(o,n)||Reflect.has(o,n))},get({objects:t},n,o){return n=="toJSON"?Zs:Reflect.get(t.find(i=>Reflect.has(i,n))||{},n,o)},set({objects:t},n,o,i){const u=t.find(d=>Object.prototype.hasOwnProperty.call(d,n))||t[t.length-1],c=Object.getOwnPropertyDescriptor(u,n);return c?.set&&c?.get?c.set.call(i,o)||!0:Reflect.set(u,n,o)}};function Zs(){return Reflect.ownKeys(this).reduce((n,o)=>(n[o]=Reflect.get(this,o),n),{})}function Qo(t){let n=i=>typeof i=="object"&&!Array.isArray(i)&&i!==null,o=(i,u="")=>{Object.entries(Object.getOwnPropertyDescriptors(i)).forEach(([c,{value:d,enumerable:h}])=>{if(h===!1||d===void 0||typeof d=="object"&&d!==null&&d.__v_skip)return;let m=u===""?c:`${u}.${c}`;typeof d=="object"&&d!==null&&d._x_interceptor?i[c]=d.initialize(t,m,c):n(d)&&d!==i&&!(d instanceof Element)&&o(d,m)})};return o(t)}function Zo(t,n=()=>{}){let o={initialValue:void 0,_x_interceptor:!0,initialize(i,u,c){return t(this.initialValue,()=>tu(i,u),d=>ri(i,u,d),u,c)}};return n(o),i=>{if(typeof i=="object"&&i!==null&&i._x_interceptor){let u=o.initialize.bind(o);o.initialize=(c,d,h)=>{let m=i.initialize(c,d,h);return o.initialValue=m,u(c,d,h)}}else o.initialValue=i;return o}}function tu(t,n){return n.split(".").reduce((o,i)=>o[i],t)}function ri(t,n,o){if(typeof n=="string"&&(n=n.split(".")),n.length===1)t[n[0]]=o;else{if(n.length===0)throw error;return t[n[0]]||(t[n[0]]={}),ri(t[n[0]],n.slice(1),o)}}var ta={};function Dt(t,n){ta[t]=n}function ii(t,n){let o=eu(n);return Object.entries(ta).forEach(([i,u])=>{Object.defineProperty(t,`$${i}`,{get(){return u(n,o)},enumerable:!1})}),t}function eu(t){let[n,o]=aa(t),i={interceptor:Zo,...n};return vi(t,o),i}function nu(t,n,o,...i){try{return o(...i)}catch(u){on(u,t,n)}}function on(t,n,o=void 0){t=Object.assign(t??{message:"No error message given."},{el:n,expression:o}),console.warn(`Alpine Expression Error: ${t.message}

${o?'Expression: "'+o+`"

`:""}`,n),setTimeout(()=>{throw t},0)}var Wn=!0;function ea(t){let n=Wn;Wn=!1;let o=t();return Wn=n,o}function he(t,n,o={}){let i;return bt(t,n)(u=>i=u,o),i}function bt(...t){return na(...t)}var na=ra;function ru(t){na=t}function ra(t,n){let o={};ii(o,t);let i=[o,...Pe(t)],u=typeof n=="function"?iu(i,n):au(i,n,t);return nu.bind(null,t,n,u)}function iu(t,n){return(o=()=>{},{scope:i={},params:u=[]}={})=>{let c=n.apply(sn([i,...t]),u);Yn(o,c)}}var Jr={};function ou(t,n){if(Jr[t])return Jr[t];let o=Object.getPrototypeOf(async function(){}).constructor,i=/^[\n\s]*if.*\(.*\)/.test(t.trim())||/^(let|const)\s/.test(t.trim())?`(async()=>{ ${t} })()`:t,c=(()=>{try{let d=new o(["__self","scope"],`with (scope) { __self.result = ${i} }; __self.finished = true; return __self.result;`);return Object.defineProperty(d,"name",{value:`[Alpine] ${t}`}),d}catch(d){return on(d,n,t),Promise.resolve()}})();return Jr[t]=c,c}function au(t,n,o){let i=ou(n,o);return(u=()=>{},{scope:c={},params:d=[]}={})=>{i.result=void 0,i.finished=!1;let h=sn([c,...t]);if(typeof i=="function"){let m=i(i,h).catch(T=>on(T,o,n));i.finished?(Yn(u,i.result,h,d,o),i.result=void 0):m.then(T=>{Yn(u,T,h,d,o)}).catch(T=>on(T,o,n)).finally(()=>i.result=void 0)}}}function Yn(t,n,o,i,u){if(Wn&&typeof n=="function"){let c=n.apply(o,i);c instanceof Promise?c.then(d=>Yn(t,d,o,i)).catch(d=>on(d,u,n)):t(c)}else typeof n=="object"&&n instanceof Promise?n.then(c=>t(c)):t(n)}var Ti="x-";function Me(t=""){return Ti+t}function su(t){Ti=t}var Gn={};function dt(t,n){return Gn[t]=n,{before(o){if(!Gn[o]){console.warn(String.raw`Cannot find directive \`${o}\`. \`${t}\` will use the default order of execution`);return}const i=de.indexOf(o);de.splice(i>=0?i:de.indexOf("DEFAULT"),0,t)}}}function uu(t){return Object.keys(Gn).includes(t)}function Ei(t,n,o){if(n=Array.from(n),t._x_virtualDirectives){let c=Object.entries(t._x_virtualDirectives).map(([h,m])=>({name:h,value:m})),d=ia(c);c=c.map(h=>d.find(m=>m.name===h.name)?{name:`x-bind:${h.name}`,value:`"${h.value}"`}:h),n=n.concat(c)}let i={};return n.map(ca((c,d)=>i[c]=d)).filter(da).map(du(i,o)).sort(fu).map(c=>lu(t,c))}function ia(t){return Array.from(t).map(ca()).filter(n=>!da(n))}var oi=!1,en=new Map,oa=Symbol();function cu(t){oi=!0;let n=Symbol();oa=n,en.set(n,[]);let o=()=>{for(;en.get(n).length;)en.get(n).shift()();en.delete(n)},i=()=>{oi=!1,o()};t(o),i()}function aa(t){let n=[],o=h=>n.push(h),[i,u]=zs(t);return n.push(u),[{Alpine:un,effect:i,cleanup:o,evaluateLater:bt.bind(bt,t),evaluate:he.bind(he,t)},()=>n.forEach(h=>h())]}function lu(t,n){let o=()=>{},i=Gn[n.type]||o,[u,c]=aa(t);Vo(t,n.original,c);let d=()=>{t._x_ignore||t._x_ignoreSelf||(i.inline&&i.inline(t,n,u),i=i.bind(i,t,n,u),oi?en.get(oa).push(i):i())};return d.runCleanups=c,d}var sa=(t,n)=>({name:o,value:i})=>(o.startsWith(t)&&(o=o.replace(t,n)),{name:o,value:i}),ua=t=>t;function ca(t=()=>{}){return({name:n,value:o})=>{let{name:i,value:u}=la.reduce((c,d)=>d(c),{name:n,value:o});return i!==n&&t(i,n),{name:i,value:u}}}var la=[];function ki(t){la.push(t)}function da({name:t}){return fa().test(t)}var fa=()=>new RegExp(`^${Ti}([^:^.]+)\\b`);function du(t,n){return({name:o,value:i})=>{let u=o.match(fa()),c=o.match(/:([a-zA-Z0-9\-_:]+)/),d=o.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],h=n||t[o]||o;return{type:u?u[1]:null,value:c?c[1]:null,modifiers:d.map(m=>m.replace(".","")),expression:i,original:h}}}var ai="DEFAULT",de=["ignore","ref","data","id","anchor","bind","init","for","model","modelable","transition","show","if",ai,"teleport"];function fu(t,n){let o=de.indexOf(t.type)===-1?ai:t.type,i=de.indexOf(n.type)===-1?ai:n.type;return de.indexOf(o)-de.indexOf(i)}function nn(t,n,o={}){t.dispatchEvent(new CustomEvent(n,{detail:o,bubbles:!0,composed:!0,cancelable:!0}))}function me(t,n){if(typeof ShadowRoot=="function"&&t instanceof ShadowRoot){Array.from(t.children).forEach(u=>me(u,n));return}let o=!1;if(n(t,()=>o=!0),o)return;let i=t.firstElementChild;for(;i;)me(i,n),i=i.nextElementSibling}function Et(t,...n){console.warn(`Alpine Warning: ${t}`,...n)}var xo=!1;function hu(){xo&&Et("Alpine has already been initialized on this page. Calling Alpine.start() more than once can cause problems."),xo=!0,document.body||Et("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),nn(document,"alpine:init"),nn(document,"alpine:initializing"),_i(),Js(n=>Nt(n,me)),vi(n=>Re(n)),Jo((n,o)=>{Ei(n,o).forEach(i=>i())});let t=n=>!Zn(n.parentElement,!0);Array.from(document.querySelectorAll(ga().join(","))).filter(t).forEach(n=>{Nt(n)}),nn(document,"alpine:initialized"),setTimeout(()=>{yu()})}var Di=[],ha=[];function pa(){return Di.map(t=>t())}function ga(){return Di.concat(ha).map(t=>t())}function ma(t){Di.push(t)}function ya(t){ha.push(t)}function Zn(t,n=!1){return je(t,o=>{if((n?ga():pa()).some(u=>o.matches(u)))return!0})}function je(t,n){if(t){if(n(t))return t;if(t._x_teleportBack&&(t=t._x_teleportBack),!!t.parentElement)return je(t.parentElement,n)}}function pu(t){return pa().some(n=>t.matches(n))}var va=[];function gu(t){va.push(t)}var mu=1;function Nt(t,n=me,o=()=>{}){je(t,i=>i._x_ignore)||cu(()=>{n(t,(i,u)=>{i._x_marker||(o(i,u),va.forEach(c=>c(i,u)),Ei(i,i.attributes).forEach(c=>c()),i._x_ignore||(i._x_marker=mu++),i._x_ignore&&u())})})}function Re(t,n=me){n(t,o=>{Vs(o),Yo(o),delete o._x_marker})}function yu(){[["ui","dialog",["[x-dialog], [x-popover]"]],["anchor","anchor",["[x-anchor]"]],["sort","sort",["[x-sort]"]]].forEach(([n,o,i])=>{uu(o)||i.some(u=>{if(document.querySelector(u))return Et(`found "${u}", but missing ${n} plugin`),!0})})}var si=[],Ai=!1;function Oi(t=()=>{}){return queueMicrotask(()=>{Ai||setTimeout(()=>{ui()})}),new Promise(n=>{si.push(()=>{t(),n()})})}function ui(){for(Ai=!1;si.length;)si.shift()()}function vu(){Ai=!0}function Pi(t,n){return Array.isArray(n)?To(t,n.join(" ")):typeof n=="object"&&n!==null?wu(t,n):typeof n=="function"?Pi(t,n()):To(t,n)}function To(t,n){let o=u=>u.split(" ").filter(c=>!t.classList.contains(c)).filter(Boolean),i=u=>(t.classList.add(...u),()=>{t.classList.remove(...u)});return n=n===!0?n="":n||"",i(o(n))}function wu(t,n){let o=h=>h.split(" ").filter(Boolean),i=Object.entries(n).flatMap(([h,m])=>m?o(h):!1).filter(Boolean),u=Object.entries(n).flatMap(([h,m])=>m?!1:o(h)).filter(Boolean),c=[],d=[];return u.forEach(h=>{t.classList.contains(h)&&(t.classList.remove(h),d.push(h))}),i.forEach(h=>{t.classList.contains(h)||(t.classList.add(h),c.push(h))}),()=>{d.forEach(h=>t.classList.add(h)),c.forEach(h=>t.classList.remove(h))}}function tr(t,n){return typeof n=="object"&&n!==null?bu(t,n):_u(t,n)}function bu(t,n){let o={};return Object.entries(n).forEach(([i,u])=>{o[i]=t.style[i],i.startsWith("--")||(i=Su(i)),t.style.setProperty(i,u)}),setTimeout(()=>{t.style.length===0&&t.removeAttribute("style")}),()=>{tr(t,o)}}function _u(t,n){let o=t.getAttribute("style",n);return t.setAttribute("style",n),()=>{t.setAttribute("style",o||"")}}function Su(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ci(t,n=()=>{}){let o=!1;return function(){o?n.apply(this,arguments):(o=!0,t.apply(this,arguments))}}dt("transition",(t,{value:n,modifiers:o,expression:i},{evaluate:u})=>{typeof i=="function"&&(i=u(i)),i!==!1&&(!i||typeof i=="boolean"?Tu(t,o,n):xu(t,i,n))});function xu(t,n,o){wa(t,Pi,""),{enter:u=>{t._x_transition.enter.during=u},"enter-start":u=>{t._x_transition.enter.start=u},"enter-end":u=>{t._x_transition.enter.end=u},leave:u=>{t._x_transition.leave.during=u},"leave-start":u=>{t._x_transition.leave.start=u},"leave-end":u=>{t._x_transition.leave.end=u}}[o](n)}function Tu(t,n,o){wa(t,tr);let i=!n.includes("in")&&!n.includes("out")&&!o,u=i||n.includes("in")||["enter"].includes(o),c=i||n.includes("out")||["leave"].includes(o);n.includes("in")&&!i&&(n=n.filter((Y,Z)=>Z<n.indexOf("out"))),n.includes("out")&&!i&&(n=n.filter((Y,Z)=>Z>n.indexOf("out")));let d=!n.includes("opacity")&&!n.includes("scale"),h=d||n.includes("opacity"),m=d||n.includes("scale"),T=h?0:1,O=m?Ze(n,"scale",95)/100:1,C=Ze(n,"delay",0)/1e3,$=Ze(n,"origin","center"),q="opacity, transform",z=Ze(n,"duration",150)/1e3,et=Ze(n,"duration",75)/1e3,H="cubic-bezier(0.4, 0.0, 0.2, 1)";u&&(t._x_transition.enter.during={transformOrigin:$,transitionDelay:`${C}s`,transitionProperty:q,transitionDuration:`${z}s`,transitionTimingFunction:H},t._x_transition.enter.start={opacity:T,transform:`scale(${O})`},t._x_transition.enter.end={opacity:1,transform:"scale(1)"}),c&&(t._x_transition.leave.during={transformOrigin:$,transitionDelay:`${C}s`,transitionProperty:q,transitionDuration:`${et}s`,transitionTimingFunction:H},t._x_transition.leave.start={opacity:1,transform:"scale(1)"},t._x_transition.leave.end={opacity:T,transform:`scale(${O})`})}function wa(t,n,o={}){t._x_transition||(t._x_transition={enter:{during:o,start:o,end:o},leave:{during:o,start:o,end:o},in(i=()=>{},u=()=>{}){li(t,n,{during:this.enter.during,start:this.enter.start,end:this.enter.end},i,u)},out(i=()=>{},u=()=>{}){li(t,n,{during:this.leave.during,start:this.leave.start,end:this.leave.end},i,u)}})}window.Element.prototype._x_toggleAndCascadeWithTransitions=function(t,n,o,i){const u=document.visibilityState==="visible"?requestAnimationFrame:setTimeout;let c=()=>u(o);if(n){t._x_transition&&(t._x_transition.enter||t._x_transition.leave)?t._x_transition.enter&&(Object.entries(t._x_transition.enter.during).length||Object.entries(t._x_transition.enter.start).length||Object.entries(t._x_transition.enter.end).length)?t._x_transition.in(o):c():t._x_transition?t._x_transition.in(o):c();return}t._x_hidePromise=t._x_transition?new Promise((d,h)=>{t._x_transition.out(()=>{},()=>d(i)),t._x_transitioning&&t._x_transitioning.beforeCancel(()=>h({isFromCancelledTransition:!0}))}):Promise.resolve(i),queueMicrotask(()=>{let d=ba(t);d?(d._x_hideChildren||(d._x_hideChildren=[]),d._x_hideChildren.push(t)):u(()=>{let h=m=>{let T=Promise.all([m._x_hidePromise,...(m._x_hideChildren||[]).map(h)]).then(([O])=>O?.());return delete m._x_hidePromise,delete m._x_hideChildren,T};h(t).catch(m=>{if(!m.isFromCancelledTransition)throw m})})})};function ba(t){let n=t.parentNode;if(n)return n._x_hidePromise?n:ba(n)}function li(t,n,{during:o,start:i,end:u}={},c=()=>{},d=()=>{}){if(t._x_transitioning&&t._x_transitioning.cancel(),Object.keys(o).length===0&&Object.keys(i).length===0&&Object.keys(u).length===0){c(),d();return}let h,m,T;Eu(t,{start(){h=n(t,i)},during(){m=n(t,o)},before:c,end(){h(),T=n(t,u)},after:d,cleanup(){m(),T()}})}function Eu(t,n){let o,i,u,c=ci(()=>{st(()=>{o=!0,i||n.before(),u||(n.end(),ui()),n.after(),t.isConnected&&n.cleanup(),delete t._x_transitioning})});t._x_transitioning={beforeCancels:[],beforeCancel(d){this.beforeCancels.push(d)},cancel:ci(function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();c()}),finish:c},st(()=>{n.start(),n.during()}),vu(),requestAnimationFrame(()=>{if(o)return;let d=Number(getComputedStyle(t).transitionDuration.replace(/,.*/,"").replace("s",""))*1e3,h=Number(getComputedStyle(t).transitionDelay.replace(/,.*/,"").replace("s",""))*1e3;d===0&&(d=Number(getComputedStyle(t).animationDuration.replace("s",""))*1e3),st(()=>{n.before()}),i=!0,requestAnimationFrame(()=>{o||(st(()=>{n.end()}),ui(),setTimeout(t._x_transitioning.finish,d+h),u=!0)})})}function Ze(t,n,o){if(t.indexOf(n)===-1)return o;const i=t[t.indexOf(n)+1];if(!i||n==="scale"&&isNaN(i))return o;if(n==="duration"||n==="delay"){let u=i.match(/([0-9]+)ms/);if(u)return u[1]}return n==="origin"&&["top","right","left","center","bottom"].includes(t[t.indexOf(n)+2])?[i,t[t.indexOf(n)+2]].join(" "):i}var Vt=!1;function Gt(t,n=()=>{}){return(...o)=>Vt?n(...o):t(...o)}function ku(t){return(...n)=>Vt&&t(...n)}var _a=[];function er(t){_a.push(t)}function Du(t,n){_a.forEach(o=>o(t,n)),Vt=!0,Sa(()=>{Nt(n,(o,i)=>{i(o,()=>{})})}),Vt=!1}var di=!1;function Au(t,n){n._x_dataStack||(n._x_dataStack=t._x_dataStack),Vt=!0,di=!0,Sa(()=>{Ou(n)}),Vt=!1,di=!1}function Ou(t){let n=!1;Nt(t,(i,u)=>{me(i,(c,d)=>{if(n&&pu(c))return d();n=!0,u(c,d)})})}function Sa(t){let n=ye;So((o,i)=>{let u=n(o);return $e(u),()=>{}}),t(),So(n)}function xa(t,n,o,i=[]){switch(t._x_bindings||(t._x_bindings=Ie({})),t._x_bindings[n]=o,n=i.includes("camel")?Fu(n):n,n){case"value":Pu(t,o);break;case"style":Iu(t,o);break;case"class":Cu(t,o);break;case"selected":case"checked":$u(t,n,o);break;default:Ta(t,n,o);break}}function Pu(t,n){if(Da(t))t.attributes.value===void 0&&(t.value=n),window.fromModel&&(typeof n=="boolean"?t.checked=zn(t.value)===n:t.checked=Eo(t.value,n));else if(Ci(t))Number.isInteger(n)?t.value=n:!Array.isArray(n)&&typeof n!="boolean"&&![null,void 0].includes(n)?t.value=String(n):Array.isArray(n)?t.checked=n.some(o=>Eo(o,t.value)):t.checked=!!n;else if(t.tagName==="SELECT")Ru(t,n);else{if(t.value===n)return;t.value=n===void 0?"":n}}function Cu(t,n){t._x_undoAddedClasses&&t._x_undoAddedClasses(),t._x_undoAddedClasses=Pi(t,n)}function Iu(t,n){t._x_undoAddedStyles&&t._x_undoAddedStyles(),t._x_undoAddedStyles=tr(t,n)}function $u(t,n,o){Ta(t,n,o),ju(t,n,o)}function Ta(t,n,o){[null,void 0,!1].includes(o)&&Nu(n)?t.removeAttribute(n):(Ea(n)&&(o=n),Mu(t,n,o))}function Mu(t,n,o){t.getAttribute(n)!=o&&t.setAttribute(n,o)}function ju(t,n,o){t[n]!==o&&(t[n]=o)}function Ru(t,n){const o=[].concat(n).map(i=>i+"");Array.from(t.options).forEach(i=>{i.selected=o.includes(i.value)})}function Fu(t){return t.toLowerCase().replace(/-(\w)/g,(n,o)=>o.toUpperCase())}function Eo(t,n){return t==n}function zn(t){return[1,"1","true","on","yes",!0].includes(t)?!0:[0,"0","false","off","no",!1].includes(t)?!1:t?!!t:null}var Lu=new Set(["allowfullscreen","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected","shadowrootclonable","shadowrootdelegatesfocus","shadowrootserializable"]);function Ea(t){return Lu.has(t)}function Nu(t){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(t)}function Ku(t,n,o){return t._x_bindings&&t._x_bindings[n]!==void 0?t._x_bindings[n]:ka(t,n,o)}function Bu(t,n,o,i=!0){if(t._x_bindings&&t._x_bindings[n]!==void 0)return t._x_bindings[n];if(t._x_inlineBindings&&t._x_inlineBindings[n]!==void 0){let u=t._x_inlineBindings[n];return u.extract=i,ea(()=>he(t,u.expression))}return ka(t,n,o)}function ka(t,n,o){let i=t.getAttribute(n);return i===null?typeof o=="function"?o():o:i===""?!0:Ea(n)?!![n,"true"].includes(i):i}function Ci(t){return t.type==="checkbox"||t.localName==="ui-checkbox"||t.localName==="ui-switch"}function Da(t){return t.type==="radio"||t.localName==="ui-radio"}function Aa(t,n){var o;return function(){var i=this,u=arguments,c=function(){o=null,t.apply(i,u)};clearTimeout(o),o=setTimeout(c,n)}}function Oa(t,n){let o;return function(){let i=this,u=arguments;o||(t.apply(i,u),o=!0,setTimeout(()=>o=!1,n))}}function Pa({get:t,set:n},{get:o,set:i}){let u=!0,c,d=ye(()=>{let h=t(),m=o();if(u)i(Vr(h)),u=!1;else{let T=JSON.stringify(h),O=JSON.stringify(m);T!==c?i(Vr(h)):T!==O&&n(Vr(m))}c=JSON.stringify(t()),JSON.stringify(o())});return()=>{$e(d)}}function Vr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function qu(t){(Array.isArray(t)?t:[t]).forEach(o=>o(un))}var le={},ko=!1;function Hu(t,n){if(ko||(le=Ie(le),ko=!0),n===void 0)return le[t];le[t]=n,Qo(le[t]),typeof n=="object"&&n!==null&&n.hasOwnProperty("init")&&typeof n.init=="function"&&le[t].init()}function Uu(){return le}var Ca={};function Wu(t,n){let o=typeof n!="function"?()=>n:n;return t instanceof Element?Ia(t,o()):(Ca[t]=o,()=>{})}function zu(t){return Object.entries(Ca).forEach(([n,o])=>{Object.defineProperty(t,n,{get(){return(...i)=>o(...i)}})}),t}function Ia(t,n,o){let i=[];for(;i.length;)i.pop()();let u=Object.entries(n).map(([d,h])=>({name:d,value:h})),c=ia(u);return u=u.map(d=>c.find(h=>h.name===d.name)?{name:`x-bind:${d.name}`,value:`"${d.value}"`}:d),Ei(t,u,o).map(d=>{i.push(d.runCleanups),d()}),()=>{for(;i.length;)i.pop()()}}var $a={};function Ju(t,n){$a[t]=n}function Vu(t,n){return Object.entries($a).forEach(([o,i])=>{Object.defineProperty(t,o,{get(){return(...u)=>i.bind(n)(...u)},enumerable:!1})}),t}var Yu={get reactive(){return Ie},get release(){return $e},get effect(){return ye},get raw(){return qo},version:"3.14.9",flushAndStopDeferringMutations:Xs,dontAutoEvaluateFunctions:ea,disableEffectScheduling:Us,startObservingMutations:_i,stopObservingMutations:Go,setReactivityEngine:Ws,onAttributeRemoved:Vo,onAttributesAdded:Jo,closestDataStack:Pe,skipDuringClone:Gt,onlyDuringClone:ku,addRootSelector:ma,addInitSelector:ya,interceptClone:er,addScopeToNode:an,deferMutations:Gs,mapAttributes:ki,evaluateLater:bt,interceptInit:gu,setEvaluator:ru,mergeProxies:sn,extractProp:Bu,findClosest:je,onElRemoved:vi,closestRoot:Zn,destroyTree:Re,interceptor:Zo,transition:li,setStyles:tr,mutateDom:st,directive:dt,entangle:Pa,throttle:Oa,debounce:Aa,evaluate:he,initTree:Nt,nextTick:Oi,prefixed:Me,prefix:su,plugin:qu,magic:Dt,store:Hu,start:hu,clone:Au,cloneNode:Du,bound:Ku,$data:Xo,watch:Ho,walk:me,data:Ju,bind:Wu},un=Yu;function Gu(t,n){const o=Object.create(null),i=t.split(",");for(let u=0;u<i.length;u++)o[i[u]]=!0;return u=>!!o[u]}var Xu=Object.freeze({}),Qu=Object.prototype.hasOwnProperty,nr=(t,n)=>Qu.call(t,n),pe=Array.isArray,rn=t=>Ma(t)==="[object Map]",Zu=t=>typeof t=="string",Ii=t=>typeof t=="symbol",rr=t=>t!==null&&typeof t=="object",tc=Object.prototype.toString,Ma=t=>tc.call(t),ja=t=>Ma(t).slice(8,-1),$i=t=>Zu(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ec=t=>{const n=Object.create(null);return o=>n[o]||(n[o]=t(o))},nc=ec(t=>t.charAt(0).toUpperCase()+t.slice(1)),Ra=(t,n)=>t!==n&&(t===t||n===n),fi=new WeakMap,tn=[],It,ge=Symbol("iterate"),hi=Symbol("Map key iterate");function rc(t){return t&&t._isEffect===!0}function ic(t,n=Xu){rc(t)&&(t=t.raw);const o=sc(t,n);return n.lazy||o(),o}function oc(t){t.active&&(Fa(t),t.options.onStop&&t.options.onStop(),t.active=!1)}var ac=0;function sc(t,n){const o=function(){if(!o.active)return t();if(!tn.includes(o)){Fa(o);try{return cc(),tn.push(o),It=o,t()}finally{tn.pop(),La(),It=tn[tn.length-1]}}};return o.id=ac++,o.allowRecurse=!!n.allowRecurse,o._isEffect=!0,o.active=!0,o.raw=t,o.deps=[],o.options=n,o}function Fa(t){const{deps:n}=t;if(n.length){for(let o=0;o<n.length;o++)n[o].delete(t);n.length=0}}var Ce=!0,Mi=[];function uc(){Mi.push(Ce),Ce=!1}function cc(){Mi.push(Ce),Ce=!0}function La(){const t=Mi.pop();Ce=t===void 0?!0:t}function kt(t,n,o){if(!Ce||It===void 0)return;let i=fi.get(t);i||fi.set(t,i=new Map);let u=i.get(o);u||i.set(o,u=new Set),u.has(It)||(u.add(It),It.deps.push(u),It.options.onTrack&&It.options.onTrack({effect:It,target:t,type:n,key:o}))}function Yt(t,n,o,i,u,c){const d=fi.get(t);if(!d)return;const h=new Set,m=O=>{O&&O.forEach(C=>{(C!==It||C.allowRecurse)&&h.add(C)})};if(n==="clear")d.forEach(m);else if(o==="length"&&pe(t))d.forEach((O,C)=>{(C==="length"||C>=i)&&m(O)});else switch(o!==void 0&&m(d.get(o)),n){case"add":pe(t)?$i(o)&&m(d.get("length")):(m(d.get(ge)),rn(t)&&m(d.get(hi)));break;case"delete":pe(t)||(m(d.get(ge)),rn(t)&&m(d.get(hi)));break;case"set":rn(t)&&m(d.get(ge));break}const T=O=>{O.options.onTrigger&&O.options.onTrigger({effect:O,target:t,key:o,type:n,newValue:i,oldValue:u,oldTarget:c}),O.options.scheduler?O.options.scheduler(O):O()};h.forEach(T)}var lc=Gu("__proto__,__v_isRef,__isVue"),Na=new Set(Object.getOwnPropertyNames(Symbol).map(t=>Symbol[t]).filter(Ii)),dc=Ka(),fc=Ka(!0),Do=hc();function hc(){const t={};return["includes","indexOf","lastIndexOf"].forEach(n=>{t[n]=function(...o){const i=it(this);for(let c=0,d=this.length;c<d;c++)kt(i,"get",c+"");const u=i[n](...o);return u===-1||u===!1?i[n](...o.map(it)):u}}),["push","pop","shift","unshift","splice"].forEach(n=>{t[n]=function(...o){uc();const i=it(this)[n].apply(this,o);return La(),i}}),t}function Ka(t=!1,n=!1){return function(i,u,c){if(u==="__v_isReactive")return!t;if(u==="__v_isReadonly")return t;if(u==="__v_raw"&&c===(t?n?Dc:Ua:n?kc:Ha).get(i))return i;const d=pe(i);if(!t&&d&&nr(Do,u))return Reflect.get(Do,u,c);const h=Reflect.get(i,u,c);return(Ii(u)?Na.has(u):lc(u))||(t||kt(i,"get",u),n)?h:pi(h)?!d||!$i(u)?h.value:h:rr(h)?t?Wa(h):Li(h):h}}var pc=gc();function gc(t=!1){return function(o,i,u,c){let d=o[i];if(!t&&(u=it(u),d=it(d),!pe(o)&&pi(d)&&!pi(u)))return d.value=u,!0;const h=pe(o)&&$i(i)?Number(i)<o.length:nr(o,i),m=Reflect.set(o,i,u,c);return o===it(c)&&(h?Ra(u,d)&&Yt(o,"set",i,u,d):Yt(o,"add",i,u)),m}}function mc(t,n){const o=nr(t,n),i=t[n],u=Reflect.deleteProperty(t,n);return u&&o&&Yt(t,"delete",n,void 0,i),u}function yc(t,n){const o=Reflect.has(t,n);return(!Ii(n)||!Na.has(n))&&kt(t,"has",n),o}function vc(t){return kt(t,"iterate",pe(t)?"length":ge),Reflect.ownKeys(t)}var wc={get:dc,set:pc,deleteProperty:mc,has:yc,ownKeys:vc},bc={get:fc,set(t,n){return console.warn(`Set operation on key "${String(n)}" failed: target is readonly.`,t),!0},deleteProperty(t,n){return console.warn(`Delete operation on key "${String(n)}" failed: target is readonly.`,t),!0}},ji=t=>rr(t)?Li(t):t,Ri=t=>rr(t)?Wa(t):t,Fi=t=>t,ir=t=>Reflect.getPrototypeOf(t);function Kn(t,n,o=!1,i=!1){t=t.__v_raw;const u=it(t),c=it(n);n!==c&&!o&&kt(u,"get",n),!o&&kt(u,"get",c);const{has:d}=ir(u),h=i?Fi:o?Ri:ji;if(d.call(u,n))return h(t.get(n));if(d.call(u,c))return h(t.get(c));t!==u&&t.get(n)}function Bn(t,n=!1){const o=this.__v_raw,i=it(o),u=it(t);return t!==u&&!n&&kt(i,"has",t),!n&&kt(i,"has",u),t===u?o.has(t):o.has(t)||o.has(u)}function qn(t,n=!1){return t=t.__v_raw,!n&&kt(it(t),"iterate",ge),Reflect.get(t,"size",t)}function Ao(t){t=it(t);const n=it(this);return ir(n).has.call(n,t)||(n.add(t),Yt(n,"add",t,t)),this}function Oo(t,n){n=it(n);const o=it(this),{has:i,get:u}=ir(o);let c=i.call(o,t);c?qa(o,i,t):(t=it(t),c=i.call(o,t));const d=u.call(o,t);return o.set(t,n),c?Ra(n,d)&&Yt(o,"set",t,n,d):Yt(o,"add",t,n),this}function Po(t){const n=it(this),{has:o,get:i}=ir(n);let u=o.call(n,t);u?qa(n,o,t):(t=it(t),u=o.call(n,t));const c=i?i.call(n,t):void 0,d=n.delete(t);return u&&Yt(n,"delete",t,void 0,c),d}function Co(){const t=it(this),n=t.size!==0,o=rn(t)?new Map(t):new Set(t),i=t.clear();return n&&Yt(t,"clear",void 0,void 0,o),i}function Hn(t,n){return function(i,u){const c=this,d=c.__v_raw,h=it(d),m=n?Fi:t?Ri:ji;return!t&&kt(h,"iterate",ge),d.forEach((T,O)=>i.call(u,m(T),m(O),c))}}function Un(t,n,o){return function(...i){const u=this.__v_raw,c=it(u),d=rn(c),h=t==="entries"||t===Symbol.iterator&&d,m=t==="keys"&&d,T=u[t](...i),O=o?Fi:n?Ri:ji;return!n&&kt(c,"iterate",m?hi:ge),{next(){const{value:C,done:$}=T.next();return $?{value:C,done:$}:{value:h?[O(C[0]),O(C[1])]:O(C),done:$}},[Symbol.iterator](){return this}}}}function Jt(t){return function(...n){{const o=n[0]?`on key "${n[0]}" `:"";console.warn(`${nc(t)} operation ${o}failed: target is readonly.`,it(this))}return t==="delete"?!1:this}}function _c(){const t={get(c){return Kn(this,c)},get size(){return qn(this)},has:Bn,add:Ao,set:Oo,delete:Po,clear:Co,forEach:Hn(!1,!1)},n={get(c){return Kn(this,c,!1,!0)},get size(){return qn(this)},has:Bn,add:Ao,set:Oo,delete:Po,clear:Co,forEach:Hn(!1,!0)},o={get(c){return Kn(this,c,!0)},get size(){return qn(this,!0)},has(c){return Bn.call(this,c,!0)},add:Jt("add"),set:Jt("set"),delete:Jt("delete"),clear:Jt("clear"),forEach:Hn(!0,!1)},i={get(c){return Kn(this,c,!0,!0)},get size(){return qn(this,!0)},has(c){return Bn.call(this,c,!0)},add:Jt("add"),set:Jt("set"),delete:Jt("delete"),clear:Jt("clear"),forEach:Hn(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(c=>{t[c]=Un(c,!1,!1),o[c]=Un(c,!0,!1),n[c]=Un(c,!1,!0),i[c]=Un(c,!0,!0)}),[t,o,n,i]}var[Sc,xc,vl,wl]=_c();function Ba(t,n){const o=t?xc:Sc;return(i,u,c)=>u==="__v_isReactive"?!t:u==="__v_isReadonly"?t:u==="__v_raw"?i:Reflect.get(nr(o,u)&&u in i?o:i,u,c)}var Tc={get:Ba(!1)},Ec={get:Ba(!0)};function qa(t,n,o){const i=it(o);if(i!==o&&n.call(t,i)){const u=ja(t);console.warn(`Reactive ${u} contains both the raw and reactive versions of the same object${u==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var Ha=new WeakMap,kc=new WeakMap,Ua=new WeakMap,Dc=new WeakMap;function Ac(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Oc(t){return t.__v_skip||!Object.isExtensible(t)?0:Ac(ja(t))}function Li(t){return t&&t.__v_isReadonly?t:za(t,!1,wc,Tc,Ha)}function Wa(t){return za(t,!0,bc,Ec,Ua)}function za(t,n,o,i,u){if(!rr(t))return console.warn(`value cannot be made reactive: ${String(t)}`),t;if(t.__v_raw&&!(n&&t.__v_isReactive))return t;const c=u.get(t);if(c)return c;const d=Oc(t);if(d===0)return t;const h=new Proxy(t,d===2?i:o);return u.set(t,h),h}function it(t){return t&&it(t.__v_raw)||t}function pi(t){return!!(t&&t.__v_isRef===!0)}Dt("nextTick",()=>Oi);Dt("dispatch",t=>nn.bind(nn,t));Dt("watch",(t,{evaluateLater:n,cleanup:o})=>(i,u)=>{let c=n(i),h=Ho(()=>{let m;return c(T=>m=T),m},u);o(h)});Dt("store",Uu);Dt("data",t=>Xo(t));Dt("root",t=>Zn(t));Dt("refs",t=>(t._x_refs_proxy||(t._x_refs_proxy=sn(Pc(t))),t._x_refs_proxy));function Pc(t){let n=[];return je(t,o=>{o._x_refs&&n.push(o._x_refs)}),n}var Yr={};function Ja(t){return Yr[t]||(Yr[t]=0),++Yr[t]}function Cc(t,n){return je(t,o=>{if(o._x_ids&&o._x_ids[n])return!0})}function Ic(t,n){t._x_ids||(t._x_ids={}),t._x_ids[n]||(t._x_ids[n]=Ja(n))}Dt("id",(t,{cleanup:n})=>(o,i=null)=>{let u=`${o}${i?`-${i}`:""}`;return $c(t,u,n,()=>{let c=Cc(t,o),d=c?c._x_ids[o]:Ja(o);return i?`${o}-${d}-${i}`:`${o}-${d}`})});er((t,n)=>{t._x_id&&(n._x_id=t._x_id)});function $c(t,n,o,i){if(t._x_id||(t._x_id={}),t._x_id[n])return t._x_id[n];let u=i();return t._x_id[n]=u,o(()=>{delete t._x_id[n]}),u}Dt("el",t=>t);Va("Focus","focus","focus");Va("Persist","persist","persist");function Va(t,n,o){Dt(n,i=>Et(`You can't use [$${n}] without first installing the "${t}" plugin here: https://alpinejs.dev/plugins/${o}`,i))}dt("modelable",(t,{expression:n},{effect:o,evaluateLater:i,cleanup:u})=>{let c=i(n),d=()=>{let O;return c(C=>O=C),O},h=i(`${n} = __placeholder`),m=O=>h(()=>{},{scope:{__placeholder:O}}),T=d();m(T),queueMicrotask(()=>{if(!t._x_model)return;t._x_removeModelListeners.default();let O=t._x_model.get,C=t._x_model.set,$=Pa({get(){return O()},set(q){C(q)}},{get(){return d()},set(q){m(q)}});u($)})});dt("teleport",(t,{modifiers:n,expression:o},{cleanup:i})=>{t.tagName.toLowerCase()!=="template"&&Et("x-teleport can only be used on a <template> tag",t);let u=Io(o),c=t.content.cloneNode(!0).firstElementChild;t._x_teleport=c,c._x_teleportBack=t,t.setAttribute("data-teleport-template",!0),c.setAttribute("data-teleport-target",!0),t._x_forwardEvents&&t._x_forwardEvents.forEach(h=>{c.addEventListener(h,m=>{m.stopPropagation(),t.dispatchEvent(new m.constructor(m.type,m))})}),an(c,{},t);let d=(h,m,T)=>{T.includes("prepend")?m.parentNode.insertBefore(h,m):T.includes("append")?m.parentNode.insertBefore(h,m.nextSibling):m.appendChild(h)};st(()=>{d(c,u,n),Gt(()=>{Nt(c)})()}),t._x_teleportPutBack=()=>{let h=Io(o);st(()=>{d(t._x_teleport,h,n)})},i(()=>st(()=>{c.remove(),Re(c)}))});var Mc=document.createElement("div");function Io(t){let n=Gt(()=>document.querySelector(t),()=>Mc)();return n||Et(`Cannot find x-teleport element for selector: "${t}"`),n}var Ya=()=>{};Ya.inline=(t,{modifiers:n},{cleanup:o})=>{n.includes("self")?t._x_ignoreSelf=!0:t._x_ignore=!0,o(()=>{n.includes("self")?delete t._x_ignoreSelf:delete t._x_ignore})};dt("ignore",Ya);dt("effect",Gt((t,{expression:n},{effect:o})=>{o(bt(t,n))}));function gi(t,n,o,i){let u=t,c=m=>i(m),d={},h=(m,T)=>O=>T(m,O);if(o.includes("dot")&&(n=jc(n)),o.includes("camel")&&(n=Rc(n)),o.includes("passive")&&(d.passive=!0),o.includes("capture")&&(d.capture=!0),o.includes("window")&&(u=window),o.includes("document")&&(u=document),o.includes("debounce")){let m=o[o.indexOf("debounce")+1]||"invalid-wait",T=Xn(m.split("ms")[0])?Number(m.split("ms")[0]):250;c=Aa(c,T)}if(o.includes("throttle")){let m=o[o.indexOf("throttle")+1]||"invalid-wait",T=Xn(m.split("ms")[0])?Number(m.split("ms")[0]):250;c=Oa(c,T)}return o.includes("prevent")&&(c=h(c,(m,T)=>{T.preventDefault(),m(T)})),o.includes("stop")&&(c=h(c,(m,T)=>{T.stopPropagation(),m(T)})),o.includes("once")&&(c=h(c,(m,T)=>{m(T),u.removeEventListener(n,c,d)})),(o.includes("away")||o.includes("outside"))&&(u=document,c=h(c,(m,T)=>{t.contains(T.target)||T.target.isConnected!==!1&&(t.offsetWidth<1&&t.offsetHeight<1||t._x_isShown!==!1&&m(T))})),o.includes("self")&&(c=h(c,(m,T)=>{T.target===t&&m(T)})),(Lc(n)||Ga(n))&&(c=h(c,(m,T)=>{Nc(T,o)||m(T)})),u.addEventListener(n,c,d),()=>{u.removeEventListener(n,c,d)}}function jc(t){return t.replace(/-/g,".")}function Rc(t){return t.toLowerCase().replace(/-(\w)/g,(n,o)=>o.toUpperCase())}function Xn(t){return!Array.isArray(t)&&!isNaN(t)}function Fc(t){return[" ","_"].includes(t)?t:t.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase()}function Lc(t){return["keydown","keyup"].includes(t)}function Ga(t){return["contextmenu","click","mouse"].some(n=>t.includes(n))}function Nc(t,n){let o=n.filter(c=>!["window","document","prevent","stop","once","capture","self","away","outside","passive"].includes(c));if(o.includes("debounce")){let c=o.indexOf("debounce");o.splice(c,Xn((o[c+1]||"invalid-wait").split("ms")[0])?2:1)}if(o.includes("throttle")){let c=o.indexOf("throttle");o.splice(c,Xn((o[c+1]||"invalid-wait").split("ms")[0])?2:1)}if(o.length===0||o.length===1&&$o(t.key).includes(o[0]))return!1;const u=["ctrl","shift","alt","meta","cmd","super"].filter(c=>o.includes(c));return o=o.filter(c=>!u.includes(c)),!(u.length>0&&u.filter(d=>((d==="cmd"||d==="super")&&(d="meta"),t[`${d}Key`])).length===u.length&&(Ga(t.type)||$o(t.key).includes(o[0])))}function $o(t){if(!t)return[];t=Fc(t);let n={ctrl:"control",slash:"/",space:" ",spacebar:" ",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",comma:",",equal:"=",minus:"-",underscore:"_"};return n[t]=t,Object.keys(n).map(o=>{if(n[o]===t)return o}).filter(o=>o)}dt("model",(t,{modifiers:n,expression:o},{effect:i,cleanup:u})=>{let c=t;n.includes("parent")&&(c=t.parentNode);let d=bt(c,o),h;typeof o=="string"?h=bt(c,`${o} = __placeholder`):typeof o=="function"&&typeof o()=="string"?h=bt(c,`${o()} = __placeholder`):h=()=>{};let m=()=>{let $;return d(q=>$=q),Mo($)?$.get():$},T=$=>{let q;d(z=>q=z),Mo(q)?q.set($):h(()=>{},{scope:{__placeholder:$}})};typeof o=="string"&&t.type==="radio"&&st(()=>{t.hasAttribute("name")||t.setAttribute("name",o)});var O=t.tagName.toLowerCase()==="select"||["checkbox","radio"].includes(t.type)||n.includes("lazy")?"change":"input";let C=Vt?()=>{}:gi(t,O,n,$=>{T(Gr(t,n,$,m()))});if(n.includes("fill")&&([void 0,null,""].includes(m())||Ci(t)&&Array.isArray(m())||t.tagName.toLowerCase()==="select"&&t.multiple)&&T(Gr(t,n,{target:t},m())),t._x_removeModelListeners||(t._x_removeModelListeners={}),t._x_removeModelListeners.default=C,u(()=>t._x_removeModelListeners.default()),t.form){let $=gi(t.form,"reset",[],q=>{Oi(()=>t._x_model&&t._x_model.set(Gr(t,n,{target:t},m())))});u(()=>$())}t._x_model={get(){return m()},set($){T($)}},t._x_forceModelUpdate=$=>{$===void 0&&typeof o=="string"&&o.match(/\./)&&($=""),window.fromModel=!0,st(()=>xa(t,"value",$)),delete window.fromModel},i(()=>{let $=m();n.includes("unintrusive")&&document.activeElement.isSameNode(t)||t._x_forceModelUpdate($)})});function Gr(t,n,o,i){return st(()=>{if(o instanceof CustomEvent&&o.detail!==void 0)return o.detail!==null&&o.detail!==void 0?o.detail:o.target.value;if(Ci(t))if(Array.isArray(i)){let u=null;return n.includes("number")?u=Xr(o.target.value):n.includes("boolean")?u=zn(o.target.value):u=o.target.value,o.target.checked?i.includes(u)?i:i.concat([u]):i.filter(c=>!Kc(c,u))}else return o.target.checked;else{if(t.tagName.toLowerCase()==="select"&&t.multiple)return n.includes("number")?Array.from(o.target.selectedOptions).map(u=>{let c=u.value||u.text;return Xr(c)}):n.includes("boolean")?Array.from(o.target.selectedOptions).map(u=>{let c=u.value||u.text;return zn(c)}):Array.from(o.target.selectedOptions).map(u=>u.value||u.text);{let u;return Da(t)?o.target.checked?u=o.target.value:u=i:u=o.target.value,n.includes("number")?Xr(u):n.includes("boolean")?zn(u):n.includes("trim")?u.trim():u}}})}function Xr(t){let n=t?parseFloat(t):null;return Bc(n)?n:t}function Kc(t,n){return t==n}function Bc(t){return!Array.isArray(t)&&!isNaN(t)}function Mo(t){return t!==null&&typeof t=="object"&&typeof t.get=="function"&&typeof t.set=="function"}dt("cloak",t=>queueMicrotask(()=>st(()=>t.removeAttribute(Me("cloak")))));ya(()=>`[${Me("init")}]`);dt("init",Gt((t,{expression:n},{evaluate:o})=>typeof n=="string"?!!n.trim()&&o(n,{},!1):o(n,{},!1)));dt("text",(t,{expression:n},{effect:o,evaluateLater:i})=>{let u=i(n);o(()=>{u(c=>{st(()=>{t.textContent=c})})})});dt("html",(t,{expression:n},{effect:o,evaluateLater:i})=>{let u=i(n);o(()=>{u(c=>{st(()=>{t.innerHTML=c,t._x_ignoreSelf=!0,Nt(t),delete t._x_ignoreSelf})})})});ki(sa(":",ua(Me("bind:"))));var Xa=(t,{value:n,modifiers:o,expression:i,original:u},{effect:c,cleanup:d})=>{if(!n){let m={};zu(m),bt(t,i)(O=>{Ia(t,O,u)},{scope:m});return}if(n==="key")return qc(t,i);if(t._x_inlineBindings&&t._x_inlineBindings[n]&&t._x_inlineBindings[n].extract)return;let h=bt(t,i);c(()=>h(m=>{m===void 0&&typeof i=="string"&&i.match(/\./)&&(m=""),st(()=>xa(t,n,m,o))})),d(()=>{t._x_undoAddedClasses&&t._x_undoAddedClasses(),t._x_undoAddedStyles&&t._x_undoAddedStyles()})};Xa.inline=(t,{value:n,modifiers:o,expression:i})=>{n&&(t._x_inlineBindings||(t._x_inlineBindings={}),t._x_inlineBindings[n]={expression:i,extract:!1})};dt("bind",Xa);function qc(t,n){t._x_keyExpression=n}ma(()=>`[${Me("data")}]`);dt("data",(t,{expression:n},{cleanup:o})=>{if(Hc(t))return;n=n===""?"{}":n;let i={};ii(i,t);let u={};Vu(u,i);let c=he(t,n,{scope:u});(c===void 0||c===!0)&&(c={}),ii(c,t);let d=Ie(c);Qo(d);let h=an(t,d);d.init&&he(t,d.init),o(()=>{d.destroy&&he(t,d.destroy),h()})});er((t,n)=>{t._x_dataStack&&(n._x_dataStack=t._x_dataStack,n.setAttribute("data-has-alpine-state",!0))});function Hc(t){return Vt?di?!0:t.hasAttribute("data-has-alpine-state"):!1}dt("show",(t,{modifiers:n,expression:o},{effect:i})=>{let u=bt(t,o);t._x_doHide||(t._x_doHide=()=>{st(()=>{t.style.setProperty("display","none",n.includes("important")?"important":void 0)})}),t._x_doShow||(t._x_doShow=()=>{st(()=>{t.style.length===1&&t.style.display==="none"?t.removeAttribute("style"):t.style.removeProperty("display")})});let c=()=>{t._x_doHide(),t._x_isShown=!1},d=()=>{t._x_doShow(),t._x_isShown=!0},h=()=>setTimeout(d),m=ci(C=>C?d():c(),C=>{typeof t._x_toggleAndCascadeWithTransitions=="function"?t._x_toggleAndCascadeWithTransitions(t,C,d,c):C?h():c()}),T,O=!0;i(()=>u(C=>{!O&&C===T||(n.includes("immediate")&&(C?h():c()),m(C),T=C,O=!1)}))});dt("for",(t,{expression:n},{effect:o,cleanup:i})=>{let u=Wc(n),c=bt(t,u.items),d=bt(t,t._x_keyExpression||"index");t._x_prevKeys=[],t._x_lookup={},o(()=>Uc(t,u,c,d)),i(()=>{Object.values(t._x_lookup).forEach(h=>st(()=>{Re(h),h.remove()})),delete t._x_prevKeys,delete t._x_lookup})});function Uc(t,n,o,i){let u=d=>typeof d=="object"&&!Array.isArray(d),c=t;o(d=>{zc(d)&&d>=0&&(d=Array.from(Array(d).keys(),H=>H+1)),d===void 0&&(d=[]);let h=t._x_lookup,m=t._x_prevKeys,T=[],O=[];if(u(d))d=Object.entries(d).map(([H,Y])=>{let Z=jo(n,Y,H,d);i(ot=>{O.includes(ot)&&Et("Duplicate key on x-for",t),O.push(ot)},{scope:{index:H,...Z}}),T.push(Z)});else for(let H=0;H<d.length;H++){let Y=jo(n,d[H],H,d);i(Z=>{O.includes(Z)&&Et("Duplicate key on x-for",t),O.push(Z)},{scope:{index:H,...Y}}),T.push(Y)}let C=[],$=[],q=[],z=[];for(let H=0;H<m.length;H++){let Y=m[H];O.indexOf(Y)===-1&&q.push(Y)}m=m.filter(H=>!q.includes(H));let et="template";for(let H=0;H<O.length;H++){let Y=O[H],Z=m.indexOf(Y);if(Z===-1)m.splice(H,0,Y),C.push([et,H]);else if(Z!==H){let ot=m.splice(H,1)[0],lt=m.splice(Z-1,1)[0];m.splice(H,0,lt),m.splice(Z,0,ot),$.push([ot,lt])}else z.push(Y);et=Y}for(let H=0;H<q.length;H++){let Y=q[H];Y in h&&(st(()=>{Re(h[Y]),h[Y].remove()}),delete h[Y])}for(let H=0;H<$.length;H++){let[Y,Z]=$[H],ot=h[Y],lt=h[Z],$t=document.createElement("div");st(()=>{lt||Et('x-for ":key" is undefined or invalid',c,Z,h),lt.after($t),ot.after(lt),lt._x_currentIfEl&&lt.after(lt._x_currentIfEl),$t.before(ot),ot._x_currentIfEl&&ot.after(ot._x_currentIfEl),$t.remove()}),lt._x_refreshXForScope(T[O.indexOf(Z)])}for(let H=0;H<C.length;H++){let[Y,Z]=C[H],ot=Y==="template"?c:h[Y];ot._x_currentIfEl&&(ot=ot._x_currentIfEl);let lt=T[Z],$t=O[Z],vt=document.importNode(c.content,!0).firstElementChild,pt=Ie(lt);an(vt,pt,c),vt._x_refreshXForScope=cn=>{Object.entries(cn).forEach(([ar,ln])=>{pt[ar]=ln})},st(()=>{ot.after(vt),Gt(()=>Nt(vt))()}),typeof $t=="object"&&Et("x-for key cannot be an object, it must be a string or an integer",c),h[$t]=vt}for(let H=0;H<z.length;H++)h[z[H]]._x_refreshXForScope(T[O.indexOf(z[H])]);c._x_prevKeys=O})}function Wc(t){let n=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,o=/^\s*\(|\)\s*$/g,i=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,u=t.match(i);if(!u)return;let c={};c.items=u[2].trim();let d=u[1].replace(o,"").trim(),h=d.match(n);return h?(c.item=d.replace(n,"").trim(),c.index=h[1].trim(),h[2]&&(c.collection=h[2].trim())):c.item=d,c}function jo(t,n,o,i){let u={};return/^\[.*\]$/.test(t.item)&&Array.isArray(n)?t.item.replace("[","").replace("]","").split(",").map(d=>d.trim()).forEach((d,h)=>{u[d]=n[h]}):/^\{.*\}$/.test(t.item)&&!Array.isArray(n)&&typeof n=="object"?t.item.replace("{","").replace("}","").split(",").map(d=>d.trim()).forEach(d=>{u[d]=n[d]}):u[t.item]=n,t.index&&(u[t.index]=o),t.collection&&(u[t.collection]=i),u}function zc(t){return!Array.isArray(t)&&!isNaN(t)}function Qa(){}Qa.inline=(t,{expression:n},{cleanup:o})=>{let i=Zn(t);i._x_refs||(i._x_refs={}),i._x_refs[n]=t,o(()=>delete i._x_refs[n])};dt("ref",Qa);dt("if",(t,{expression:n},{effect:o,cleanup:i})=>{t.tagName.toLowerCase()!=="template"&&Et("x-if can only be used on a <template> tag",t);let u=bt(t,n),c=()=>{if(t._x_currentIfEl)return t._x_currentIfEl;let h=t.content.cloneNode(!0).firstElementChild;return an(h,{},t),st(()=>{t.after(h),Gt(()=>Nt(h))()}),t._x_currentIfEl=h,t._x_undoIf=()=>{st(()=>{Re(h),h.remove()}),delete t._x_currentIfEl},h},d=()=>{t._x_undoIf&&(t._x_undoIf(),delete t._x_undoIf)};o(()=>u(h=>{h?c():d()})),i(()=>t._x_undoIf&&t._x_undoIf())});dt("id",(t,{expression:n},{evaluate:o})=>{o(n).forEach(u=>Ic(t,u))});er((t,n)=>{t._x_ids&&(n._x_ids=t._x_ids)});ki(sa("@",ua(Me("on:"))));dt("on",Gt((t,{value:n,modifiers:o,expression:i},{cleanup:u})=>{let c=i?bt(t,i):()=>{};t.tagName.toLowerCase()==="template"&&(t._x_forwardEvents||(t._x_forwardEvents=[]),t._x_forwardEvents.includes(n)||t._x_forwardEvents.push(n));let d=gi(t,n,o,h=>{c(()=>{},{scope:{$event:h},params:[h]})});u(()=>d())}));or("Collapse","collapse","collapse");or("Intersect","intersect","intersect");or("Focus","trap","focus");or("Mask","mask","mask");function or(t,n,o){dt(n,i=>Et(`You can't use [x-${n}] without first installing the "${t}" plugin here: https://alpinejs.dev/plugins/${o}`,i))}un.setEvaluator(ra);un.setReactivityEngine({reactive:Li,effect:ic,release:oc,raw:it});var Jc=un,At=Jc;function Vc(){return{currentPage:"timer",init(){const t=window.Alpine.store("theme");t?.init&&t.init(),this.initRouting()},initRouting(){this.currentPage=this.getPageFromHash(),window.addEventListener("hashchange",()=>{const t=this.getPageFromHash();this.currentPage=t,window.dispatchEvent(new CustomEvent("pageChanged",{detail:{page:t}}))}),this.$watch("currentPage",t=>{this.updateHash(t)})},getPageFromHash(){const t=window.location.hash.slice(1);return["timer","timeline","insights","settings"].includes(t)?t:"timer"},updateHash(t){const n=`#${t}`;window.location.hash!==n&&(window.location.hash=n)},navigateTo(t){this.currentPage=t,window.dispatchEvent(new CustomEvent("pageChanged",{detail:{page:t}}))},toggleTheme(){window.Alpine.store("theme").toggle()},applyTheme(){window.Alpine.store("theme").apply()}}}const Yc="modulepreload",Gc=function(t){return"/"+t},Ro={},Ae=function(n,o,i){let u=Promise.resolve();if(o&&o.length>0){let m=function(T){return Promise.all(T.map(O=>Promise.resolve(O).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=d?.nonce||d?.getAttribute("nonce");u=m(o.map(T=>{if(T=Gc(T),T in Ro)return;Ro[T]=!0;const O=T.endsWith(".css"),C=O?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${T}"]${C}`))return;const $=document.createElement("link");if($.rel=O?"stylesheet":Yc,O||($.as="script"),$.crossOrigin="",$.href=T,h&&$.setAttribute("nonce",h),document.head.appendChild($),O)return new Promise((q,z)=>{$.addEventListener("load",q),$.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${T}`)))})}))}function c(d){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=d,window.dispatchEvent(h),!h.defaultPrevented)throw d}return u.then(d=>{for(const h of d||[])h.status==="rejected"&&c(h.reason);return n().catch(c)})},Xc=(t=null)=>({currentActivityId:t,activities:[],todayDurations:{},init(){this.loadActivitiesFromSettings(),this.loadTodayDurations(),window.addEventListener("entryAdded",()=>this.loadTodayDurations()),window.addEventListener("entryUpdated",()=>this.loadTodayDurations()),window.addEventListener("entryDeleted",()=>this.loadTodayDurations()),window.addEventListener("activities-updated",()=>{this.loadActivitiesFromSettings(),this.loadTodayDurations()})},loadActivitiesFromSettings(){try{const n=localStorage.getItem("appSettings");if(n){const o=JSON.parse(n);if(o.categories){this.activities=o.categories.map(i=>({id:i.id,label:i.label,icon:i.icon,color:i.color,aliases:[i.label.toLowerCase(),...i.subcategories],subcategories:i.subcategories}));return}}}catch(n){console.error("Error loading activities from settings:",n)}this.activities=this.getDefaultActivities()},getDefaultActivities(){return[{id:"work",label:"Work",icon:"💼",color:"#6366f1",aliases:["working","worked","coding","code","development","dev"],subcategories:["coding","planning","research","review"]},{id:"break",label:"Break",icon:"☕",color:"#10b981",aliases:["lunch","coffee","rest","pause","eating","break"],subcategories:["lunch","coffee","rest"]},{id:"meeting",label:"Meeting",icon:"👥",color:"#f59e0b",aliases:["call","standup","sync","meeting","conference","discussion"],subcategories:["standup","planning","review","call"]},{id:"personal",label:"Personal",icon:"🏠",color:"#ec4899",aliases:["home","family","private","personal","life","errands"],subcategories:["planning","reading","family","hobbies"]}]},async loadTodayDurations(){const n={};this.activities.forEach(o=>{n[o.id]=0});try{const{db:o}=await Ae(async()=>{const{db:h}=await Promise.resolve().then(()=>yi);return{db:h}},void 0),i=new Date,u=new Date(i.getFullYear(),i.getMonth(),i.getDate()),c=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1);(await o.entries.where("startTime").between(u,c).and(h=>!h.deletedAt).toArray()).forEach(h=>{const m=this.findActivityByDescription(h.description);m&&h.duration&&(n[m.id]=(n[m.id]||0)+h.duration)}),this.todayDurations=n}catch(o){console.error("Failed to load today durations:",o),this.todayDurations=n,window.Alpine.store("notifications").showError("Failed to load activity durations")}},findActivity(n){if(!n)return null;const o=n.toLowerCase();for(const i of this.activities)if(i.label.toLowerCase()===o||i.id.toLowerCase()===o||i.aliases.some(u=>o.includes(u)))return i;return null},findActivityByDescription(n){if(!n)return null;const o=n.toLowerCase();for(const i of this.activities)if(i.aliases.some(u=>o.includes(u)))return i;for(const i of this.activities)if(o.includes(i.id.toLowerCase()))return i;return null},formatDurationFromSeconds(n){if(n<60)return`${n}s`;if(n<3600)return`${Math.floor(n/60)}m`;const o=Math.floor(n/3600),i=Math.floor(n%3600/60);return`${o}h${i>0?` ${i}m`:""}`}});var Qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Jn={exports:{}},tl=Jn.exports,Fo;function el(){return Fo||(Fo=1,(function(t,n){(function(o,i){t.exports=i()})(tl,function(){var o=function(e,r){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(a[l]=s[l])})(e,r)},i=function(){return(i=Object.assign||function(e){for(var r,a=1,s=arguments.length;a<s;a++)for(var l in r=arguments[a])Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l]);return e}).apply(this,arguments)};function u(e,r,a){for(var s,l=0,f=r.length;l<f;l++)!s&&l in r||((s=s||Array.prototype.slice.call(r,0,l))[l]=r[l]);return e.concat(s||Array.prototype.slice.call(r))}var c=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Qc,d=Object.keys,h=Array.isArray;function m(e,r){return typeof r!="object"||d(r).forEach(function(a){e[a]=r[a]}),e}typeof Promise>"u"||c.Promise||(c.Promise=Promise);var T=Object.getPrototypeOf,O={}.hasOwnProperty;function C(e,r){return O.call(e,r)}function $(e,r){typeof r=="function"&&(r=r(T(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(r).forEach(function(a){z(e,a,r[a])})}var q=Object.defineProperty;function z(e,r,a,s){q(e,r,m(a&&C(a,"get")&&typeof a.get=="function"?{get:a.get,set:a.set,configurable:!0}:{value:a,configurable:!0,writable:!0},s))}function et(e){return{from:function(r){return e.prototype=Object.create(r.prototype),z(e.prototype,"constructor",e),{extend:$.bind(null,e.prototype)}}}}var H=Object.getOwnPropertyDescriptor,Y=[].slice;function Z(e,r,a){return Y.call(e,r,a)}function ot(e,r){return r(e)}function lt(e){if(!e)throw new Error("Assertion Failed")}function $t(e){c.setImmediate?setImmediate(e):setTimeout(e,0)}function vt(e,r){if(typeof r=="string"&&C(e,r))return e[r];if(!r)return e;if(typeof r!="string"){for(var a=[],s=0,l=r.length;s<l;++s){var f=vt(e,r[s]);a.push(f)}return a}var p=r.indexOf(".");if(p!==-1){var g=e[r.substr(0,p)];return g==null?void 0:vt(g,r.substr(p+1))}}function pt(e,r,a){if(e&&r!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof r!="string"&&"length"in r){lt(typeof a!="string"&&"length"in a);for(var s=0,l=r.length;s<l;++s)pt(e,r[s],a[s])}else{var f,p,g=r.indexOf(".");g!==-1?(f=r.substr(0,g),(p=r.substr(g+1))===""?a===void 0?h(e)&&!isNaN(parseInt(f))?e.splice(f,1):delete e[f]:e[f]=a:pt(g=!(g=e[f])||!C(e,f)?e[f]={}:g,p,a)):a===void 0?h(e)&&!isNaN(parseInt(r))?e.splice(r,1):delete e[r]:e[r]=a}}function cn(e){var r,a={};for(r in e)C(e,r)&&(a[r]=e[r]);return a}var ar=[].concat;function ln(e){return ar.apply([],e)}var te="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ln([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(r){return r+e+"Array"})}))).filter(function(e){return c[e]}),Ni=new Set(te.map(function(e){return c[e]})),Fe=null;function Xt(e){return Fe=new WeakMap,e=(function r(a){if(!a||typeof a!="object")return a;var s=Fe.get(a);if(s)return s;if(h(a)){s=[],Fe.set(a,s);for(var l=0,f=a.length;l<f;++l)s.push(r(a[l]))}else if(Ni.has(a.constructor))s=a;else{var p,g=T(a);for(p in s=g===Object.prototype?{}:Object.create(g),Fe.set(a,s),a)C(a,p)&&(s[p]=r(a[p]))}return s})(e),Fe=null,e}var rs={}.toString;function sr(e){return rs.call(e).slice(8,-1)}var ur=typeof Symbol<"u"?Symbol.iterator:"@@iterator",is=typeof ur=="symbol"?function(e){var r;return e!=null&&(r=e[ur])&&r.apply(e)}:function(){return null};function Qt(e,r){return r=e.indexOf(r),0<=r&&e.splice(r,1),0<=r}var ve={};function Mt(e){var r,a,s,l;if(arguments.length===1){if(h(e))return e.slice();if(this===ve&&typeof e=="string")return[e];if(l=is(e)){for(a=[];!(s=l.next()).done;)a.push(s.value);return a}if(e==null)return[e];if(typeof(r=e.length)!="number")return[e];for(a=new Array(r);r--;)a[r]=e[r];return a}for(r=arguments.length,a=new Array(r);r--;)a[r]=arguments[r];return a}var cr=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ke=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Tt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ke),os={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function we(e,r){this.name=e,this.message=r}function Ki(e,r){return e+". Errors: "+Object.keys(r).map(function(a){return r[a].toString()}).filter(function(a,s,l){return l.indexOf(a)===s}).join(`
`)}function dn(e,r,a,s){this.failures=r,this.failedKeys=s,this.successCount=a,this.message=Ki(e,r)}function be(e,r){this.name="BulkError",this.failures=Object.keys(r).map(function(a){return r[a]}),this.failuresByPos=r,this.message=Ki(e,this.failures)}et(we).from(Error).extend({toString:function(){return this.name+": "+this.message}}),et(dn).from(we),et(be).from(we);var lr=Tt.reduce(function(e,r){return e[r]=r+"Error",e},{}),as=we,W=Tt.reduce(function(e,r){var a=r+"Error";function s(l,f){this.name=a,l?typeof l=="string"?(this.message="".concat(l).concat(f?`
 `+f:""),this.inner=f||null):typeof l=="object"&&(this.message="".concat(l.name," ").concat(l.message),this.inner=l):(this.message=os[r]||a,this.inner=null)}return et(s).from(as),e[r]=s,e},{});W.Syntax=SyntaxError,W.Type=TypeError,W.Range=RangeError;var Bi=Ke.reduce(function(e,r){return e[r+"Error"]=W[r],e},{}),fn=Tt.reduce(function(e,r){return["Syntax","Type","Range"].indexOf(r)===-1&&(e[r+"Error"]=W[r]),e},{});function nt(){}function Le(e){return e}function ss(e,r){return e==null||e===Le?r:function(a){return r(e(a))}}function Zt(e,r){return function(){e.apply(this,arguments),r.apply(this,arguments)}}function us(e,r){return e===nt?r:function(){var a=e.apply(this,arguments);a!==void 0&&(arguments[0]=a);var s=this.onsuccess,l=this.onerror;this.onsuccess=null,this.onerror=null;var f=r.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Zt(s,this.onsuccess):s),l&&(this.onerror=this.onerror?Zt(l,this.onerror):l),f!==void 0?f:a}}function cs(e,r){return e===nt?r:function(){e.apply(this,arguments);var a=this.onsuccess,s=this.onerror;this.onsuccess=this.onerror=null,r.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?Zt(a,this.onsuccess):a),s&&(this.onerror=this.onerror?Zt(s,this.onerror):s)}}function ls(e,r){return e===nt?r:function(a){var s=e.apply(this,arguments);m(a,s);var l=this.onsuccess,f=this.onerror;return this.onsuccess=null,this.onerror=null,a=r.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?Zt(l,this.onsuccess):l),f&&(this.onerror=this.onerror?Zt(f,this.onerror):f),s===void 0?a===void 0?void 0:a:m(s,a)}}function ds(e,r){return e===nt?r:function(){return r.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function dr(e,r){return e===nt?r:function(){var a=e.apply(this,arguments);if(a&&typeof a.then=="function"){for(var s=this,l=arguments.length,f=new Array(l);l--;)f[l]=arguments[l];return a.then(function(){return r.apply(s,f)})}return r.apply(this,arguments)}}fn.ModifyError=dn,fn.DexieError=we,fn.BulkError=be;var Ot=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function qi(e){Ot=e}var Ne={},Hi=100,te=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,T(e),e];var r=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[r,T(r),e]})(),Ke=te[0],Tt=te[1],te=te[2],Tt=Tt&&Tt.then,ee=Ke&&Ke.constructor,fr=!!te,Be=function(e,r){qe.push([e,r]),hn&&(queueMicrotask(hs),hn=!1)},hr=!0,hn=!0,ne=[],pn=[],pr=Le,Kt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:nt,pgp:!1,env:{},finalize:nt},U=Kt,qe=[],re=0,gn=[];function K(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var r=this._PSD=U;if(typeof e!="function"){if(e!==Ne)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&mr(this,this._value))}this._state=null,this._value=null,++r.ref,(function a(s,l){try{l(function(f){if(s._state===null){if(f===s)throw new TypeError("A promise cannot be resolved with itself.");var p=s._lib&&_e();f&&typeof f.then=="function"?a(s,function(g,v){f instanceof K?f._then(g,v):f.then(g,v)}):(s._state=!0,s._value=f,Wi(s)),p&&Se()}},mr.bind(null,s))}catch(f){mr(s,f)}})(this,e)}var gr={get:function(){var e=U,r=wn;function a(s,l){var f=this,p=!e.global&&(e!==U||r!==wn),g=p&&!qt(),v=new K(function(b,x){yr(f,new Ui(Ji(s,e,p,g),Ji(l,e,p,g),b,x,e))});return this._consoleTask&&(v._consoleTask=this._consoleTask),v}return a.prototype=Ne,a},set:function(e){z(this,"then",e&&e.prototype===Ne?gr:{get:function(){return e},set:gr.set})}};function Ui(e,r,a,s,l){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof r=="function"?r:null,this.resolve=a,this.reject=s,this.psd=l}function mr(e,r){var a,s;pn.push(r),e._state===null&&(a=e._lib&&_e(),r=pr(r),e._state=!1,e._value=r,s=e,ne.some(function(l){return l._value===s._value})||ne.push(s),Wi(e),a&&Se())}function Wi(e){var r=e._listeners;e._listeners=[];for(var a=0,s=r.length;a<s;++a)yr(e,r[a]);var l=e._PSD;--l.ref||l.finalize(),re===0&&(++re,Be(function(){--re==0&&vr()},[]))}function yr(e,r){if(e._state!==null){var a=e._state?r.onFulfilled:r.onRejected;if(a===null)return(e._state?r.resolve:r.reject)(e._value);++r.psd.ref,++re,Be(fs,[a,e,r])}else e._listeners.push(r)}function fs(e,r,a){try{var s,l=r._value;!r._state&&pn.length&&(pn=[]),s=Ot&&r._consoleTask?r._consoleTask.run(function(){return e(l)}):e(l),r._state||pn.indexOf(l)!==-1||(function(f){for(var p=ne.length;p;)if(ne[--p]._value===f._value)return ne.splice(p,1)})(r),a.resolve(s)}catch(f){a.reject(f)}finally{--re==0&&vr(),--a.psd.ref||a.psd.finalize()}}function hs(){ie(Kt,function(){_e()&&Se()})}function _e(){var e=hr;return hn=hr=!1,e}function Se(){var e,r,a;do for(;0<qe.length;)for(e=qe,qe=[],a=e.length,r=0;r<a;++r){var s=e[r];s[0].apply(null,s[1])}while(0<qe.length);hn=hr=!0}function vr(){var e=ne;ne=[],e.forEach(function(s){s._PSD.onunhandled.call(null,s._value,s)});for(var r=gn.slice(0),a=r.length;a;)r[--a]()}function mn(e){return new K(Ne,!1,e)}function at(e,r){var a=U;return function(){var s=_e(),l=U;try{return Ht(a,!0),e.apply(this,arguments)}catch(f){r&&r(f)}finally{Ht(l,!1),s&&Se()}}}$(K.prototype,{then:gr,_then:function(e,r){yr(this,new Ui(null,null,e,r,U))},catch:function(e){if(arguments.length===1)return this.then(null,e);var r=e,a=arguments[1];return typeof r=="function"?this.then(null,function(s){return(s instanceof r?a:mn)(s)}):this.then(null,function(s){return(s&&s.name===r?a:mn)(s)})},finally:function(e){return this.then(function(r){return K.resolve(e()).then(function(){return r})},function(r){return K.resolve(e()).then(function(){return mn(r)})})},timeout:function(e,r){var a=this;return e<1/0?new K(function(s,l){var f=setTimeout(function(){return l(new W.Timeout(r))},e);a.then(s,l).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&z(K.prototype,Symbol.toStringTag,"Dexie.Promise"),Kt.env=zi(),$(K,{all:function(){var e=Mt.apply(null,arguments).map(bn);return new K(function(r,a){e.length===0&&r([]);var s=e.length;e.forEach(function(l,f){return K.resolve(l).then(function(p){e[f]=p,--s||r(e)},a)})})},resolve:function(e){return e instanceof K?e:e&&typeof e.then=="function"?new K(function(r,a){e.then(r,a)}):new K(Ne,!0,e)},reject:mn,race:function(){var e=Mt.apply(null,arguments).map(bn);return new K(function(r,a){e.map(function(s){return K.resolve(s).then(r,a)})})},PSD:{get:function(){return U},set:function(e){return U=e}},totalEchoes:{get:function(){return wn}},newPSD:Bt,usePSD:ie,scheduler:{get:function(){return Be},set:function(e){Be=e}},rejectionMapper:{get:function(){return pr},set:function(e){pr=e}},follow:function(e,r){return new K(function(a,s){return Bt(function(l,f){var p=U;p.unhandleds=[],p.onunhandled=f,p.finalize=Zt(function(){var g,v=this;g=function(){v.unhandleds.length===0?l():f(v.unhandleds[0])},gn.push(function b(){g(),gn.splice(gn.indexOf(b),1)}),++re,Be(function(){--re==0&&vr()},[])},p.finalize),e()},r,a,s)})}}),ee&&(ee.allSettled&&z(K,"allSettled",function(){var e=Mt.apply(null,arguments).map(bn);return new K(function(r){e.length===0&&r([]);var a=e.length,s=new Array(a);e.forEach(function(l,f){return K.resolve(l).then(function(p){return s[f]={status:"fulfilled",value:p}},function(p){return s[f]={status:"rejected",reason:p}}).then(function(){return--a||r(s)})})})}),ee.any&&typeof AggregateError<"u"&&z(K,"any",function(){var e=Mt.apply(null,arguments).map(bn);return new K(function(r,a){e.length===0&&a(new AggregateError([]));var s=e.length,l=new Array(s);e.forEach(function(f,p){return K.resolve(f).then(function(g){return r(g)},function(g){l[p]=g,--s||a(new AggregateError(l))})})})}),ee.withResolvers&&(K.withResolvers=ee.withResolvers));var ft={awaits:0,echoes:0,id:0},ps=0,yn=[],vn=0,wn=0,gs=0;function Bt(e,r,a,s){var l=U,f=Object.create(l);return f.parent=l,f.ref=0,f.global=!1,f.id=++gs,Kt.env,f.env=fr?{Promise:K,PromiseProp:{value:K,configurable:!0,writable:!0},all:K.all,race:K.race,allSettled:K.allSettled,any:K.any,resolve:K.resolve,reject:K.reject}:{},r&&m(f,r),++l.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()},s=ie(f,e,a,s),f.ref===0&&f.finalize(),s}function xe(){return ft.id||(ft.id=++ps),++ft.awaits,ft.echoes+=Hi,ft.id}function qt(){return!!ft.awaits&&(--ft.awaits==0&&(ft.id=0),ft.echoes=ft.awaits*Hi,!0)}function bn(e){return ft.echoes&&e&&e.constructor===ee?(xe(),e.then(function(r){return qt(),r},function(r){return qt(),ut(r)})):e}function ms(){var e=yn[yn.length-1];yn.pop(),Ht(e,!1)}function Ht(e,r){var a,s=U;(r?!ft.echoes||vn++&&e===U:!vn||--vn&&e===U)||queueMicrotask(r?function(l){++wn,ft.echoes&&--ft.echoes!=0||(ft.echoes=ft.awaits=ft.id=0),yn.push(U),Ht(l,!0)}.bind(null,e):ms),e!==U&&(U=e,s===Kt&&(Kt.env=zi()),fr&&(a=Kt.env.Promise,r=e.env,(s.global||e.global)&&(Object.defineProperty(c,"Promise",r.PromiseProp),a.all=r.all,a.race=r.race,a.resolve=r.resolve,a.reject=r.reject,r.allSettled&&(a.allSettled=r.allSettled),r.any&&(a.any=r.any))))}function zi(){var e=c.Promise;return fr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(c,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ie(e,r,a,s,l){var f=U;try{return Ht(e,!0),r(a,s,l)}finally{Ht(f,!1)}}function Ji(e,r,a,s){return typeof e!="function"?e:function(){var l=U;a&&xe(),Ht(r,!0);try{return e.apply(this,arguments)}finally{Ht(l,!1),s&&queueMicrotask(qt)}}}function wr(e){Promise===ee&&ft.echoes===0?vn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Tt).indexOf("[native code]")===-1&&(xe=qt=nt);var ut=K.reject,oe="￿",jt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Vi="String expected.",Te=[],_n="__dbnames",br="readonly",_r="readwrite";function ae(e,r){return e?r?function(){return e.apply(this,arguments)&&r.apply(this,arguments)}:e:r}var Yi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Sn(e){return typeof e!="string"||/\./.test(e)?function(r){return r}:function(r){return r[e]===void 0&&e in r&&delete(r=Xt(r))[e],r}}function Gi(){throw W.Type()}function Q(e,r){try{var a=Xi(e),s=Xi(r);if(a!==s)return a==="Array"?1:s==="Array"?-1:a==="binary"?1:s==="binary"?-1:a==="string"?1:s==="string"?-1:a==="Date"?1:s!=="Date"?NaN:-1;switch(a){case"number":case"Date":case"string":return r<e?1:e<r?-1:0;case"binary":return(function(l,f){for(var p=l.length,g=f.length,v=p<g?p:g,b=0;b<v;++b)if(l[b]!==f[b])return l[b]<f[b]?-1:1;return p===g?0:p<g?-1:1})(Qi(e),Qi(r));case"Array":return(function(l,f){for(var p=l.length,g=f.length,v=p<g?p:g,b=0;b<v;++b){var x=Q(l[b],f[b]);if(x!==0)return x}return p===g?0:p<g?-1:1})(e,r)}}catch{}return NaN}function Xi(e){var r=typeof e;return r!="object"?r:ArrayBuffer.isView(e)?"binary":(e=sr(e),e==="ArrayBuffer"?"binary":e)}function Qi(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Zi=(rt.prototype._trans=function(e,r,a){var s=this._tx||U.trans,l=this.name,f=Ot&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function p(b,x,y){if(!y.schema[l])throw new W.NotFound("Table "+l+" not part of transaction");return r(y.idbtrans,y)}var g=_e();try{var v=s&&s.db._novip===this.db._novip?s===U.trans?s._promise(e,p,a):Bt(function(){return s._promise(e,p,a)},{trans:s,transless:U.transless||U}):(function b(x,y,k,w){if(x.idbdb&&(x._state.openComplete||U.letThrough||x._vip)){var S=x._createTransaction(y,k,x._dbSchema);try{S.create(),x._state.PR1398_maxLoop=3}catch(E){return E.name===lr.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return b(x,y,k,w)})):ut(E)}return S._promise(y,function(E,_){return Bt(function(){return U.trans=S,w(E,_,S)})}).then(function(E){if(y==="readwrite")try{S.idbtrans.commit()}catch{}return y==="readonly"?E:S._completion.then(function(){return E})})}if(x._state.openComplete)return ut(new W.DatabaseClosed(x._state.dbOpenError));if(!x._state.isBeingOpened){if(!x._state.autoOpen)return ut(new W.DatabaseClosed);x.open().catch(nt)}return x._state.dbReadyPromise.then(function(){return b(x,y,k,w)})})(this.db,e,[this.name],p);return f&&(v._consoleTask=f,v=v.catch(function(b){return console.trace(b),ut(b)})),v}finally{g&&Se()}},rt.prototype.get=function(e,r){var a=this;return e&&e.constructor===Object?this.where(e).first(r):e==null?ut(new W.Type("Invalid argument to Table.get()")):this._trans("readonly",function(s){return a.core.get({trans:s,key:e}).then(function(l){return a.hook.reading.fire(l)})}).then(r)},rt.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(h(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var r=d(e);if(r.length===1)return this.where(r[0]).equals(e[r[0]]);var a=this.schema.indexes.concat(this.schema.primKey).filter(function(g){if(g.compound&&r.every(function(b){return 0<=g.keyPath.indexOf(b)})){for(var v=0;v<r.length;++v)if(r.indexOf(g.keyPath[v])===-1)return!1;return!0}return!1}).sort(function(g,v){return g.keyPath.length-v.keyPath.length})[0];if(a&&this.db._maxKey!==oe){var f=a.keyPath.slice(0,r.length);return this.where(f).equals(f.map(function(v){return e[v]}))}!a&&Ot&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(r.join("+"),"]"));var s=this.schema.idxByName;function l(g,v){return Q(g,v)===0}var p=r.reduce(function(y,v){var b=y[0],x=y[1],y=s[v],k=e[v];return[b||y,b||!y?ae(x,y&&y.multi?function(w){return w=vt(w,v),h(w)&&w.some(function(S){return l(k,S)})}:function(w){return l(k,vt(w,v))}):x]},[null,null]),f=p[0],p=p[1];return f?this.where(f.name).equals(e[f.keyPath]).filter(p):a?this.filter(p):this.where(r).equals("")},rt.prototype.filter=function(e){return this.toCollection().and(e)},rt.prototype.count=function(e){return this.toCollection().count(e)},rt.prototype.offset=function(e){return this.toCollection().offset(e)},rt.prototype.limit=function(e){return this.toCollection().limit(e)},rt.prototype.each=function(e){return this.toCollection().each(e)},rt.prototype.toArray=function(e){return this.toCollection().toArray(e)},rt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},rt.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,h(e)?"[".concat(e.join("+"),"]"):e))},rt.prototype.reverse=function(){return this.toCollection().reverse()},rt.prototype.mapToClass=function(e){var r,a=this.db,s=this.name;function l(){return r!==null&&r.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Gi&&((function(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function x(){this.constructor=v}o(v,b),v.prototype=b===null?Object.create(b):(x.prototype=b.prototype,new x)})(l,r=e),Object.defineProperty(l.prototype,"db",{get:function(){return a},enumerable:!1,configurable:!0}),l.prototype.table=function(){return s},e=l);for(var f=new Set,p=e.prototype;p;p=T(p))Object.getOwnPropertyNames(p).forEach(function(v){return f.add(v)});function g(v){if(!v)return v;var b,x=Object.create(e.prototype);for(b in v)if(!f.has(b))try{x[b]=v[b]}catch{}return x}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=g,this.hook("reading",g),e},rt.prototype.defineClass=function(){return this.mapToClass(function(e){m(this,e)})},rt.prototype.add=function(e,r){var a=this,s=this.schema.primKey,l=s.auto,f=s.keyPath,p=e;return f&&l&&(p=Sn(f)(e)),this._trans("readwrite",function(g){return a.core.mutate({trans:g,type:"add",keys:r!=null?[r]:null,values:[p]})}).then(function(g){return g.numFailures?K.reject(g.failures[0]):g.lastResult}).then(function(g){if(f)try{pt(e,f,g)}catch{}return g})},rt.prototype.update=function(e,r){return typeof e!="object"||h(e)?this.where(":id").equals(e).modify(r):(e=vt(e,this.schema.primKey.keyPath),e===void 0?ut(new W.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(r))},rt.prototype.put=function(e,r){var a=this,s=this.schema.primKey,l=s.auto,f=s.keyPath,p=e;return f&&l&&(p=Sn(f)(e)),this._trans("readwrite",function(g){return a.core.mutate({trans:g,type:"put",values:[p],keys:r!=null?[r]:null})}).then(function(g){return g.numFailures?K.reject(g.failures[0]):g.lastResult}).then(function(g){if(f)try{pt(e,f,g)}catch{}return g})},rt.prototype.delete=function(e){var r=this;return this._trans("readwrite",function(a){return r.core.mutate({trans:a,type:"delete",keys:[e]})}).then(function(a){return a.numFailures?K.reject(a.failures[0]):void 0})},rt.prototype.clear=function(){var e=this;return this._trans("readwrite",function(r){return e.core.mutate({trans:r,type:"deleteRange",range:Yi})}).then(function(r){return r.numFailures?K.reject(r.failures[0]):void 0})},rt.prototype.bulkGet=function(e){var r=this;return this._trans("readonly",function(a){return r.core.getMany({keys:e,trans:a}).then(function(s){return s.map(function(l){return r.hook.reading.fire(l)})})})},rt.prototype.bulkAdd=function(e,r,a){var s=this,l=Array.isArray(r)?r:void 0,f=(a=a||(l?void 0:r))?a.allKeys:void 0;return this._trans("readwrite",function(p){var b=s.schema.primKey,g=b.auto,b=b.keyPath;if(b&&l)throw new W.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(l&&l.length!==e.length)throw new W.InvalidArgument("Arguments objects and keys must have the same length");var v=e.length,b=b&&g?e.map(Sn(b)):e;return s.core.mutate({trans:p,type:"add",keys:l,values:b,wantResults:f}).then(function(S){var y=S.numFailures,k=S.results,w=S.lastResult,S=S.failures;if(y===0)return f?k:w;throw new be("".concat(s.name,".bulkAdd(): ").concat(y," of ").concat(v," operations failed"),S)})})},rt.prototype.bulkPut=function(e,r,a){var s=this,l=Array.isArray(r)?r:void 0,f=(a=a||(l?void 0:r))?a.allKeys:void 0;return this._trans("readwrite",function(p){var b=s.schema.primKey,g=b.auto,b=b.keyPath;if(b&&l)throw new W.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(l&&l.length!==e.length)throw new W.InvalidArgument("Arguments objects and keys must have the same length");var v=e.length,b=b&&g?e.map(Sn(b)):e;return s.core.mutate({trans:p,type:"put",keys:l,values:b,wantResults:f}).then(function(S){var y=S.numFailures,k=S.results,w=S.lastResult,S=S.failures;if(y===0)return f?k:w;throw new be("".concat(s.name,".bulkPut(): ").concat(y," of ").concat(v," operations failed"),S)})})},rt.prototype.bulkUpdate=function(e){var r=this,a=this.core,s=e.map(function(p){return p.key}),l=e.map(function(p){return p.changes}),f=[];return this._trans("readwrite",function(p){return a.getMany({trans:p,keys:s,cache:"clone"}).then(function(g){var v=[],b=[];e.forEach(function(y,k){var w=y.key,S=y.changes,E=g[k];if(E){for(var _=0,D=Object.keys(S);_<D.length;_++){var A=D[_],P=S[A];if(A===r.schema.primKey.keyPath){if(Q(P,w)!==0)throw new W.Constraint("Cannot update primary key in bulkUpdate()")}else pt(E,A,P)}f.push(k),v.push(w),b.push(E)}});var x=v.length;return a.mutate({trans:p,type:"put",keys:v,values:b,updates:{keys:s,changeSpecs:l}}).then(function(y){var k=y.numFailures,w=y.failures;if(k===0)return x;for(var S=0,E=Object.keys(w);S<E.length;S++){var _,D=E[S],A=f[Number(D)];A!=null&&(_=w[D],delete w[D],w[A]=_)}throw new be("".concat(r.name,".bulkUpdate(): ").concat(k," of ").concat(x," operations failed"),w)})})})},rt.prototype.bulkDelete=function(e){var r=this,a=e.length;return this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"delete",keys:e})}).then(function(p){var l=p.numFailures,f=p.lastResult,p=p.failures;if(l===0)return f;throw new be("".concat(r.name,".bulkDelete(): ").concat(l," of ").concat(a," operations failed"),p)})},rt);function rt(){}function He(e){function r(p,g){if(g){for(var v=arguments.length,b=new Array(v-1);--v;)b[v-1]=arguments[v];return a[p].subscribe.apply(null,b),e}if(typeof p=="string")return a[p]}var a={};r.addEventType=f;for(var s=1,l=arguments.length;s<l;++s)f(arguments[s]);return r;function f(p,g,v){if(typeof p!="object"){var b;g=g||ds;var x={subscribers:[],fire:v=v||nt,subscribe:function(y){x.subscribers.indexOf(y)===-1&&(x.subscribers.push(y),x.fire=g(x.fire,y))},unsubscribe:function(y){x.subscribers=x.subscribers.filter(function(k){return k!==y}),x.fire=x.subscribers.reduce(g,v)}};return a[p]=r[p]=x}d(b=p).forEach(function(y){var k=b[y];if(h(k))f(y,b[y][0],b[y][1]);else{if(k!=="asap")throw new W.InvalidArgument("Invalid event config");var w=f(y,Le,function(){for(var S=arguments.length,E=new Array(S);S--;)E[S]=arguments[S];w.subscribers.forEach(function(_){$t(function(){_.apply(null,E)})})})}})}}function Ue(e,r){return et(r).from({prototype:e}),r}function Ee(e,r){return!(e.filter||e.algorithm||e.or)&&(r?e.justLimit:!e.replayFilter)}function Sr(e,r){e.filter=ae(e.filter,r)}function xr(e,r,a){var s=e.replayFilter;e.replayFilter=s?function(){return ae(s(),r())}:r,e.justLimit=a&&!s}function xn(e,r){if(e.isPrimKey)return r.primaryKey;var a=r.getIndexByKeyPath(e.index);if(!a)throw new W.Schema("KeyPath "+e.index+" on object store "+r.name+" is not indexed");return a}function to(e,r,a){var s=xn(e,r.schema);return r.openCursor({trans:a,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:s,range:e.range}})}function Tn(e,r,a,s){var l=e.replayFilter?ae(e.filter,e.replayFilter()):e.filter;if(e.or){var f={},p=function(g,v,b){var x,y;l&&!l(v,b,function(k){return v.stop(k)},function(k){return v.fail(k)})||((y=""+(x=v.primaryKey))=="[object ArrayBuffer]"&&(y=""+new Uint8Array(x)),C(f,y)||(f[y]=!0,r(g,v,b)))};return Promise.all([e.or._iterate(p,a),eo(to(e,s,a),e.algorithm,p,!e.keysOnly&&e.valueMapper)])}return eo(to(e,s,a),ae(e.algorithm,l),r,!e.keysOnly&&e.valueMapper)}function eo(e,r,a,s){var l=at(s?function(f,p,g){return a(s(f),p,g)}:a);return e.then(function(f){if(f)return f.start(function(){var p=function(){return f.continue()};r&&!r(f,function(g){return p=g},function(g){f.stop(g),p=nt},function(g){f.fail(g),p=nt})||l(f.value,f,function(g){return p=g}),p()})})}var We=(no.prototype.execute=function(e){var r=this["@@propmod"];if(r.add!==void 0){var a=r.add;if(h(a))return u(u([],h(e)?e:[],!0),a).sort();if(typeof a=="number")return(Number(e)||0)+a;if(typeof a=="bigint")try{return BigInt(e)+a}catch{return BigInt(0)+a}throw new TypeError("Invalid term ".concat(a))}if(r.remove!==void 0){var s=r.remove;if(h(s))return h(e)?e.filter(function(l){return!s.includes(l)}).sort():[];if(typeof s=="number")return Number(e)-s;if(typeof s=="bigint")try{return BigInt(e)-s}catch{return BigInt(0)-s}throw new TypeError("Invalid subtrahend ".concat(s))}return a=(a=r.replacePrefix)===null||a===void 0?void 0:a[0],a&&typeof e=="string"&&e.startsWith(a)?r.replacePrefix[1]+e.substring(a.length):e},no);function no(e){this["@@propmod"]=e}var ys=(tt.prototype._read=function(e,r){var a=this._ctx;return a.error?a.table._trans(null,ut.bind(null,a.error)):a.table._trans("readonly",e).then(r)},tt.prototype._write=function(e){var r=this._ctx;return r.error?r.table._trans(null,ut.bind(null,r.error)):r.table._trans("readwrite",e,"locked")},tt.prototype._addAlgorithm=function(e){var r=this._ctx;r.algorithm=ae(r.algorithm,e)},tt.prototype._iterate=function(e,r){return Tn(this._ctx,e,r,this._ctx.table.core)},tt.prototype.clone=function(e){var r=Object.create(this.constructor.prototype),a=Object.create(this._ctx);return e&&m(a,e),r._ctx=a,r},tt.prototype.raw=function(){return this._ctx.valueMapper=null,this},tt.prototype.each=function(e){var r=this._ctx;return this._read(function(a){return Tn(r,e,a,r.table.core)})},tt.prototype.count=function(e){var r=this;return this._read(function(a){var s=r._ctx,l=s.table.core;if(Ee(s,!0))return l.count({trans:a,query:{index:xn(s,l.schema),range:s.range}}).then(function(p){return Math.min(p,s.limit)});var f=0;return Tn(s,function(){return++f,!1},a,l).then(function(){return f})}).then(e)},tt.prototype.sortBy=function(e,r){var a=e.split(".").reverse(),s=a[0],l=a.length-1;function f(v,b){return b?f(v[a[b]],b-1):v[s]}var p=this._ctx.dir==="next"?1:-1;function g(v,b){return Q(f(v,l),f(b,l))*p}return this.toArray(function(v){return v.sort(g)}).then(r)},tt.prototype.toArray=function(e){var r=this;return this._read(function(a){var s=r._ctx;if(s.dir==="next"&&Ee(s,!0)&&0<s.limit){var l=s.valueMapper,f=xn(s,s.table.core.schema);return s.table.core.query({trans:a,limit:s.limit,values:!0,query:{index:f,range:s.range}}).then(function(g){return g=g.result,l?g.map(l):g})}var p=[];return Tn(s,function(g){return p.push(g)},a,s.table.core).then(function(){return p})},e)},tt.prototype.offset=function(e){var r=this._ctx;return e<=0||(r.offset+=e,Ee(r)?xr(r,function(){var a=e;return function(s,l){return a===0||(a===1?--a:l(function(){s.advance(a),a=0}),!1)}}):xr(r,function(){var a=e;return function(){return--a<0}})),this},tt.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),xr(this._ctx,function(){var r=e;return function(a,s,l){return--r<=0&&s(l),0<=r}},!0),this},tt.prototype.until=function(e,r){return Sr(this._ctx,function(a,s,l){return!e(a.value)||(s(l),r)}),this},tt.prototype.first=function(e){return this.limit(1).toArray(function(r){return r[0]}).then(e)},tt.prototype.last=function(e){return this.reverse().first(e)},tt.prototype.filter=function(e){var r;return Sr(this._ctx,function(a){return e(a.value)}),(r=this._ctx).isMatch=ae(r.isMatch,e),this},tt.prototype.and=function(e){return this.filter(e)},tt.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},tt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},tt.prototype.desc=function(){return this.reverse()},tt.prototype.eachKey=function(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(a,s){e(s.key,s)})},tt.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},tt.prototype.eachPrimaryKey=function(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(a,s){e(s.primaryKey,s)})},tt.prototype.keys=function(e){var r=this._ctx;r.keysOnly=!r.isMatch;var a=[];return this.each(function(s,l){a.push(l.key)}).then(function(){return a}).then(e)},tt.prototype.primaryKeys=function(e){var r=this._ctx;if(r.dir==="next"&&Ee(r,!0)&&0<r.limit)return this._read(function(s){var l=xn(r,r.table.core.schema);return r.table.core.query({trans:s,values:!1,limit:r.limit,query:{index:l,range:r.range}})}).then(function(s){return s.result}).then(e);r.keysOnly=!r.isMatch;var a=[];return this.each(function(s,l){a.push(l.primaryKey)}).then(function(){return a}).then(e)},tt.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},tt.prototype.firstKey=function(e){return this.limit(1).keys(function(r){return r[0]}).then(e)},tt.prototype.lastKey=function(e){return this.reverse().firstKey(e)},tt.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var r={};return Sr(this._ctx,function(l){var s=l.primaryKey.toString(),l=C(r,s);return r[s]=!0,!l}),this},tt.prototype.modify=function(e){var r=this,a=this._ctx;return this._write(function(s){var l,f,p;p=typeof e=="function"?e:(l=d(e),f=l.length,function(_){for(var D=!1,A=0;A<f;++A){var P=l[A],I=e[P],M=vt(_,P);I instanceof We?(pt(_,P,I.execute(M)),D=!0):M!==I&&(pt(_,P,I),D=!0)}return D});var g=a.table.core,y=g.schema.primaryKey,v=y.outbound,b=y.extractKey,x=200,y=r.db._options.modifyChunkSize;y&&(x=typeof y=="object"?y[g.name]||y["*"]||200:y);function k(_,P){var A=P.failures,P=P.numFailures;S+=_-P;for(var I=0,M=d(A);I<M.length;I++){var L=M[I];w.push(A[L])}}var w=[],S=0,E=[];return r.clone().primaryKeys().then(function(_){function D(P){var I=Math.min(x,_.length-P);return g.getMany({trans:s,keys:_.slice(P,P+I),cache:"immutable"}).then(function(M){for(var L=[],j=[],R=v?[]:null,N=[],F=0;F<I;++F){var B=M[F],V={value:Xt(B),primKey:_[P+F]};p.call(V,V.value,V)!==!1&&(V.value==null?N.push(_[P+F]):v||Q(b(B),b(V.value))===0?(j.push(V.value),v&&R.push(_[P+F])):(N.push(_[P+F]),L.push(V.value)))}return Promise.resolve(0<L.length&&g.mutate({trans:s,type:"add",values:L}).then(function(G){for(var X in G.failures)N.splice(parseInt(X),1);k(L.length,G)})).then(function(){return(0<j.length||A&&typeof e=="object")&&g.mutate({trans:s,type:"put",keys:R,values:j,criteria:A,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<P}).then(function(G){return k(j.length,G)})}).then(function(){return(0<N.length||A&&e===Tr)&&g.mutate({trans:s,type:"delete",keys:N,criteria:A,isAdditionalChunk:0<P}).then(function(G){return k(N.length,G)})}).then(function(){return _.length>P+I&&D(P+x)})})}var A=Ee(a)&&a.limit===1/0&&(typeof e!="function"||e===Tr)&&{index:a.index,range:a.range};return D(0).then(function(){if(0<w.length)throw new dn("Error modifying one or more objects",w,S,E);return _.length})})})},tt.prototype.delete=function(){var e=this._ctx,r=e.range;return Ee(e)&&(e.isPrimKey||r.type===3)?this._write(function(a){var s=e.table.core.schema.primaryKey,l=r;return e.table.core.count({trans:a,query:{index:s,range:l}}).then(function(f){return e.table.core.mutate({trans:a,type:"deleteRange",range:l}).then(function(p){var g=p.failures;if(p.lastResult,p.results,p=p.numFailures,p)throw new dn("Could not delete some values",Object.keys(g).map(function(v){return g[v]}),f-p);return f-p})})}):this.modify(Tr)},tt);function tt(){}var Tr=function(e,r){return r.value=null};function vs(e,r){return e<r?-1:e===r?0:1}function ws(e,r){return r<e?-1:e===r?0:1}function St(e,r,a){return e=e instanceof io?new e.Collection(e):e,e._ctx.error=new(a||TypeError)(r),e}function ke(e){return new e.Collection(e,function(){return ro("")}).limit(0)}function En(e,r,a,s){var l,f,p,g,v,b,x,y=a.length;if(!a.every(function(S){return typeof S=="string"}))return St(e,Vi);function k(S){l=S==="next"?function(_){return _.toUpperCase()}:function(_){return _.toLowerCase()},f=S==="next"?function(_){return _.toLowerCase()}:function(_){return _.toUpperCase()},p=S==="next"?vs:ws;var E=a.map(function(_){return{lower:f(_),upper:l(_)}}).sort(function(_,D){return p(_.lower,D.lower)});g=E.map(function(_){return _.upper}),v=E.map(function(_){return _.lower}),x=(b=S)==="next"?"":s}k("next"),e=new e.Collection(e,function(){return Ut(g[0],v[y-1]+s)}),e._ondirectionchange=function(S){k(S)};var w=0;return e._addAlgorithm(function(S,E,_){var D=S.key;if(typeof D!="string")return!1;var A=f(D);if(r(A,v,w))return!0;for(var P=null,I=w;I<y;++I){var M=(function(L,j,R,N,F,B){for(var V=Math.min(L.length,N.length),G=-1,X=0;X<V;++X){var xt=j[X];if(xt!==N[X])return F(L[X],R[X])<0?L.substr(0,X)+R[X]+R.substr(X+1):F(L[X],N[X])<0?L.substr(0,X)+N[X]+R.substr(X+1):0<=G?L.substr(0,G)+j[G]+R.substr(G+1):null;F(L[X],xt)<0&&(G=X)}return V<N.length&&B==="next"?L+R.substr(L.length):V<L.length&&B==="prev"?L.substr(0,R.length):G<0?null:L.substr(0,G)+N[G]+R.substr(G+1)})(D,A,g[I],v[I],p,b);M===null&&P===null?w=I+1:(P===null||0<p(P,M))&&(P=M)}return E(P!==null?function(){S.continue(P+x)}:_),!1}),e}function Ut(e,r,a,s){return{type:2,lower:e,upper:r,lowerOpen:a,upperOpen:s}}function ro(e){return{type:1,lower:e,upper:e}}var io=(Object.defineProperty(ht.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ht.prototype.between=function(e,r,a,s){a=a!==!1,s=s===!0;try{return 0<this._cmp(e,r)||this._cmp(e,r)===0&&(a||s)&&(!a||!s)?ke(this):new this.Collection(this,function(){return Ut(e,r,!a,!s)})}catch{return St(this,jt)}},ht.prototype.equals=function(e){return e==null?St(this,jt):new this.Collection(this,function(){return ro(e)})},ht.prototype.above=function(e){return e==null?St(this,jt):new this.Collection(this,function(){return Ut(e,void 0,!0)})},ht.prototype.aboveOrEqual=function(e){return e==null?St(this,jt):new this.Collection(this,function(){return Ut(e,void 0,!1)})},ht.prototype.below=function(e){return e==null?St(this,jt):new this.Collection(this,function(){return Ut(void 0,e,!1,!0)})},ht.prototype.belowOrEqual=function(e){return e==null?St(this,jt):new this.Collection(this,function(){return Ut(void 0,e)})},ht.prototype.startsWith=function(e){return typeof e!="string"?St(this,Vi):this.between(e,e+oe,!0,!0)},ht.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):En(this,function(r,a){return r.indexOf(a[0])===0},[e],oe)},ht.prototype.equalsIgnoreCase=function(e){return En(this,function(r,a){return r===a[0]},[e],"")},ht.prototype.anyOfIgnoreCase=function(){var e=Mt.apply(ve,arguments);return e.length===0?ke(this):En(this,function(r,a){return a.indexOf(r)!==-1},e,"")},ht.prototype.startsWithAnyOfIgnoreCase=function(){var e=Mt.apply(ve,arguments);return e.length===0?ke(this):En(this,function(r,a){return a.some(function(s){return r.indexOf(s)===0})},e,oe)},ht.prototype.anyOf=function(){var e=this,r=Mt.apply(ve,arguments),a=this._cmp;try{r.sort(a)}catch{return St(this,jt)}if(r.length===0)return ke(this);var s=new this.Collection(this,function(){return Ut(r[0],r[r.length-1])});s._ondirectionchange=function(f){a=f==="next"?e._ascending:e._descending,r.sort(a)};var l=0;return s._addAlgorithm(function(f,p,g){for(var v=f.key;0<a(v,r[l]);)if(++l===r.length)return p(g),!1;return a(v,r[l])===0||(p(function(){f.continue(r[l])}),!1)}),s},ht.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ht.prototype.noneOf=function(){var e=Mt.apply(ve,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return St(this,jt)}var r=e.reduce(function(a,s){return a?a.concat([[a[a.length-1][1],s]]):[[-1/0,s]]},null);return r.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},ht.prototype.inAnyRange=function(D,r){var a=this,s=this._cmp,l=this._ascending,f=this._descending,p=this._min,g=this._max;if(D.length===0)return ke(this);if(!D.every(function(A){return A[0]!==void 0&&A[1]!==void 0&&l(A[0],A[1])<=0}))return St(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",W.InvalidArgument);var v=!r||r.includeLowers!==!1,b=r&&r.includeUppers===!0,x,y=l;function k(A,P){return y(A[0],P[0])}try{(x=D.reduce(function(A,P){for(var I=0,M=A.length;I<M;++I){var L=A[I];if(s(P[0],L[1])<0&&0<s(P[1],L[0])){L[0]=p(L[0],P[0]),L[1]=g(L[1],P[1]);break}}return I===M&&A.push(P),A},[])).sort(k)}catch{return St(this,jt)}var w=0,S=b?function(A){return 0<l(A,x[w][1])}:function(A){return 0<=l(A,x[w][1])},E=v?function(A){return 0<f(A,x[w][0])}:function(A){return 0<=f(A,x[w][0])},_=S,D=new this.Collection(this,function(){return Ut(x[0][0],x[x.length-1][1],!v,!b)});return D._ondirectionchange=function(A){y=A==="next"?(_=S,l):(_=E,f),x.sort(k)},D._addAlgorithm(function(A,P,I){for(var M,L=A.key;_(L);)if(++w===x.length)return P(I),!1;return!S(M=L)&&!E(M)||(a._cmp(L,x[w][1])===0||a._cmp(L,x[w][0])===0||P(function(){y===l?A.continue(x[w][0]):A.continue(x[w][1])}),!1)}),D},ht.prototype.startsWithAnyOf=function(){var e=Mt.apply(ve,arguments);return e.every(function(r){return typeof r=="string"})?e.length===0?ke(this):this.inAnyRange(e.map(function(r){return[r,r+oe]})):St(this,"startsWithAnyOf() only works with strings")},ht);function ht(){}function Pt(e){return at(function(r){return ze(r),e(r.target.error),!1})}function ze(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Je="storagemutated",Er="x-storagemutated-1",Wt=He(null,Je),bs=(Ct.prototype._lock=function(){return lt(!U.global),++this._reculock,this._reculock!==1||U.global||(U.lockOwnerFor=this),this},Ct.prototype._unlock=function(){if(lt(!U.global),--this._reculock==0)for(U.global||(U.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{ie(e[1],e[0])}catch{}}return this},Ct.prototype._locked=function(){return this._reculock&&U.lockOwnerFor!==this},Ct.prototype.create=function(e){var r=this;if(!this.mode)return this;var a=this.db.idbdb,s=this.db._state.dbOpenError;if(lt(!this.idbtrans),!e&&!a)switch(s&&s.name){case"DatabaseClosedError":throw new W.DatabaseClosed(s);case"MissingAPIError":throw new W.MissingAPI(s.message,s);default:throw new W.OpenFailed(s)}if(!this.active)throw new W.TransactionInactive;return lt(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||a).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=at(function(l){ze(l),r._reject(e.error)}),e.onabort=at(function(l){ze(l),r.active&&r._reject(new W.Abort(e.error)),r.active=!1,r.on("abort").fire(l)}),e.oncomplete=at(function(){r.active=!1,r._resolve(),"mutatedParts"in e&&Wt.storagemutated.fire(e.mutatedParts)}),this},Ct.prototype._promise=function(e,r,a){var s=this;if(e==="readwrite"&&this.mode!=="readwrite")return ut(new W.ReadOnly("Transaction is readonly"));if(!this.active)return ut(new W.TransactionInactive);if(this._locked())return new K(function(f,p){s._blockedFuncs.push([function(){s._promise(e,r,a).then(f,p)},U])});if(a)return Bt(function(){var f=new K(function(p,g){s._lock();var v=r(p,g,s);v&&v.then&&v.then(p,g)});return f.finally(function(){return s._unlock()}),f._lib=!0,f});var l=new K(function(f,p){var g=r(f,p,s);g&&g.then&&g.then(f,p)});return l._lib=!0,l},Ct.prototype._root=function(){return this.parent?this.parent._root():this},Ct.prototype.waitFor=function(e){var r,a=this._root(),s=K.resolve(e);a._waitingFor?a._waitingFor=a._waitingFor.then(function(){return s}):(a._waitingFor=s,a._waitingQueue=[],r=a.idbtrans.objectStore(a.storeNames[0]),(function f(){for(++a._spinCount;a._waitingQueue.length;)a._waitingQueue.shift()();a._waitingFor&&(r.get(-1/0).onsuccess=f)})());var l=a._waitingFor;return new K(function(f,p){s.then(function(g){return a._waitingQueue.push(at(f.bind(null,g)))},function(g){return a._waitingQueue.push(at(p.bind(null,g)))}).finally(function(){a._waitingFor===l&&(a._waitingFor=null)})})},Ct.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new W.Abort))},Ct.prototype.table=function(e){var r=this._memoizedTables||(this._memoizedTables={});if(C(r,e))return r[e];var a=this.schema[e];if(!a)throw new W.NotFound("Table "+e+" not part of transaction");return a=new this.db.Table(e,a,this),a.core=this.db.core.table(e),r[e]=a},Ct);function Ct(){}function kr(e,r,a,s,l,f,p){return{name:e,keyPath:r,unique:a,multi:s,auto:l,compound:f,src:(a&&!p?"&":"")+(s?"*":"")+(l?"++":"")+oo(r)}}function oo(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Dr(e,r,a){return{name:e,primKey:r,indexes:a,mappedClass:null,idxByName:(s=function(l){return[l.name,l]},a.reduce(function(l,f,p){return p=s(f,p),p&&(l[p[0]]=p[1]),l},{}))};var s}var Ve=function(e){try{return e.only([[]]),Ve=function(){return[[]]},[[]]}catch{return Ve=function(){return oe},oe}};function Ar(e){return e==null?function(){}:typeof e=="string"?(r=e).split(".").length===1?function(a){return a[r]}:function(a){return vt(a,r)}:function(a){return vt(a,e)};var r}function ao(e){return[].slice.call(e)}var _s=0;function Ye(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Ss(e,r,v){function s(_){if(_.type===3)return null;if(_.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var w=_.lower,S=_.upper,E=_.lowerOpen,_=_.upperOpen;return w===void 0?S===void 0?null:r.upperBound(S,!!_):S===void 0?r.lowerBound(w,!!E):r.bound(w,S,!!E,!!_)}function l(k){var w,S=k.name;return{name:S,schema:k,mutate:function(E){var _=E.trans,D=E.type,A=E.keys,P=E.values,I=E.range;return new Promise(function(M,L){M=at(M);var j=_.objectStore(S),R=j.keyPath==null,N=D==="put"||D==="add";if(!N&&D!=="delete"&&D!=="deleteRange")throw new Error("Invalid operation type: "+D);var F,B=(A||P||{length:1}).length;if(A&&P&&A.length!==P.length)throw new Error("Given keys array must have same length as given values array.");if(B===0)return M({numFailures:0,failures:{},results:[],lastResult:void 0});function V(wt){++xt,ze(wt)}var G=[],X=[],xt=0;if(D==="deleteRange"){if(I.type===4)return M({numFailures:xt,failures:X,results:[],lastResult:void 0});I.type===3?G.push(F=j.clear()):G.push(F=j.delete(s(I)))}else{var R=N?R?[P,A]:[P,null]:[A,null],J=R[0],mt=R[1];if(N)for(var yt=0;yt<B;++yt)G.push(F=mt&&mt[yt]!==void 0?j[D](J[yt],mt[yt]):j[D](J[yt])),F.onerror=V;else for(yt=0;yt<B;++yt)G.push(F=j[D](J[yt])),F.onerror=V}function Ln(wt){wt=wt.target.result,G.forEach(function(ce,zr){return ce.error!=null&&(X[zr]=ce.error)}),M({numFailures:xt,failures:X,results:D==="delete"?A:G.map(function(ce){return ce.result}),lastResult:wt})}F.onerror=function(wt){V(wt),Ln(wt)},F.onsuccess=Ln})},getMany:function(E){var _=E.trans,D=E.keys;return new Promise(function(A,P){A=at(A);for(var I,M=_.objectStore(S),L=D.length,j=new Array(L),R=0,N=0,F=function(G){G=G.target,j[G._pos]=G.result,++N===R&&A(j)},B=Pt(P),V=0;V<L;++V)D[V]!=null&&((I=M.get(D[V]))._pos=V,I.onsuccess=F,I.onerror=B,++R);R===0&&A(j)})},get:function(E){var _=E.trans,D=E.key;return new Promise(function(A,P){A=at(A);var I=_.objectStore(S).get(D);I.onsuccess=function(M){return A(M.target.result)},I.onerror=Pt(P)})},query:(w=b,function(E){return new Promise(function(_,D){_=at(_);var A,P,I,R=E.trans,M=E.values,L=E.limit,F=E.query,j=L===1/0?void 0:L,N=F.index,F=F.range,R=R.objectStore(S),N=N.isPrimaryKey?R:R.index(N.name),F=s(F);if(L===0)return _({result:[]});w?((j=M?N.getAll(F,j):N.getAllKeys(F,j)).onsuccess=function(B){return _({result:B.target.result})},j.onerror=Pt(D)):(A=0,P=!M&&"openKeyCursor"in N?N.openKeyCursor(F):N.openCursor(F),I=[],P.onsuccess=function(B){var V=P.result;return V?(I.push(M?V.value:V.primaryKey),++A===L?_({result:I}):void V.continue()):_({result:I})},P.onerror=Pt(D))})}),openCursor:function(E){var _=E.trans,D=E.values,A=E.query,P=E.reverse,I=E.unique;return new Promise(function(M,L){M=at(M);var N=A.index,j=A.range,R=_.objectStore(S),R=N.isPrimaryKey?R:R.index(N.name),N=P?I?"prevunique":"prev":I?"nextunique":"next",F=!D&&"openKeyCursor"in R?R.openKeyCursor(s(j),N):R.openCursor(s(j),N);F.onerror=Pt(L),F.onsuccess=at(function(B){var V,G,X,xt,J=F.result;J?(J.___id=++_s,J.done=!1,V=J.continue.bind(J),G=(G=J.continuePrimaryKey)&&G.bind(J),X=J.advance.bind(J),xt=function(){throw new Error("Cursor not stopped")},J.trans=_,J.stop=J.continue=J.continuePrimaryKey=J.advance=function(){throw new Error("Cursor not started")},J.fail=at(L),J.next=function(){var mt=this,yt=1;return this.start(function(){return yt--?mt.continue():mt.stop()}).then(function(){return mt})},J.start=function(mt){function yt(){if(F.result)try{mt()}catch(wt){J.fail(wt)}else J.done=!0,J.start=function(){throw new Error("Cursor behind last entry")},J.stop()}var Ln=new Promise(function(wt,ce){wt=at(wt),F.onerror=Pt(ce),J.fail=ce,J.stop=function(zr){J.stop=J.continue=J.continuePrimaryKey=J.advance=xt,wt(zr)}});return F.onsuccess=at(function(wt){F.onsuccess=yt,yt()}),J.continue=V,J.continuePrimaryKey=G,J.advance=X,yt(),Ln},M(J)):M(null)},L)})},count:function(E){var _=E.query,D=E.trans,A=_.index,P=_.range;return new Promise(function(I,M){var L=D.objectStore(S),j=A.isPrimaryKey?L:L.index(A.name),L=s(P),j=L?j.count(L):j.count();j.onsuccess=at(function(R){return I(R.target.result)}),j.onerror=Pt(M)})}}}var f,p,g,x=(p=v,g=ao((f=e).objectStoreNames),{schema:{name:f.name,tables:g.map(function(k){return p.objectStore(k)}).map(function(k){var w=k.keyPath,_=k.autoIncrement,S=h(w),E={},_={name:k.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:w==null,compound:S,keyPath:w,autoIncrement:_,unique:!0,extractKey:Ar(w)},indexes:ao(k.indexNames).map(function(D){return k.index(D)}).map(function(I){var A=I.name,P=I.unique,M=I.multiEntry,I=I.keyPath,M={name:A,compound:h(I),keyPath:I,unique:P,multiEntry:M,extractKey:Ar(I)};return E[Ye(I)]=M}),getIndexByKeyPath:function(D){return E[Ye(D)]}};return E[":id"]=_.primaryKey,w!=null&&(E[Ye(w)]=_.primaryKey),_})},hasGetAll:0<g.length&&"getAll"in p.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),v=x.schema,b=x.hasGetAll,x=v.tables.map(l),y={};return x.forEach(function(k){return y[k.name]=k}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(k){if(!y[k])throw new Error("Table '".concat(k,"' not found"));return y[k]},MIN_KEY:-1/0,MAX_KEY:Ve(r),schema:v}}function xs(e,r,a,s){var l=a.IDBKeyRange;return a.indexedDB,{dbcore:(s=Ss(r,l,s),e.dbcore.reduce(function(f,p){return p=p.create,i(i({},f),p(f))},s))}}function kn(e,s){var a=s.db,s=xs(e._middlewares,a,e._deps,s);e.core=s.dbcore,e.tables.forEach(function(l){var f=l.name;e.core.schema.tables.some(function(p){return p.name===f})&&(l.core=e.core.table(f),e[f]instanceof e.Table&&(e[f].core=l.core))})}function Dn(e,r,a,s){a.forEach(function(l){var f=s[l];r.forEach(function(p){var g=(function v(b,x){return H(b,x)||(b=T(b))&&v(b,x)})(p,l);(!g||"value"in g&&g.value===void 0)&&(p===e.Transaction.prototype||p instanceof e.Transaction?z(p,l,{get:function(){return this.table(l)},set:function(v){q(this,l,{value:v,writable:!0,configurable:!0,enumerable:!0})}}):p[l]=new e.Table(l,f))})})}function Or(e,r){r.forEach(function(a){for(var s in a)a[s]instanceof e.Table&&delete a[s]})}function Ts(e,r){return e._cfg.version-r._cfg.version}function Es(e,r,a,s){var l=e._dbSchema;a.objectStoreNames.contains("$meta")&&!l.$meta&&(l.$meta=Dr("$meta",uo("")[0],[]),e._storeNames.push("$meta"));var f=e._createTransaction("readwrite",e._storeNames,l);f.create(a),f._completion.catch(s);var p=f._reject.bind(f),g=U.transless||U;Bt(function(){return U.trans=f,U.transless=g,r!==0?(kn(e,a),b=r,((v=f).storeNames.includes("$meta")?v.table("$meta").get("version").then(function(x){return x??b}):K.resolve(b)).then(function(x){return k=x,w=f,S=a,E=[],x=(y=e)._versions,_=y._dbSchema=On(0,y.idbdb,S),(x=x.filter(function(D){return D._cfg.version>=k})).length!==0?(x.forEach(function(D){E.push(function(){var A=_,P=D._cfg.dbschema;Pn(y,A,S),Pn(y,P,S),_=y._dbSchema=P;var I=Pr(A,P);I.add.forEach(function(N){Cr(S,N[0],N[1].primKey,N[1].indexes)}),I.change.forEach(function(N){if(N.recreate)throw new W.Upgrade("Not yet support for changing primary key");var F=S.objectStore(N.name);N.add.forEach(function(B){return An(F,B)}),N.change.forEach(function(B){F.deleteIndex(B.name),An(F,B)}),N.del.forEach(function(B){return F.deleteIndex(B)})});var M=D._cfg.contentUpgrade;if(M&&D._cfg.version>k){kn(y,S),w._memoizedTables={};var L=cn(P);I.del.forEach(function(N){L[N]=A[N]}),Or(y,[y.Transaction.prototype]),Dn(y,[y.Transaction.prototype],d(L),L),w.schema=L;var j,R=cr(M);return R&&xe(),I=K.follow(function(){var N;(j=M(w))&&R&&(N=qt.bind(null,null),j.then(N,N))}),j&&typeof j.then=="function"?K.resolve(j):I.then(function(){return j})}}),E.push(function(A){var P,I,M=D._cfg.dbschema;P=M,I=A,[].slice.call(I.db.objectStoreNames).forEach(function(L){return P[L]==null&&I.db.deleteObjectStore(L)}),Or(y,[y.Transaction.prototype]),Dn(y,[y.Transaction.prototype],y._storeNames,y._dbSchema),w.schema=y._dbSchema}),E.push(function(A){y.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(y.idbdb.version/10)===D._cfg.version?(y.idbdb.deleteObjectStore("$meta"),delete y._dbSchema.$meta,y._storeNames=y._storeNames.filter(function(P){return P!=="$meta"})):A.objectStore("$meta").put(D._cfg.version,"version"))})}),(function D(){return E.length?K.resolve(E.shift()(w.idbtrans)).then(D):K.resolve()})().then(function(){so(_,S)})):K.resolve();var y,k,w,S,E,_}).catch(p)):(d(l).forEach(function(x){Cr(a,x,l[x].primKey,l[x].indexes)}),kn(e,a),void K.follow(function(){return e.on.populate.fire(f)}).catch(p));var v,b})}function ks(e,r){so(e._dbSchema,r),r.db.version%10!=0||r.objectStoreNames.contains("$meta")||r.db.createObjectStore("$meta").add(Math.ceil(r.db.version/10-1),"version");var a=On(0,e.idbdb,r);Pn(e,e._dbSchema,r);for(var s=0,l=Pr(a,e._dbSchema).change;s<l.length;s++){var f=(function(p){if(p.change.length||p.recreate)return console.warn("Unable to patch indexes of table ".concat(p.name," because it has changes on the type of index or primary key.")),{value:void 0};var g=r.objectStore(p.name);p.add.forEach(function(v){Ot&&console.debug("Dexie upgrade patch: Creating missing index ".concat(p.name,".").concat(v.src)),An(g,v)})})(l[s]);if(typeof f=="object")return f.value}}function Pr(e,r){var a,s={del:[],add:[],change:[]};for(a in e)r[a]||s.del.push(a);for(a in r){var l=e[a],f=r[a];if(l){var p={name:a,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(l.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||l.primKey.auto!==f.primKey.auto)p.recreate=!0,s.change.push(p);else{var g=l.idxByName,v=f.idxByName,b=void 0;for(b in g)v[b]||p.del.push(b);for(b in v){var x=g[b],y=v[b];x?x.src!==y.src&&p.change.push(y):p.add.push(y)}(0<p.del.length||0<p.add.length||0<p.change.length)&&s.change.push(p)}}else s.add.push([a,f])}return s}function Cr(e,r,a,s){var l=e.db.createObjectStore(r,a.keyPath?{keyPath:a.keyPath,autoIncrement:a.auto}:{autoIncrement:a.auto});return s.forEach(function(f){return An(l,f)}),l}function so(e,r){d(e).forEach(function(a){r.db.objectStoreNames.contains(a)||(Ot&&console.debug("Dexie: Creating missing table",a),Cr(r,a,e[a].primKey,e[a].indexes))})}function An(e,r){e.createIndex(r.name,r.keyPath,{unique:r.unique,multiEntry:r.multi})}function On(e,r,a){var s={};return Z(r.objectStoreNames,0).forEach(function(l){for(var f=a.objectStore(l),p=kr(oo(b=f.keyPath),b||"",!0,!1,!!f.autoIncrement,b&&typeof b!="string",!0),g=[],v=0;v<f.indexNames.length;++v){var x=f.index(f.indexNames[v]),b=x.keyPath,x=kr(x.name,b,!!x.unique,!!x.multiEntry,!1,b&&typeof b!="string",!1);g.push(x)}s[l]=Dr(l,p,g)}),s}function Pn(e,r,a){for(var s=a.db.objectStoreNames,l=0;l<s.length;++l){var f=s[l],p=a.objectStore(f);e._hasGetAll="getAll"in p;for(var g=0;g<p.indexNames.length;++g){var v=p.indexNames[g],b=p.index(v).keyPath,x=typeof b=="string"?b:"["+Z(b).join("+")+"]";!r[f]||(b=r[f].idxByName[x])&&(b.name=v,delete r[f].idxByName[x],r[f].idxByName[v]=b)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&c.WorkerGlobalScope&&c instanceof c.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function uo(e){return e.split(",").map(function(r,a){var s=(r=r.trim()).replace(/([&*]|\+\+)/g,""),l=/^\[/.test(s)?s.match(/^\[(.*)\]$/)[1].split("+"):s;return kr(s,l||null,/\&/.test(r),/\*/.test(r),/\+\+/.test(r),h(l),a===0)})}var Ds=(Cn.prototype._parseStoresSpec=function(e,r){d(e).forEach(function(a){if(e[a]!==null){var s=uo(e[a]),l=s.shift();if(l.unique=!0,l.multi)throw new W.Schema("Primary key cannot be multi-valued");s.forEach(function(f){if(f.auto)throw new W.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new W.Schema("Index must have a name and cannot be an empty string")}),r[a]=Dr(a,l,s)}})},Cn.prototype.stores=function(a){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,a):a;var a=r._versions,s={},l={};return a.forEach(function(f){m(s,f._cfg.storesSource),l=f._cfg.dbschema={},f._parseStoresSpec(s,l)}),r._dbSchema=l,Or(r,[r._allTables,r,r.Transaction.prototype]),Dn(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],d(l),l),r._storeNames=d(l),this},Cn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=dr(this._cfg.contentUpgrade||nt,e),this},Cn);function Cn(){}function Ir(e,r){var a=e._dbNamesDB;return a||(a=e._dbNamesDB=new Rt(_n,{addons:[],indexedDB:e,IDBKeyRange:r})).version(1).stores({dbnames:"name"}),a.table("dbnames")}function $r(e){return e&&typeof e.databases=="function"}function Mr(e){return Bt(function(){return U.letThrough=!0,e()})}function jr(e){return!("from"in e)}var gt=function(e,r){if(!this){var a=new gt;return e&&"d"in e&&m(a,e),a}m(this,arguments.length?{d:1,from:e,to:1<arguments.length?r:e}:{d:0})};function Ge(e,r,a){var s=Q(r,a);if(!isNaN(s)){if(0<s)throw RangeError();if(jr(e))return m(e,{from:r,to:a,d:1});var l=e.l,s=e.r;if(Q(a,e.from)<0)return l?Ge(l,r,a):e.l={from:r,to:a,d:1,l:null,r:null},lo(e);if(0<Q(r,e.to))return s?Ge(s,r,a):e.r={from:r,to:a,d:1,l:null,r:null},lo(e);Q(r,e.from)<0&&(e.from=r,e.l=null,e.d=s?s.d+1:1),0<Q(a,e.to)&&(e.to=a,e.r=null,e.d=e.l?e.l.d+1:1),a=!e.r,l&&!e.l&&Xe(e,l),s&&a&&Xe(e,s)}}function Xe(e,r){jr(r)||(function a(s,v){var f=v.from,p=v.to,g=v.l,v=v.r;Ge(s,f,p),g&&a(s,g),v&&a(s,v)})(e,r)}function co(e,r){var a=In(r),s=a.next();if(s.done)return!1;for(var l=s.value,f=In(e),p=f.next(l.from),g=p.value;!s.done&&!p.done;){if(Q(g.from,l.to)<=0&&0<=Q(g.to,l.from))return!0;Q(l.from,g.from)<0?l=(s=a.next(g.from)).value:g=(p=f.next(l.from)).value}return!1}function In(e){var r=jr(e)?null:{s:0,n:e};return{next:function(a){for(var s=0<arguments.length;r;)switch(r.s){case 0:if(r.s=1,s)for(;r.n.l&&Q(a,r.n.from)<0;)r={up:r,n:r.n.l,s:1};else for(;r.n.l;)r={up:r,n:r.n.l,s:1};case 1:if(r.s=2,!s||Q(a,r.n.to)<=0)return{value:r.n,done:!1};case 2:if(r.n.r){r.s=3,r={up:r,n:r.n.r,s:0};continue}case 3:r=r.up}return{done:!0}}}}function lo(e){var r,a,s=(((r=e.r)===null||r===void 0?void 0:r.d)||0)-(((a=e.l)===null||a===void 0?void 0:a.d)||0),l=1<s?"r":s<-1?"l":"";l&&(r=l=="r"?"l":"r",a=i({},e),s=e[l],e.from=s.from,e.to=s.to,e[l]=s[l],a[l]=s[r],(e[r]=a).d=fo(a)),e.d=fo(e)}function fo(a){var r=a.r,a=a.l;return(r?a?Math.max(r.d,a.d):r.d:a?a.d:0)+1}function $n(e,r){return d(r).forEach(function(a){e[a]?Xe(e[a],r[a]):e[a]=(function s(l){var f,p,g={};for(f in l)C(l,f)&&(p=l[f],g[f]=!p||typeof p!="object"||Ni.has(p.constructor)?p:s(p));return g})(r[a])}),e}function Rr(e,r){return e.all||r.all||Object.keys(e).some(function(a){return r[a]&&co(r[a],e[a])})}$(gt.prototype,((Tt={add:function(e){return Xe(this,e),this},addKey:function(e){return Ge(this,e,e),this},addKeys:function(e){var r=this;return e.forEach(function(a){return Ge(r,a,a)}),this},hasKey:function(e){var r=In(this).next(e).value;return r&&Q(r.from,e)<=0&&0<=Q(r.to,e)}})[ur]=function(){return In(this)},Tt));var se={},Fr={},Lr=!1;function Mn(e){$n(Fr,e),Lr||(Lr=!0,setTimeout(function(){Lr=!1,Nr(Fr,!(Fr={}))},0))}function Nr(e,r){r===void 0&&(r=!1);var a=new Set;if(e.all)for(var s=0,l=Object.values(se);s<l.length;s++)ho(p=l[s],e,a,r);else for(var f in e){var p,g=/^idb\:\/\/(.*)\/(.*)\//.exec(f);g&&(f=g[1],g=g[2],(p=se["idb://".concat(f,"/").concat(g)])&&ho(p,e,a,r))}a.forEach(function(v){return v()})}function ho(e,r,a,s){for(var l=[],f=0,p=Object.entries(e.queries.query);f<p.length;f++){for(var g=p[f],v=g[0],b=[],x=0,y=g[1];x<y.length;x++){var k=y[x];Rr(r,k.obsSet)?k.subscribers.forEach(function(_){return a.add(_)}):s&&b.push(k)}s&&l.push([v,b])}if(s)for(var w=0,S=l;w<S.length;w++){var E=S[w],v=E[0],b=E[1];e.queries.query[v]=b}}function As(e){var r=e._state,a=e._deps.indexedDB;if(r.isBeingOpened||e.idbdb)return r.dbReadyPromise.then(function(){return r.dbOpenError?ut(r.dbOpenError):e});r.isBeingOpened=!0,r.dbOpenError=null,r.openComplete=!1;var s=r.openCanceller,l=Math.round(10*e.verno),f=!1;function p(){if(r.openCanceller!==s)throw new W.DatabaseClosed("db.open() was cancelled")}function g(){return new K(function(k,w){if(p(),!a)throw new W.MissingAPI;var S=e.name,E=r.autoSchema||!l?a.open(S):a.open(S,l);if(!E)throw new W.MissingAPI;E.onerror=Pt(w),E.onblocked=at(e._fireOnBlocked),E.onupgradeneeded=at(function(_){var D;x=E.transaction,r.autoSchema&&!e._options.allowEmptyDB?(E.onerror=ze,x.abort(),E.result.close(),(D=a.deleteDatabase(S)).onsuccess=D.onerror=at(function(){w(new W.NoSuchDatabase("Database ".concat(S," doesnt exist")))})):(x.onerror=Pt(w),_=_.oldVersion>Math.pow(2,62)?0:_.oldVersion,y=_<1,e.idbdb=E.result,f&&ks(e,x),Es(e,_/10,x,w))},w),E.onsuccess=at(function(){x=null;var _,D,A,P,I,M=e.idbdb=E.result,L=Z(M.objectStoreNames);if(0<L.length)try{var j=M.transaction((P=L).length===1?P[0]:P,"readonly");if(r.autoSchema)D=M,A=j,(_=e).verno=D.version/10,A=_._dbSchema=On(0,D,A),_._storeNames=Z(D.objectStoreNames,0),Dn(_,[_._allTables],d(A),A);else if(Pn(e,e._dbSchema,j),((I=Pr(On(0,(I=e).idbdb,j),I._dbSchema)).add.length||I.change.some(function(R){return R.add.length||R.change.length}))&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),M.close(),l=M.version+1,f=!0,k(g());kn(e,j)}catch{}Te.push(e),M.onversionchange=at(function(R){r.vcFired=!0,e.on("versionchange").fire(R)}),M.onclose=at(function(R){e.on("close").fire(R)}),y&&(I=e._deps,j=S,M=I.indexedDB,I=I.IDBKeyRange,$r(M)||j===_n||Ir(M,I).put({name:j}).catch(nt)),k()},w)}).catch(function(k){switch(k?.name){case"UnknownError":if(0<r.PR1398_maxLoop)return r.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),g();break;case"VersionError":if(0<l)return l=0,g()}return K.reject(k)})}var v,b=r.dbReadyResolve,x=null,y=!1;return K.race([s,(typeof navigator>"u"?K.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(k){function w(){return indexedDB.databases().finally(k)}v=setInterval(w,100),w()}).finally(function(){return clearInterval(v)}):Promise.resolve()).then(g)]).then(function(){return p(),r.onReadyBeingFired=[],K.resolve(Mr(function(){return e.on.ready.fire(e.vip)})).then(function k(){if(0<r.onReadyBeingFired.length){var w=r.onReadyBeingFired.reduce(dr,nt);return r.onReadyBeingFired=[],K.resolve(Mr(function(){return w(e.vip)})).then(k)}})}).finally(function(){r.openCanceller===s&&(r.onReadyBeingFired=null,r.isBeingOpened=!1)}).catch(function(k){r.dbOpenError=k;try{x&&x.abort()}catch{}return s===r.openCanceller&&e._close(),ut(k)}).finally(function(){r.openComplete=!0,b()}).then(function(){var k;return y&&(k={},e.tables.forEach(function(w){w.schema.indexes.forEach(function(S){S.name&&(k["idb://".concat(e.name,"/").concat(w.name,"/").concat(S.name)]=new gt(-1/0,[[[]]]))}),k["idb://".concat(e.name,"/").concat(w.name,"/")]=k["idb://".concat(e.name,"/").concat(w.name,"/:dels")]=new gt(-1/0,[[[]]])}),Wt(Je).fire(k),Nr(k,!0)),e})}function Kr(e){function r(f){return e.next(f)}var a=l(r),s=l(function(f){return e.throw(f)});function l(f){return function(v){var g=f(v),v=g.value;return g.done?v:v&&typeof v.then=="function"?v.then(a,s):h(v)?Promise.all(v).then(a,s):a(v)}}return l(r)()}function jn(e,r,a){for(var s=h(e)?e.slice():[e],l=0;l<a;++l)s.push(r);return s}var Os={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return i(i({},e),{table:function(r){var a=e.table(r),s=a.schema,l={},f=[];function p(y,k,w){var S=Ye(y),E=l[S]=l[S]||[],_=y==null?0:typeof y=="string"?1:y.length,D=0<k,D=i(i({},w),{name:D?"".concat(S,"(virtual-from:").concat(w.name,")"):w.name,lowLevelIndex:w,isVirtual:D,keyTail:k,keyLength:_,extractKey:Ar(y),unique:!D&&w.unique});return E.push(D),D.isPrimaryKey||f.push(D),1<_&&p(_===2?y[0]:y.slice(0,_-1),k+1,w),E.sort(function(A,P){return A.keyTail-P.keyTail}),D}r=p(s.primaryKey.keyPath,0,s.primaryKey),l[":id"]=[r];for(var g=0,v=s.indexes;g<v.length;g++){var b=v[g];p(b.keyPath,0,b)}function x(y){var k,w=y.query.index;return w.isVirtual?i(i({},y),{query:{index:w.lowLevelIndex,range:(k=y.query.range,w=w.keyTail,{type:k.type===1?2:k.type,lower:jn(k.lower,k.lowerOpen?e.MAX_KEY:e.MIN_KEY,w),lowerOpen:!0,upper:jn(k.upper,k.upperOpen?e.MIN_KEY:e.MAX_KEY,w),upperOpen:!0})}}):y}return i(i({},a),{schema:i(i({},s),{primaryKey:r,indexes:f,getIndexByKeyPath:function(y){return(y=l[Ye(y)])&&y[0]}}),count:function(y){return a.count(x(y))},query:function(y){return a.query(x(y))},openCursor:function(y){var k=y.query.index,w=k.keyTail,S=k.isVirtual,E=k.keyLength;return S?a.openCursor(x(y)).then(function(D){return D&&_(D)}):a.openCursor(y);function _(D){return Object.create(D,{continue:{value:function(A){A!=null?D.continue(jn(A,y.reverse?e.MAX_KEY:e.MIN_KEY,w)):y.unique?D.continue(D.key.slice(0,E).concat(y.reverse?e.MIN_KEY:e.MAX_KEY,w)):D.continue()}},continuePrimaryKey:{value:function(A,P){D.continuePrimaryKey(jn(A,e.MAX_KEY,w),P)}},primaryKey:{get:function(){return D.primaryKey}},key:{get:function(){var A=D.key;return E===1?A[0]:A.slice(0,E)}},value:{get:function(){return D.value}}})}}})}})}};function Br(e,r,a,s){return a=a||{},s=s||"",d(e).forEach(function(l){var f,p,g;C(r,l)?(f=e[l],p=r[l],typeof f=="object"&&typeof p=="object"&&f&&p?(g=sr(f))!==sr(p)?a[s+l]=r[l]:g==="Object"?Br(f,p,a,s+l+"."):f!==p&&(a[s+l]=r[l]):f!==p&&(a[s+l]=r[l])):a[s+l]=void 0}),d(r).forEach(function(l){C(e,l)||(a[s+l]=r[l])}),a}function qr(e,r){return r.type==="delete"?r.keys:r.keys||r.values.map(e.extractKey)}var Ps={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return i(i({},e),{table:function(r){var a=e.table(r),s=a.schema.primaryKey;return i(i({},a),{mutate:function(l){var f=U.trans,p=f.table(r).hook,g=p.deleting,v=p.creating,b=p.updating;switch(l.type){case"add":if(v.fire===nt)break;return f._promise("readwrite",function(){return x(l)},!0);case"put":if(v.fire===nt&&b.fire===nt)break;return f._promise("readwrite",function(){return x(l)},!0);case"delete":if(g.fire===nt)break;return f._promise("readwrite",function(){return x(l)},!0);case"deleteRange":if(g.fire===nt)break;return f._promise("readwrite",function(){return(function y(k,w,S){return a.query({trans:k,values:!1,query:{index:s,range:w},limit:S}).then(function(E){var _=E.result;return x({type:"delete",keys:_,trans:k}).then(function(D){return 0<D.numFailures?Promise.reject(D.failures[0]):_.length<S?{failures:[],numFailures:0,lastResult:void 0}:y(k,i(i({},w),{lower:_[_.length-1],lowerOpen:!0}),S)})})})(l.trans,l.range,1e4)},!0)}return a.mutate(l);function x(y){var k,w,S,E=U.trans,_=y.keys||qr(s,y);if(!_)throw new Error("Keys missing");return(y=y.type==="add"||y.type==="put"?i(i({},y),{keys:_}):i({},y)).type!=="delete"&&(y.values=u([],y.values)),y.keys&&(y.keys=u([],y.keys)),k=a,S=_,((w=y).type==="add"?Promise.resolve([]):k.getMany({trans:w.trans,keys:S,cache:"immutable"})).then(function(D){var A=_.map(function(P,I){var M,L,j,R=D[I],N={onerror:null,onsuccess:null};return y.type==="delete"?g.fire.call(N,P,R,E):y.type==="add"||R===void 0?(M=v.fire.call(N,P,y.values[I],E),P==null&&M!=null&&(y.keys[I]=P=M,s.outbound||pt(y.values[I],s.keyPath,P))):(M=Br(R,y.values[I]),(L=b.fire.call(N,M,P,R,E))&&(j=y.values[I],Object.keys(L).forEach(function(F){C(j,F)?j[F]=L[F]:pt(j,F,L[F])}))),N});return a.mutate(y).then(function(P){for(var I=P.failures,M=P.results,L=P.numFailures,P=P.lastResult,j=0;j<_.length;++j){var R=(M||_)[j],N=A[j];R==null?N.onerror&&N.onerror(I[j]):N.onsuccess&&N.onsuccess(y.type==="put"&&D[j]?y.values[j]:R)}return{failures:I,results:M,numFailures:L,lastResult:P}}).catch(function(P){return A.forEach(function(I){return I.onerror&&I.onerror(P)}),Promise.reject(P)})})}}})}})}};function po(e,r,a){try{if(!r||r.keys.length<e.length)return null;for(var s=[],l=0,f=0;l<r.keys.length&&f<e.length;++l)Q(r.keys[l],e[f])===0&&(s.push(a?Xt(r.values[l]):r.values[l]),++f);return s.length===e.length?s:null}catch{return null}}var Cs={stack:"dbcore",level:-1,create:function(e){return{table:function(r){var a=e.table(r);return i(i({},a),{getMany:function(s){if(!s.cache)return a.getMany(s);var l=po(s.keys,s.trans._cache,s.cache==="clone");return l?K.resolve(l):a.getMany(s).then(function(f){return s.trans._cache={keys:s.keys,values:s.cache==="clone"?Xt(f):f},f})},mutate:function(s){return s.type!=="add"&&(s.trans._cache=null),a.mutate(s)}})}}}};function go(e,r){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!r.schema.primaryKey.outbound}function mo(e,r){switch(e){case"query":return r.values&&!r.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Is={stack:"dbcore",level:0,name:"Observability",create:function(e){var r=e.schema.name,a=new gt(e.MIN_KEY,e.MAX_KEY);return i(i({},e),{transaction:function(s,l,f){if(U.subscr&&l!=="readonly")throw new W.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(U.querier));return e.transaction(s,l,f)},table:function(s){var l=e.table(s),f=l.schema,p=f.primaryKey,y=f.indexes,g=p.extractKey,v=p.outbound,b=p.autoIncrement&&y.filter(function(w){return w.compound&&w.keyPath.includes(p.keyPath)}),x=i(i({},l),{mutate:function(w){function S(F){return F="idb://".concat(r,"/").concat(s,"/").concat(F),P[F]||(P[F]=new gt)}var E,_,D,A=w.trans,P=w.mutatedParts||(w.mutatedParts={}),I=S(""),M=S(":dels"),L=w.type,N=w.type==="deleteRange"?[w.range]:w.type==="delete"?[w.keys]:w.values.length<50?[qr(p,w).filter(function(F){return F}),w.values]:[],j=N[0],R=N[1],N=w.trans._cache;return h(j)?(I.addKeys(j),(N=L==="delete"||j.length===R.length?po(j,N):null)||M.addKeys(j),(N||R)&&(E=S,_=N,D=R,f.indexes.forEach(function(F){var B=E(F.name||"");function V(X){return X!=null?F.extractKey(X):null}function G(X){return F.multiEntry&&h(X)?X.forEach(function(xt){return B.addKey(xt)}):B.addKey(X)}(_||D).forEach(function(X,mt){var J=_&&V(_[mt]),mt=D&&V(D[mt]);Q(J,mt)!==0&&(J!=null&&G(J),mt!=null&&G(mt))})}))):j?(R={from:(R=j.lower)!==null&&R!==void 0?R:e.MIN_KEY,to:(R=j.upper)!==null&&R!==void 0?R:e.MAX_KEY},M.add(R),I.add(R)):(I.add(a),M.add(a),f.indexes.forEach(function(F){return S(F.name).add(a)})),l.mutate(w).then(function(F){return!j||w.type!=="add"&&w.type!=="put"||(I.addKeys(F.results),b&&b.forEach(function(B){for(var V=w.values.map(function(J){return B.extractKey(J)}),G=B.keyPath.findIndex(function(J){return J===p.keyPath}),X=0,xt=F.results.length;X<xt;++X)V[X][G]=F.results[X];S(B.name).addKeys(V)})),A.mutatedParts=$n(A.mutatedParts||{},P),F})}}),y=function(S){var E=S.query,S=E.index,E=E.range;return[S,new gt((S=E.lower)!==null&&S!==void 0?S:e.MIN_KEY,(E=E.upper)!==null&&E!==void 0?E:e.MAX_KEY)]},k={get:function(w){return[p,new gt(w.key)]},getMany:function(w){return[p,new gt().addKeys(w.keys)]},count:y,query:y,openCursor:y};return d(k).forEach(function(w){x[w]=function(S){var E=U.subscr,_=!!E,D=go(U,l)&&mo(w,S)?S.obsSet={}:E;if(_){var A=function(R){return R="idb://".concat(r,"/").concat(s,"/").concat(R),D[R]||(D[R]=new gt)},P=A(""),I=A(":dels"),E=k[w](S),_=E[0],E=E[1];if((w==="query"&&_.isPrimaryKey&&!S.values?I:A(_.name||"")).add(E),!_.isPrimaryKey){if(w!=="count"){var M=w==="query"&&v&&S.values&&l.query(i(i({},S),{values:!1}));return l[w].apply(this,arguments).then(function(R){if(w==="query"){if(v&&S.values)return M.then(function(V){return V=V.result,P.addKeys(V),R});var N=S.values?R.result.map(g):R.result;(S.values?P:I).addKeys(N)}else if(w==="openCursor"){var F=R,B=S.values;return F&&Object.create(F,{key:{get:function(){return I.addKey(F.primaryKey),F.key}},primaryKey:{get:function(){var V=F.primaryKey;return I.addKey(V),V}},value:{get:function(){return B&&P.addKey(F.primaryKey),F.value}}})}return R})}I.add(a)}}return l[w].apply(this,arguments)}}),x}})}};function yo(e,r,a){if(a.numFailures===0)return r;if(r.type==="deleteRange")return null;var s=r.keys?r.keys.length:"values"in r&&r.values?r.values.length:1;return a.numFailures===s?null:(r=i({},r),h(r.keys)&&(r.keys=r.keys.filter(function(l,f){return!(f in a.failures)})),"values"in r&&h(r.values)&&(r.values=r.values.filter(function(l,f){return!(f in a.failures)})),r)}function Hr(e,r){return a=e,((s=r).lower===void 0||(s.lowerOpen?0<Q(a,s.lower):0<=Q(a,s.lower)))&&(e=e,(r=r).upper===void 0||(r.upperOpen?Q(e,r.upper)<0:Q(e,r.upper)<=0));var a,s}function vo(e,r,k,s,l,f){if(!k||k.length===0)return e;var p=r.query.index,g=p.multiEntry,v=r.query.range,b=s.schema.primaryKey.extractKey,x=p.extractKey,y=(p.lowLevelIndex||p).extractKey,k=k.reduce(function(w,S){var E=w,_=[];if(S.type==="add"||S.type==="put")for(var D=new gt,A=S.values.length-1;0<=A;--A){var P,I=S.values[A],M=b(I);D.hasKey(M)||(P=x(I),(g&&h(P)?P.some(function(F){return Hr(F,v)}):Hr(P,v))&&(D.addKey(M),_.push(I)))}switch(S.type){case"add":var L=new gt().addKeys(r.values?w.map(function(B){return b(B)}):w),E=w.concat(r.values?_.filter(function(B){return B=b(B),!L.hasKey(B)&&(L.addKey(B),!0)}):_.map(function(B){return b(B)}).filter(function(B){return!L.hasKey(B)&&(L.addKey(B),!0)}));break;case"put":var j=new gt().addKeys(S.values.map(function(B){return b(B)}));E=w.filter(function(B){return!j.hasKey(r.values?b(B):B)}).concat(r.values?_:_.map(function(B){return b(B)}));break;case"delete":var R=new gt().addKeys(S.keys);E=w.filter(function(B){return!R.hasKey(r.values?b(B):B)});break;case"deleteRange":var N=S.range;E=w.filter(function(B){return!Hr(b(B),N)})}return E},e);return k===e?e:(k.sort(function(w,S){return Q(y(w),y(S))||Q(b(w),b(S))}),r.limit&&r.limit<1/0&&(k.length>r.limit?k.length=r.limit:e.length===r.limit&&k.length<r.limit&&(l.dirty=!0)),f?Object.freeze(k):k)}function wo(e,r){return Q(e.lower,r.lower)===0&&Q(e.upper,r.upper)===0&&!!e.lowerOpen==!!r.lowerOpen&&!!e.upperOpen==!!r.upperOpen}function $s(e,r){return(function(a,s,l,f){if(a===void 0)return s!==void 0?-1:0;if(s===void 0)return 1;if((s=Q(a,s))===0){if(l&&f)return 0;if(l)return 1;if(f)return-1}return s})(e.lower,r.lower,e.lowerOpen,r.lowerOpen)<=0&&0<=(function(a,s,l,f){if(a===void 0)return s!==void 0?1:0;if(s===void 0)return-1;if((s=Q(a,s))===0){if(l&&f)return 0;if(l)return-1;if(f)return 1}return s})(e.upper,r.upper,e.upperOpen,r.upperOpen)}function Ms(e,r,a,s){e.subscribers.add(a),s.addEventListener("abort",function(){var l,f;e.subscribers.delete(a),e.subscribers.size===0&&(l=e,f=r,setTimeout(function(){l.subscribers.size===0&&Qt(f,l)},3e3))})}var js={stack:"dbcore",level:0,name:"Cache",create:function(e){var r=e.schema.name;return i(i({},e),{transaction:function(a,s,l){var f,p,g=e.transaction(a,s,l);return s==="readwrite"&&(p=(f=new AbortController).signal,l=function(v){return function(){if(f.abort(),s==="readwrite"){for(var b=new Set,x=0,y=a;x<y.length;x++){var k=y[x],w=se["idb://".concat(r,"/").concat(k)];if(w){var S=e.table(k),E=w.optimisticOps.filter(function(B){return B.trans===g});if(g._explicit&&v&&g.mutatedParts)for(var _=0,D=Object.values(w.queries.query);_<D.length;_++)for(var A=0,P=(L=D[_]).slice();A<P.length;A++)Rr((j=P[A]).obsSet,g.mutatedParts)&&(Qt(L,j),j.subscribers.forEach(function(B){return b.add(B)}));else if(0<E.length){w.optimisticOps=w.optimisticOps.filter(function(B){return B.trans!==g});for(var I=0,M=Object.values(w.queries.query);I<M.length;I++)for(var L,j,R,N=0,F=(L=M[I]).slice();N<F.length;N++)(j=F[N]).res!=null&&g.mutatedParts&&(v&&!j.dirty?(R=Object.isFrozen(j.res),R=vo(j.res,j.req,E,S,j,R),j.dirty?(Qt(L,j),j.subscribers.forEach(function(B){return b.add(B)})):R!==j.res&&(j.res=R,j.promise=K.resolve({result:R}))):(j.dirty&&Qt(L,j),j.subscribers.forEach(function(B){return b.add(B)})))}}}b.forEach(function(B){return B()})}}},g.addEventListener("abort",l(!1),{signal:p}),g.addEventListener("error",l(!1),{signal:p}),g.addEventListener("complete",l(!0),{signal:p})),g},table:function(a){var s=e.table(a),l=s.schema.primaryKey;return i(i({},s),{mutate:function(f){var p=U.trans;if(l.outbound||p.db._options.cache==="disabled"||p.explicit||p.idbtrans.mode!=="readwrite")return s.mutate(f);var g=se["idb://".concat(r,"/").concat(a)];return g?(p=s.mutate(f),f.type!=="add"&&f.type!=="put"||!(50<=f.values.length||qr(l,f).some(function(v){return v==null}))?(g.optimisticOps.push(f),f.mutatedParts&&Mn(f.mutatedParts),p.then(function(v){0<v.numFailures&&(Qt(g.optimisticOps,f),(v=yo(0,f,v))&&g.optimisticOps.push(v),f.mutatedParts&&Mn(f.mutatedParts))}),p.catch(function(){Qt(g.optimisticOps,f),f.mutatedParts&&Mn(f.mutatedParts)})):p.then(function(v){var b=yo(0,i(i({},f),{values:f.values.map(function(x,y){var k;return v.failures[y]?x:(x=(k=l.keyPath)!==null&&k!==void 0&&k.includes(".")?Xt(x):i({},x),pt(x,l.keyPath,v.results[y]),x)})}),v);g.optimisticOps.push(b),queueMicrotask(function(){return f.mutatedParts&&Mn(f.mutatedParts)})}),p):s.mutate(f)},query:function(f){if(!go(U,s)||!mo("query",f))return s.query(f);var p=((b=U.trans)===null||b===void 0?void 0:b.db._options.cache)==="immutable",y=U,g=y.requery,v=y.signal,b=(function(S,E,_,D){var A=se["idb://".concat(S,"/").concat(E)];if(!A)return[];if(!(E=A.queries[_]))return[null,!1,A,null];var P=E[(D.query?D.query.index.name:null)||""];if(!P)return[null,!1,A,null];switch(_){case"query":var I=P.find(function(M){return M.req.limit===D.limit&&M.req.values===D.values&&wo(M.req.query.range,D.query.range)});return I?[I,!0,A,P]:[P.find(function(M){return("limit"in M.req?M.req.limit:1/0)>=D.limit&&(!D.values||M.req.values)&&$s(M.req.query.range,D.query.range)}),!1,A,P];case"count":return I=P.find(function(M){return wo(M.req.query.range,D.query.range)}),[I,!!I,A,P]}})(r,a,"query",f),x=b[0],y=b[1],k=b[2],w=b[3];return x&&y?x.obsSet=f.obsSet:(y=s.query(f).then(function(S){var E=S.result;if(x&&(x.res=E),p){for(var _=0,D=E.length;_<D;++_)Object.freeze(E[_]);Object.freeze(E)}else S.result=Xt(E);return S}).catch(function(S){return w&&x&&Qt(w,x),Promise.reject(S)}),x={obsSet:f.obsSet,promise:y,subscribers:new Set,type:"query",req:f,dirty:!1},w?w.push(x):(w=[x],(k=k||(se["idb://".concat(r,"/").concat(a)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[f.query.index.name||""]=w)),Ms(x,w,g,v),x.promise.then(function(S){return{result:vo(S.result,f,k?.optimisticOps,s,x,p)}})}})}})}};function Rn(e,r){return new Proxy(e,{get:function(a,s,l){return s==="db"?r:Reflect.get(a,s,l)}})}var Rt=(ct.prototype.version=function(e){if(isNaN(e)||e<.1)throw new W.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new W.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var r=this._versions,a=r.filter(function(s){return s._cfg.version===e})[0];return a||(a=new this.Version(e),r.push(a),r.sort(Ts),a.stores({}),this._state.autoSchema=!1,a)},ct.prototype._whenReady=function(e){var r=this;return this.idbdb&&(this._state.openComplete||U.letThrough||this._vip)?e():new K(function(a,s){if(r._state.openComplete)return s(new W.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._state.autoOpen)return void s(new W.DatabaseClosed);r.open().catch(nt)}r._state.dbReadyPromise.then(a,s)}).then(e)},ct.prototype.use=function(e){var r=e.stack,a=e.create,s=e.level,l=e.name;return l&&this.unuse({stack:r,name:l}),e=this._middlewares[r]||(this._middlewares[r]=[]),e.push({stack:r,create:a,level:s??10,name:l}),e.sort(function(f,p){return f.level-p.level}),this},ct.prototype.unuse=function(e){var r=e.stack,a=e.name,s=e.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(l){return s?l.create!==s:!!a&&l.name!==a})),this},ct.prototype.open=function(){var e=this;return ie(Kt,function(){return As(e)})},ct.prototype._close=function(){var e=this._state,r=Te.indexOf(this);if(0<=r&&Te.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new K(function(a){e.dbReadyResolve=a}),e.openCanceller=new K(function(a,s){e.cancelOpen=s}))},ct.prototype.close=function(a){var r=(a===void 0?{disableAutoOpen:!0}:a).disableAutoOpen,a=this._state;r?(a.isBeingOpened&&a.cancelOpen(new W.DatabaseClosed),this._close(),a.autoOpen=!1,a.dbOpenError=new W.DatabaseClosed):(this._close(),a.autoOpen=this._options.autoOpen||a.isBeingOpened,a.openComplete=!1,a.dbOpenError=null)},ct.prototype.delete=function(e){var r=this;e===void 0&&(e={disableAutoOpen:!0});var a=0<arguments.length&&typeof arguments[0]!="object",s=this._state;return new K(function(l,f){function p(){r.close(e);var g=r._deps.indexedDB.deleteDatabase(r.name);g.onsuccess=at(function(){var v,b,x;v=r._deps,b=r.name,x=v.indexedDB,v=v.IDBKeyRange,$r(x)||b===_n||Ir(x,v).delete(b).catch(nt),l()}),g.onerror=Pt(f),g.onblocked=r._fireOnBlocked}if(a)throw new W.InvalidArgument("Invalid closeOptions argument to db.delete()");s.isBeingOpened?s.dbReadyPromise.then(p):p()})},ct.prototype.backendDB=function(){return this.idbdb},ct.prototype.isOpen=function(){return this.idbdb!==null},ct.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ct.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ct.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ct.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(r){return e._allTables[r]})},enumerable:!1,configurable:!0}),ct.prototype.transaction=function(){var e=function(r,a,s){var l=arguments.length;if(l<2)throw new W.InvalidArgument("Too few arguments");for(var f=new Array(l-1);--l;)f[l-1]=arguments[l];return s=f.pop(),[r,ln(f),s]}.apply(this,arguments);return this._transaction.apply(this,e)},ct.prototype._transaction=function(e,r,a){var s=this,l=U.trans;l&&l.db===this&&e.indexOf("!")===-1||(l=null);var f,p,g=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(p=r.map(function(b){if(b=b instanceof s.Table?b.name:b,typeof b!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return b}),e=="r"||e===br)f=br;else{if(e!="rw"&&e!=_r)throw new W.InvalidArgument("Invalid transaction mode: "+e);f=_r}if(l){if(l.mode===br&&f===_r){if(!g)throw new W.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");l=null}l&&p.forEach(function(b){if(l&&l.storeNames.indexOf(b)===-1){if(!g)throw new W.SubTransaction("Table "+b+" not included in parent transaction.");l=null}}),g&&l&&!l.active&&(l=null)}}catch(b){return l?l._promise(null,function(x,y){y(b)}):ut(b)}var v=function b(x,y,k,w,S){return K.resolve().then(function(){var E=U.transless||U,_=x._createTransaction(y,k,x._dbSchema,w);if(_.explicit=!0,E={trans:_,transless:E},w)_.idbtrans=w.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,x._state.PR1398_maxLoop=3}catch(P){return P.name===lr.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return b(x,y,k,null,S)})):ut(P)}var D,A=cr(S);return A&&xe(),E=K.follow(function(){var P;(D=S.call(_,_))&&(A?(P=qt.bind(null,null),D.then(P,P)):typeof D.next=="function"&&typeof D.throw=="function"&&(D=Kr(D)))},E),(D&&typeof D.then=="function"?K.resolve(D).then(function(P){return _.active?P:ut(new W.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):E.then(function(){return D})).then(function(P){return w&&_._resolve(),_._completion.then(function(){return P})}).catch(function(P){return _._reject(P),ut(P)})})}.bind(null,this,f,p,l,a);return l?l._promise(f,v,"lock"):U.trans?ie(U.transless,function(){return s._whenReady(v)}):this._whenReady(v)},ct.prototype.table=function(e){if(!C(this._allTables,e))throw new W.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ct);function ct(e,r){var a=this;this._middlewares={},this.verno=0;var s=ct.dependencies;this._options=r=i({addons:ct.addons,autoOpen:!0,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange},s=r.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var l,f,p,g,v,b={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:nt,dbReadyPromise:null,cancelOpen:nt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};b.dbReadyPromise=new K(function(y){b.dbReadyResolve=y}),b.openCanceller=new K(function(y,k){b.cancelOpen=k}),this._state=b,this.name=e,this.on=He(this,"populate","blocked","versionchange","close",{ready:[dr,nt]}),this.on.ready.subscribe=ot(this.on.ready.subscribe,function(y){return function(k,w){ct.vip(function(){var S,E=a._state;E.openComplete?(E.dbOpenError||K.resolve().then(k),w&&y(k)):E.onReadyBeingFired?(E.onReadyBeingFired.push(k),w&&y(k)):(y(k),S=a,w||y(function _(){S.on.ready.unsubscribe(k),S.on.ready.unsubscribe(_)}))})}}),this.Collection=(l=this,Ue(ys.prototype,function(D,_){this.db=l;var w=Yi,S=null;if(_)try{w=_()}catch(A){S=A}var E=D._ctx,_=E.table,D=_.hook.reading.fire;this._ctx={table:_,index:E.index,isPrimKey:!E.index||_.schema.primKey.keyPath&&E.index===_.schema.primKey.name,range:w,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:S,or:E.or,valueMapper:D!==Le?D:null}})),this.Table=(f=this,Ue(Zi.prototype,function(y,k,w){this.db=f,this._tx=w,this.name=y,this.schema=k,this.hook=f._allTables[y]?f._allTables[y].hook:He(null,{creating:[us,nt],reading:[ss,Le],updating:[ls,nt],deleting:[cs,nt]})})),this.Transaction=(p=this,Ue(bs.prototype,function(y,k,w,S,E){var _=this;this.db=p,this.mode=y,this.storeNames=k,this.schema=w,this.chromeTransactionDurability=S,this.idbtrans=null,this.on=He(this,"complete","error","abort"),this.parent=E||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new K(function(D,A){_._resolve=D,_._reject=A}),this._completion.then(function(){_.active=!1,_.on.complete.fire()},function(D){var A=_.active;return _.active=!1,_.on.error.fire(D),_.parent?_.parent._reject(D):A&&_.idbtrans&&_.idbtrans.abort(),ut(D)})})),this.Version=(g=this,Ue(Ds.prototype,function(y){this.db=g,this._cfg={version:y,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(v=this,Ue(io.prototype,function(y,k,w){if(this.db=v,this._ctx={table:y,index:k===":id"?null:k,or:w},this._cmp=this._ascending=Q,this._descending=function(S,E){return Q(E,S)},this._max=function(S,E){return 0<Q(S,E)?S:E},this._min=function(S,E){return Q(S,E)<0?S:E},this._IDBKeyRange=v._deps.IDBKeyRange,!this._IDBKeyRange)throw new W.MissingAPI})),this.on("versionchange",function(y){0<y.newVersion?console.warn("Another connection wants to upgrade database '".concat(a.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(a.name,"'. Closing db now to resume the delete request.")),a.close({disableAutoOpen:!1})}),this.on("blocked",function(y){!y.newVersion||y.newVersion<y.oldVersion?console.warn("Dexie.delete('".concat(a.name,"') was blocked")):console.warn("Upgrade '".concat(a.name,"' blocked by other connection holding version ").concat(y.oldVersion/10))}),this._maxKey=Ve(r.IDBKeyRange),this._createTransaction=function(y,k,w,S){return new a.Transaction(y,k,w,a._options.chromeTransactionDurability,S)},this._fireOnBlocked=function(y){a.on("blocked").fire(y),Te.filter(function(k){return k.name===a.name&&k!==a&&!k._state.vcFired}).map(function(k){return k.on("versionchange").fire(y)})},this.use(Cs),this.use(js),this.use(Is),this.use(Os),this.use(Ps);var x=new Proxy(this,{get:function(y,k,w){if(k==="_vip")return!0;if(k==="table")return function(E){return Rn(a.table(E),x)};var S=Reflect.get(y,k,w);return S instanceof Zi?Rn(S,x):k==="tables"?S.map(function(E){return Rn(E,x)}):k==="_createTransaction"?function(){return Rn(S.apply(this,arguments),x)}:S}});this.vip=x,s.forEach(function(y){return y(a)})}var Fn,Tt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Rs=(Ur.prototype.subscribe=function(e,r,a){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:r,complete:a})},Ur.prototype[Tt]=function(){return this},Ur);function Ur(e){this._subscribe=e}try{Fn={indexedDB:c.indexedDB||c.mozIndexedDB||c.webkitIndexedDB||c.msIndexedDB,IDBKeyRange:c.IDBKeyRange||c.webkitIDBKeyRange}}catch{Fn={indexedDB:null,IDBKeyRange:null}}function bo(e){var r,a=!1,s=new Rs(function(l){var f=cr(e),p,g=!1,v={},b={},x={get closed(){return g},unsubscribe:function(){g||(g=!0,p&&p.abort(),y&&Wt.storagemutated.unsubscribe(w))}};l.start&&l.start(x);var y=!1,k=function(){return wr(S)},w=function(E){$n(v,E),Rr(b,v)&&k()},S=function(){var E,_,D;!g&&Fn.indexedDB&&(v={},E={},p&&p.abort(),p=new AbortController,D=(function(A){var P=_e();try{f&&xe();var I=Bt(e,A);return I=f?I.finally(qt):I}finally{P&&Se()}})(_={subscr:E,signal:p.signal,requery:k,querier:e,trans:null}),Promise.resolve(D).then(function(A){a=!0,r=A,g||_.signal.aborted||(v={},(function(P){for(var I in P)if(C(P,I))return;return 1})(b=E)||y||(Wt(Je,w),y=!0),wr(function(){return!g&&l.next&&l.next(A)}))},function(A){a=!1,["DatabaseClosedError","AbortError"].includes(A?.name)||g||wr(function(){g||l.error&&l.error(A)})}))};return setTimeout(k,0),x});return s.hasValue=function(){return a},s.getValue=function(){return r},s}var ue=Rt;function Wr(e){var r=zt;try{zt=!0,Wt.storagemutated.fire(e),Nr(e,!0)}finally{zt=r}}$(ue,i(i({},fn),{delete:function(e){return new ue(e,{addons:[]}).delete()},exists:function(e){return new ue(e,{addons:[]}).open().then(function(r){return r.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return r=ue.dependencies,a=r.indexedDB,r=r.IDBKeyRange,($r(a)?Promise.resolve(a.databases()).then(function(s){return s.map(function(l){return l.name}).filter(function(l){return l!==_n})}):Ir(a,r).toCollection().primaryKeys()).then(e)}catch{return ut(new W.MissingAPI)}var r,a},defineClass:function(){return function(e){m(this,e)}},ignoreTransaction:function(e){return U.trans?ie(U.transless,e):e()},vip:Mr,async:function(e){return function(){try{var r=Kr(e.apply(this,arguments));return r&&typeof r.then=="function"?r:K.resolve(r)}catch(a){return ut(a)}}},spawn:function(e,r,a){try{var s=Kr(e.apply(a,r||[]));return s&&typeof s.then=="function"?s:K.resolve(s)}catch(l){return ut(l)}},currentTransaction:{get:function(){return U.trans||null}},waitFor:function(e,r){return r=K.resolve(typeof e=="function"?ue.ignoreTransaction(e):e).timeout(r||6e4),U.trans?U.trans.waitFor(r):r},Promise:K,debug:{get:function(){return Ot},set:function(e){qi(e)}},derive:et,extend:m,props:$,override:ot,Events:He,on:Wt,liveQuery:bo,extendObservabilitySet:$n,getByKeyPath:vt,setByKeyPath:pt,delByKeyPath:function(e,r){typeof r=="string"?pt(e,r,void 0):"length"in r&&[].map.call(r,function(a){pt(e,a,void 0)})},shallowClone:cn,deepClone:Xt,getObjectDiff:Br,cmp:Q,asap:$t,minKey:-1/0,addons:[],connections:Te,errnames:lr,dependencies:Fn,cache:se,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,r,a){return e+r/Math.pow(10,2*a)})})),ue.maxKey=Ve(ue.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Wt(Je,function(e){zt||(e=new CustomEvent(Er,{detail:e}),zt=!0,dispatchEvent(e),zt=!1)}),addEventListener(Er,function(e){e=e.detail,zt||Wr(e)}));var De,zt=!1,_o=function(){};return typeof BroadcastChannel<"u"&&((_o=function(){(De=new BroadcastChannel(Er)).onmessage=function(e){return e.data&&Wr(e.data)}})(),typeof De.unref=="function"&&De.unref(),Wt(Je,function(e){zt||De.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Rt.disableBfCache&&e.persisted){Ot&&console.debug("Dexie: handling persisted pagehide"),De?.close();for(var r=0,a=Te;r<a.length;r++)a[r].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Rt.disableBfCache&&e.persisted&&(Ot&&console.debug("Dexie: handling persisted pageshow"),_o(),Wr({all:new gt(-1/0,[[]])}))})),K.rejectionMapper=function(e,r){return!e||e instanceof we||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Bi[e.name]?e:(r=new Bi[e.name](r||e.message,e),"stack"in e&&z(r,"stack",{get:function(){return this.inner.stack}}),r)},qi(Ot),i(Rt,Object.freeze({__proto__:null,Dexie:Rt,liveQuery:bo,Entity:Gi,cmp:Q,PropModification:We,replacePrefix:function(e,r){return new We({replacePrefix:[e,r]})},add:function(e){return new We({add:e})},remove:function(e){return new We({remove:e})},default:Rt,RangeSet:gt,mergeRanges:Xe,rangesOverlap:co}),{default:Rt}),Rt})})(Jn)),Jn.exports}var nl=el();const mi=Zc(nl),Lo=Symbol.for("Dexie"),Qn=globalThis[Lo]||(globalThis[Lo]=mi);if(mi.semVer!==Qn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${mi.semVer} and ${Qn.semVer}`);const{liveQuery:bl,mergeRanges:_l,rangesOverlap:Sl,RangeSet:xl,cmp:Tl,Entity:El,PropModification:kl,replacePrefix:Dl,add:Al,remove:Ol}=Qn;class Za extends Qn{constructor(){super("TimeTrackerDB");Nn(this,"entries");Nn(this,"projects");this.version(1).stores({entries:"++id, startTime, endTime, projectId, category, syncStatus, createdAt, deletedAt",projects:"++id, name, isActive, syncStatus, createdAt"}),this.version(2).stores({entries:"++id, startTime, endTime, projectId, category, syncStatus, createdAt, deletedAt, deletedByEntryId, prototypeId",projects:"++id, name, isActive, syncStatus, createdAt"}),this.version(3).stores({entries:"++id, startTime, endTime, rawStartTime, rawEndTime, projectId, category, syncStatus, createdAt, deletedAt, deletedByEntryId, prototypeId",projects:"++id, name, isActive, syncStatus, createdAt"})}}const _t=new Za;function Oe(){return crypto.randomUUID()}const yi=Object.freeze(Object.defineProperty({__proto__:null,TimeTrackerDB:Za,db:_t,generateId:Oe},Symbol.toStringTag,{value:"Module"}));function rl(){try{let n=JSON.parse(localStorage.getItem("appSettings")||"{}").timeRounding??300;return typeof n=="string"&&(n=n==="null"?null:Number(n)),n}catch{return 300}}function ts(t,n=null,o="down"){if(n==null&&(n=rl()),n===null||n===0)return new Date(t);const i=new Date(t);if(n===1)return i.setMilliseconds(0),i;const u=i.getHours()*3600+i.getMinutes()*60+i.getSeconds();let c;if(o==="down"?c=Math.floor(u/n)*n:c=Math.ceil(u/n)*n,n===1500){const T=Math.floor(u/60);let O;o==="down"?T<25?O=0:T<30?O=25:T<55?O=30:O=55:T<25?O=25:T<30?O=30:T<55?O=55:O=60,c=O*60}else if(n===2700){const T=Math.floor(u/60);let O;o==="down"?O=T<45?0:45:O=T<45?45:60,c=O*60}else if(n===3300){const T=Math.floor(u/60);let O;o==="down"?O=T<55?0:55:O=T<55?55:60,c=O*60}const d=Math.floor(c/3600)%24,h=Math.floor(c%3600/60),m=c%60;return i.setHours(d,h,m,0),i}function Lt(t,n){return ts(t,n,"down")}function Ft(t,n){return ts(t,n,"up")}class il{constructor(n){Nn(this,"activities");this.activities=n}async parseNaturalLanguage(n,o=new Date){if(!n.trim())return{entries:[],failedLines:[],successfulLines:[]};const i=n.split(",").map(T=>T.trim()).filter(T=>T.length>0),u=[],c=[],d=[];let h=null;if(i.every(T=>!T.match(/\d{1,2}:?\d{0,2}\s*-\s*\d{1,2}:?\d{0,2}/)&&!T.match(/till|until|to\s+\d/i)&&T.match(/\d+\s*(h|hr|hour|m|min)/i))){const T=new Date;let O=new Date(T);for(let C=i.length-1;C>=0;C--){const $=i[C],q=this.parseSingleEntry($,o,h);if(q&&q.duration){const z=new Date(O),et=new Date(z.getTime()-q.duration*1e3),H=Lt(et),Y=Ft(z),Z=Math.floor((Y.getTime()-H.getTime())/1e3);u.unshift({...q,startTime:H,endTime:Y,rawStartTime:et,rawEndTime:z,duration:Z}),d.unshift($),O=H}else c.unshift($)}}else for(const T of i){const O=this.parseSingleEntry(T,o,h);O?(u.push(O),d.push(T),h=O.endTime||null):c.push(T)}return{entries:u,failedLines:c,successfulLines:d}}parseSingleEntry(n,o,i){let u=null,c=null,d=null,h=null;if(u=this.findActivity(n),!u){const C=n.split(/\s+/);if(u=this.findActivity(C[0]),!u&&C.length>1&&(u=this.findActivity(C[C.length-1])),!u){const $=n.replace(/\d{1,2}:?\d{0,2}\s*-\s*\d{1,2}:?\d{0,2}\s*(am|pm)?/gi,"").replace(/(?:till|until|to)\s+\d{1,2}:?\d{0,2}\s*(am|pm)?/gi,"").replace(/\d+\.?\d*\s*(h|hr|hour|m|min)/gi,"").trim();$&&(u=this.findActivity($))}}if(!u)return null;const m=n.match(/(?:till|until|to)\s+(\d{1,2}):?(\d{0,2})\s*(am|pm)?/i);if(m){c=i||new Date;let C=parseInt(m[1]);const $=parseInt(m[2]||"0"),q=m[3];q?.toLowerCase()==="pm"&&C<12&&(C+=12),q?.toLowerCase()==="am"&&C===12&&(C=0);const z=new Date(o);z.setHours(C,$,0,0),d=Ft(z),h=Math.floor((d.getTime()-c.getTime())/1e3)}const T=n.match(/(\d{1,2}):?(\d{0,2})\s*-\s*(\d{1,2}):?(\d{0,2})\s*(am|pm)?/i);if(T&&!m){let C=parseInt(T[1]);const $=parseInt(T[2]||"0");let q=parseInt(T[3]);const z=parseInt(T[4]||"0"),et=T[5];et?.toLowerCase()==="pm"&&(q<12&&(q+=12),C<q&&C<12&&(C+=12)),et?.toLowerCase()==="am"&&(C===12&&(C=0),q===12&&(q=0));const H=new Date(o);H.setHours(C,$,0,0);const Y=new Date(o);Y.setHours(q,z,0,0),c=Lt(H),d=Ft(Y),h=Math.floor((d.getTime()-c.getTime())/1e3)}const O=n.match(/(\d+\.?\d*)\s*(h|hr|hour|m|min)/i);if(O&&!T&&!m){const C=parseFloat(O[1]);if(O[2].toLowerCase().startsWith("h")?h=Math.floor(C*3600):h=Math.floor(C*60),i){const q=new Date(i),z=new Date(q.getTime()+h*1e3);c=Lt(q),d=Ft(z),h=Math.floor((d.getTime()-c.getTime())/1e3)}}return c&&d||h?{date:o.toDateString(),startTime:c||void 0,endTime:d||void 0,activity:u.label,duration:h||void 0}:null}findActivity(n){if(!n)return null;const o=n.toLowerCase();for(const i of this.activities)if(i.label.toLowerCase()===o||i.id.toLowerCase()===o||i.aliases.some(u=>o.includes(u)))return i;return null}}function ol(t){return new il(t)}function No(){try{return JSON.parse(localStorage.getItem("appSettings")||"{}").durationThreshold||15}catch{return 15}}class es{async addEntryWithOverlapHandling(n){if(!n.startTime||!n.endTime){const d=Oe();await _t.entries.add({...n,id:d}),window.dispatchEvent(new CustomEvent("entryAdded",{detail:{...n,id:d}}));return}const o=await this.findOverlappingEntries(n.startTime,n.endTime);if(o.length===0){const d=Oe();await _t.entries.add({...n,id:d}),window.dispatchEvent(new CustomEvent("entryAdded",{detail:{...n,id:d}}));return}const i=this.resolveOverlaps(n,o),u=Oe(),c={id:u,description:n.description,startTime:n.startTime,endTime:n.endTime,duration:n.duration,projectId:n.projectId,tags:Array.isArray(n.tags)?[...n.tags]:[],category:n.category,subcategory:n.subcategory,syncStatus:n.syncStatus||"local",createdAt:n.createdAt||new Date,updatedAt:n.updatedAt||new Date,prototypeId:n.prototypeId,deletedByEntryId:n.deletedByEntryId};console.log("Adding entry:",c),await _t.entries.add(c),window.dispatchEvent(new CustomEvent("entryAdded",{detail:c}));for(const d of i.entries.filter(h=>h.prototypeId)){const h=Oe();await _t.entries.add({...d,id:h}),window.dispatchEvent(new CustomEvent("entryAdded",{detail:{...d,id:h}}))}for(const d of i.softDeletedIds)await _t.entries.update(d,{deletedAt:new Date,updatedAt:new Date,deletedByEntryId:u}),window.dispatchEvent(new CustomEvent("entryDeleted",{detail:{id:d}}));if(i.discardedCount>0){const d=No(),h=window.Alpine?.store?.("notifications");h&&h.showInfo(`${i.discardedCount} remainder entries discarded (< ${d}s threshold)`)}}async findOverlappingEntries(n,o){const i=new Date(n),u=new Date(i.getFullYear(),i.getMonth(),i.getDate()),c=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1);return(await _t.entries.where("startTime").between(u,c).and(h=>!h.deletedAt).toArray()).filter(h=>h.startTime&&h.endTime&&h.startTime<o&&h.endTime>n)}resolveOverlaps(n,o){const i=[],u=o.map(h=>h.id),c=No();let d=0;if(!n.startTime||!n.endTime)return i.push(n),{action:o.length>0?"replace":"add",entries:i,softDeletedIds:u,discardedCount:0};for(const h of o){if(!h.startTime||!h.endTime)continue;const m=this.generateGaps(h,n.startTime,n.endTime);for(const T of m)if(T.duration>=c){const O=h.rawStartTime&&h.rawStartTime>=T.startTime&&h.rawStartTime<T.endTime?h.rawStartTime:T.startTime,C=h.rawEndTime&&h.rawEndTime>T.startTime&&h.rawEndTime<=T.endTime?h.rawEndTime:T.endTime,$={...h,startTime:T.startTime,endTime:T.endTime,rawStartTime:O,rawEndTime:C,duration:T.duration,createdAt:new Date,updatedAt:new Date,deletedAt:void 0,prototypeId:h.id,deletedByEntryId:void 0};i.push($)}else d++,console.log(`Gap discarded: ${T.duration}s < ${c}s threshold`)}return{action:o.length>0?"replace":"add",entries:i,softDeletedIds:u,discardedCount:d}}generateGaps(n,o,i){const u=[];if(!n.startTime||!n.endTime)return u;if(n.startTime<o&&n.endTime>n.startTime){const c=o<n.endTime?o:n.endTime,d=Math.floor((c.getTime()-n.startTime.getTime())/1e3);d>0&&u.push({startTime:n.startTime,endTime:c,duration:d})}if(n.endTime>i&&n.startTime<n.endTime){const c=i>n.startTime?i:n.startTime,d=Math.floor((n.endTime.getTime()-c.getTime())/1e3);d>0&&u.push({startTime:c,endTime:n.endTime,duration:d})}return u}static hasOverlap(n,o,i,u){return n<u&&o>i}}const ns=new es,al=Object.freeze(Object.defineProperty({__proto__:null,OverlapResolver:es,overlapResolver:ns},Symbol.toStringTag,{value:"Module"})),sl=()=>({isRunning:!1,startTime:null,elapsed:0,interval:null,currentActivity:null,currentSubcategory:null,showSubcategoryPicker:!1,sessionStartTime:null,pendingSubcategoryEntry:null,naturalInput:"",parsingInProgress:!1,init(){this.validateAndCleanTimerState(),this.checkForActiveTimer(),this.registerEventHandlers()},validateAndCleanTimerState(){try{const t=localStorage.getItem("activeTimer");if(t){const n=JSON.parse(t),o=new Date(n.startTime);(isNaN(o.getTime())||o.getTime()<0)&&(console.warn("Detected corrupted timer data, clearing all timer storage"),localStorage.removeItem("activeTimer"),localStorage.removeItem("previousTimerState"),this.resetTimerState())}}catch{console.warn("Error validating timer state, clearing storage"),localStorage.removeItem("activeTimer"),localStorage.removeItem("previousTimerState"),this.resetTimerState()}},resetTimerState(){this.isRunning=!1,this.startTime=null,this.elapsed=0,this.currentActivity=null,this.currentSubcategory=null,this.sessionStartTime=null,this.showSubcategoryPicker=!1,this.interval&&(clearInterval(this.interval),this.interval=null)},registerEventHandlers(){document.addEventListener("toggle-activity",t=>{this.handleActivityClick(t.detail)})},async handleActivityClick(t){if(this.currentActivity?.id===t.id){this.showSubcategoryPickerForActivity(t);return}await this.transitionToActivity(t,null)},async handleActivityDoubleClick(t){this.showSubcategoryPickerForActivity(t)},async startTrackingDirectly(t){this.currentActivity&&this.currentActivity.id!==t.id&&await this.saveCurrentSession(),await this.startTracking(t),this.startTicking()},async transitionToActivity(t,n){if(this.currentActivity?.id===t.id&&this.currentSubcategory===n)return;if(!this.currentActivity||!this.isRunning){await this.startTracking(t,n||void 0),this.startTicking();return}const o=this.getCurrentSessionDuration(),u=this.getSettings().durationThreshold||15;o>=u?(await this.saveCurrentSession(),await this.startTracking(t,n||void 0),this.startTicking()):this.updateCurrentSessionActivity(t,n)},getCurrentSessionDuration(){return this.sessionStartTime?Math.floor((new Date().getTime()-this.sessionStartTime.getTime())/1e3):0},updateCurrentSessionActivity(t,n){this.currentActivity=t,this.currentSubcategory=n,localStorage.setItem("activeTimer",JSON.stringify({startTime:this.startTime,sessionStartTime:this.sessionStartTime,currentActivity:t,currentSubcategory:n})),this.isRunning||this.startTicking()},showSubcategoryPickerForActivity(t){this.savePreviousTimerState(),t.subcategories&&t.subcategories.length>0?(this.currentActivity=t,this.showSubcategoryPicker=!0):this.transitionToActivity(t,null)},checkForActiveTimer(){const t=localStorage.getItem("activeTimer");if(t)try{const n=JSON.parse(t),o=new Date(n.startTime),i=n.sessionStartTime?new Date(n.sessionStartTime):new Date(n.startTime);if(isNaN(o.getTime())||isNaN(i.getTime())){console.warn("Corrupted timer timestamps, clearing localStorage"),localStorage.removeItem("activeTimer");return}const u=new Date,c=1440*60*1e3;if(u.getTime()-o.getTime()>c){console.warn("Saved timer too old, clearing localStorage"),localStorage.removeItem("activeTimer");return}this.startTime=o,this.sessionStartTime=i,this.currentActivity=n.currentActivity,this.currentSubcategory=n.currentSubcategory||null,this.isRunning=!0,this.startTicking()}catch(n){console.error("Failed to restore active timer:",n),localStorage.removeItem("activeTimer"),window.Alpine.store("notifications").showError("Failed to restore previous timer session")}},async toggleActivity(t){if(this.currentActivity?.id===t.id){t.subcategories&&t.subcategories.length>0&&(this.showSubcategoryPicker=!0);return}this.currentActivity&&await this.stopTracking(),await this.startTracking(t),t.subcategories&&t.subcategories.length>0&&(this.showSubcategoryPicker=!0)},async selectSubcategory(t){this.showSubcategoryPicker=!1,this.currentActivity&&await this.transitionToActivity(this.currentActivity,t)},async resetSubcategory(){this.showSubcategoryPicker=!1,this.currentActivity&&await this.transitionToActivity(this.currentActivity,null)},getPreviousTimerState(){try{const t=localStorage.getItem("previousTimerState");if(t){const n=JSON.parse(t);return{...n,startTime:n.startTime?new Date(n.startTime):null,sessionStartTime:n.sessionStartTime?new Date(n.sessionStartTime):null}}}catch(t){console.error("Error loading previous timer state:",t)}return null},savePreviousTimerState(){const t={startTime:this.startTime,sessionStartTime:this.sessionStartTime,currentActivity:this.currentActivity,currentSubcategory:this.currentSubcategory};localStorage.setItem("previousTimerState",JSON.stringify(t))},async startTracking(t,n){this.currentActivity=t,this.currentSubcategory=n||null;const o=new Date;this.startTime=Lt(o),this.sessionStartTime=this.startTime,this.elapsed=0,this.isRunning=!0,localStorage.setItem("activeTimer",JSON.stringify({startTime:this.startTime,sessionStartTime:this.sessionStartTime,currentActivity:t,currentSubcategory:this.currentSubcategory})),this.startTicking()},async stopTracking(){if(!this.startTime||!this.currentActivity)return;this.isRunning=!1,this.stopTicking();const t=new Date,n=Math.floor((t.getTime()-this.startTime.getTime())/1e3),i=this.getSettings().durationThreshold||15;n<i?window.Alpine.store("notifications").showInfo(`Entry discarded (${n}s < ${i}s threshold)`):await this.saveEntry(this.startTime,t,n,this.currentActivity,this.currentSubcategory),localStorage.removeItem("activeTimer"),this.reset()},reset(){this.startTime=null,this.sessionStartTime=null,this.elapsed=0,this.currentActivity=null,this.currentSubcategory=null,this.showSubcategoryPicker=!1,this.pendingSubcategoryEntry=null},startTicking(){this.updateElapsed(),this.interval=setInterval(()=>this.updateElapsed(),1e3)},stopTicking(){this.interval&&(clearInterval(this.interval),this.interval=null)},updateElapsed(){if(this.startTime){const t=this.startTime.getTime(),o=Date.now()-t;this.elapsed=Math.floor(o/1e3)}},getSettings(){try{const t=localStorage.getItem("appSettings");if(t)return JSON.parse(t)}catch(t){console.error("Error loading settings:",t)}return{durationThreshold:15}},async saveCurrentSession(){if(!this.currentActivity||!this.sessionStartTime)return;const t=new Date,n=Math.floor((t.getTime()-this.sessionStartTime.getTime())/1e3),i=this.getSettings().durationThreshold||15;n>=i&&await this.saveEntry(this.sessionStartTime,t,n,this.currentActivity,this.currentSubcategory)},async saveEntry(t,n,o,i,u){if(!i)return;const c=u?`${i.label}: ${u}`:i.label,d=Lt(t),h=Ft(n),m=Math.floor((h.getTime()-d.getTime())/1e3),T={description:c,startTime:d,endTime:h,rawStartTime:t,rawEndTime:n,duration:m,category:i.id,subcategory:u||void 0,projectId:i.id,tags:[i.id],syncStatus:"local",createdAt:new Date,updatedAt:new Date};try{const O=Oe();await _t.entries.add({...T,id:O}),window.dispatchEvent(new CustomEvent("entryAdded",{detail:{...T,id:O}})),o>=60&&window.Alpine.store("notifications").showSuccess(`Saved ${i.label} session (${this.formatTime(o)})`)}catch(O){console.error("Failed to save entry:",O),window.Alpine.store("notifications").showError("Failed to save time entry")}},async parseNaturalLanguage(){if(this.naturalInput.trim()&&!this.parsingInProgress){this.parsingInProgress=!0;try{const t=document.querySelector('[x-data*="activities"]');if(!t){window.Alpine.store("notifications").showError("Activities component not found");return}const n=window.Alpine.$data(t);if(!n?.activities){window.Alpine.store("notifications").showError("Activities not available for parsing");return}const i=await ol(n.activities).parseNaturalLanguage(this.naturalInput);let u=0;for(const c of i.entries)if(c.startTime&&c.endTime&&c.duration){const d=Lt(c.startTime),h=Ft(c.endTime),m=Math.floor((h.getTime()-d.getTime())/1e3),T={description:c.activity,startTime:d,endTime:h,rawStartTime:c.startTime,rawEndTime:c.endTime,duration:m,projectId:n.activities.find(O=>O.label===c.activity)?.id,tags:[c.activity],syncStatus:"local",createdAt:new Date,updatedAt:new Date};await ns.addEntryWithOverlapHandling(T),u++}if(i.failedLines.length===0)this.naturalInput="",window.Alpine.store("notifications").showSuccess(`✅ Added ${u} ${u===1?"entry":"entries"}`);else if(u===0)if(i.failedLines.length===0)window.Alpine.store("notifications").showWarning("No entries found in input");else{const c=i.failedLines.length===1?"Try: work 9-12, break 30min, or till 3pm meeting":"Check format for each entry";window.Alpine.store("notifications").showError(`❌ Could not parse ${i.failedLines.length} ${i.failedLines.length===1?"entry":"entries"}. ${c}`)}else this.naturalInput=i.failedLines.join(", "),u>=i.failedLines.length?window.Alpine.store("notifications").showSuccess(`✅ Added ${u} ${u===1?"entry":"entries"}. Please fix remaining ${i.failedLines.length} in input box`):window.Alpine.store("notifications").showWarning(`⚠️ Added ${u}, but ${i.failedLines.length} failed. Fix remaining entries in input box`)}catch(t){console.error("Failed to parse natural language:",t),window.Alpine.store("notifications").showError("Failed to parse natural language input")}finally{this.parsingInProgress=!1}}},formatTime(t){const n=Math.floor(t/3600),o=Math.floor(t%3600/60),i=t%60;return`${String(n).padStart(2,"0")}:${String(o).padStart(2,"0")}:${String(i).padStart(2,"0")}`},formatStartTime(){return this.startTime?this.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}});function ul(){return{entries:[],showFillGapModal:!1,showEditModal:!1,gapStart:null,gapEnd:null,gapNaturalInput:"",editingEntry:null,editStartTime:"",editEndTime:"",selectedPeriod:"today",customStartDate:"",customEndDate:"",async init(){await this.loadEntries(),this.$el.addEventListener("entryAdded",()=>this.loadEntries()),this.$el.addEventListener("entryUpdated",()=>this.loadEntries()),this.$el.addEventListener("entryDeleted",()=>this.loadEntries()),window.addEventListener("pageChanged",t=>{t.detail.page==="timeline"&&this.loadEntries()})},getDateRange(){const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(this.selectedPeriod){case"today":return{start:n,end:new Date(n.getTime()+1440*60*1e3)};case"week":const o=new Date(n);return o.setDate(n.getDate()-n.getDay()),{start:o,end:new Date(o.getTime()+10080*60*1e3)};case"2-weeks":const i=new Date(n);return i.setDate(n.getDate()-n.getDay()),i.setDate(i.getDate()-7),{start:i,end:new Date(i.getTime()+336*60*60*1e3)};case"custom":return this.customStartDate&&this.customEndDate?{start:new Date(this.customStartDate),end:new Date(new Date(this.customEndDate).getTime()+1440*60*1e3)}:{start:n,end:new Date(n.getTime()+1440*60*1e3)};default:return{start:n,end:new Date(n.getTime()+1440*60*1e3)}}},async loadEntries(){const t=this.getDateRange();this.entries=await _t.entries.where("startTime").between(t.start,t.end).and(n=>!n.deletedAt).toArray()},async loadTodayEntries(){await this.loadEntries()},async selectPeriod(t){this.selectedPeriod=t,await this.loadEntries()},async applyCustomDateRange(){this.customStartDate&&this.customEndDate&&(this.selectedPeriod="custom",await this.loadEntries())},get timelineItems(){const t=[],n=[...this.entries].sort((c,d)=>c.startTime.getTime()-d.startTime.getTime()),o=new Date;if(o.setHours(8,0,0,0),n.length===0){const c=new Date;return c>o&&t.push({type:"gap",start:o,end:c,duration:Math.floor((c.getTime()-o.getTime())/1e3),timeLabel:this.formatTime(o)}),t}let i=o;for(const c of n)c.startTime>i&&t.push({type:"gap",start:i,end:c.startTime,duration:Math.floor((c.startTime.getTime()-i.getTime())/1e3),timeLabel:this.formatTime(i)}),t.push({type:"entry",entry:c,timeLabel:this.formatTime(c.startTime)}),i=c.endTime||c.startTime;const u=new Date;return i<u&&t.push({type:"gap",start:i,end:u,duration:Math.floor((u.getTime()-i.getTime())/1e3),timeLabel:this.formatTime(i)}),t},get totalTime(){return this.entries.reduce((t,n)=>t+(n.duration||0),0)},get periodLabel(){switch(this.selectedPeriod){case"today":return"Today's";case"week":return"This Week's";case"2-weeks":return"Last 2 Weeks'";case"custom":return this.customStartDate&&this.customEndDate?`${new Date(this.customStartDate).toLocaleDateString()} - ${new Date(this.customEndDate).toLocaleDateString()}`:"Custom";default:return"Today's"}},get dateRangeText(){const t=this.getDateRange(),n=t.start.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),o=new Date(t.end.getTime()-1).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"});return this.selectedPeriod==="today"?n:`${n} - ${o}`},formatTime(t){return t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})},formatDuration(t){if(t<60)return`${t}s`;const n=Math.floor(t/60);if(n<60)return`${n}m`;const o=Math.floor(n/60),i=n%60;return i>0?`${o}h ${i}m`:`${o}h`},openFillGapModal(t){this.gapStart=t.start,this.gapEnd=t.end,this.gapNaturalInput="",this.showFillGapModal=!0},async fillGapWithActivity(t){if(!this.gapStart||!this.gapEnd)return;const n=Lt(this.gapStart),o=Ft(this.gapEnd),i=Math.floor((o.getTime()-n.getTime())/1e3),u={description:t.label,startTime:n,endTime:o,rawStartTime:this.gapStart,rawEndTime:this.gapEnd,duration:i,category:t.id,tags:[],syncStatus:"local",createdAt:new Date,updatedAt:new Date};await _t.entries.add(u),this.showFillGapModal=!1,await this.loadTodayEntries(),this.$el.dispatchEvent(new CustomEvent("entryAdded",{bubbles:!0}))},async fillGapNatural(){if(!this.gapNaturalInput.trim()||!this.gapStart||!this.gapEnd)return;const t=this.gapNaturalInput.trim(),n=this.$store?.activities;let o=null;if(n&&n.all&&(o=n.getByAlias?.(t)||n.all.find(i=>i.label.toLowerCase()===t.toLowerCase())),o)await this.fillGapWithActivity(o);else{const i=Lt(this.gapStart),u=Ft(this.gapEnd),c=Math.floor((u.getTime()-i.getTime())/1e3),d={description:t,startTime:i,endTime:u,rawStartTime:this.gapStart,rawEndTime:this.gapEnd,duration:c,tags:[],syncStatus:"local",createdAt:new Date,updatedAt:new Date};await _t.entries.add(d),this.showFillGapModal=!1,await this.loadTodayEntries(),this.$el.dispatchEvent(new CustomEvent("entryAdded",{bubbles:!0}))}},editEntry(t){this.editingEntry=t;const n=t.rawStartTime||t.startTime,o=t.rawEndTime||t.endTime;this.editStartTime=this.formatTime(n),this.editEndTime=o?this.formatTime(o):"",this.showEditModal=!0},async saveEntry(){if(!this.editingEntry)return;const[t,n]=this.editStartTime.split(":").map(Number),[o,i]=this.editEndTime.split(":").map(Number),u=new Date(this.editingEntry.startTime);u.setHours(t,n,0,0);const c=new Date(this.editingEntry.startTime);c.setHours(o,i,0,0),c<=u&&c.setDate(c.getDate()+1);const d=Lt(u),h=Ft(c),m=Math.floor((h.getTime()-d.getTime())/1e3),T={description:this.editingEntry.description,startTime:d,endTime:h,rawStartTime:u,rawEndTime:c,duration:m,projectId:this.editingEntry.projectId,tags:Array.isArray(this.editingEntry.tags)?[...this.editingEntry.tags]:[],category:this.editingEntry.category,subcategory:this.editingEntry.subcategory,syncStatus:"local",createdAt:new Date,updatedAt:new Date,prototypeId:this.editingEntry.id};await _t.entries.update(this.editingEntry.id,{deletedAt:new Date,updatedAt:new Date});const{overlapResolver:O}=await Ae(async()=>{const{overlapResolver:C}=await Promise.resolve().then(()=>al);return{overlapResolver:C}},void 0);await O.addEntryWithOverlapHandling(T),this.showEditModal=!1,await this.loadTodayEntries(),this.$el.dispatchEvent(new CustomEvent("entryUpdated",{bubbles:!0}))},async deleteEntry(){this.editingEntry?.id&&(await _t.entries.update(this.editingEntry.id,{deletedAt:new Date,updatedAt:new Date}),this.showEditModal=!1,await this.loadTodayEntries(),this.$el.dispatchEvent(new CustomEvent("entryDeleted",{bubbles:!0})))},getActivityColor(t){if(t.category){const n=this.$store?.activities;if(n?.all){const o=n.all.find(i=>i.id===t.category);if(o?.color)return o.color}try{const o=JSON.parse(localStorage.getItem("appSettings")||"{}");if(o.categories){const i=o.categories.find(u=>u.id===t.category);if(i?.color)return i.color}}catch{}}return"#6b7280"},getActivityIcon(t){if(t.category){const n=this.$store?.activities;if(n?.all)return n.all.find(i=>i.id===t.category)?.icon||"⏱️"}return"⏱️"},async exportTimeline(){if(this.entries.length===0){window.Alpine.store("notifications").showWarning("No entries to export");return}const t=this.generateTimelineReport(),n=`timetracker-timeline-${this.selectedPeriod}-${new Date().toISOString().split("T")[0]}.md`;await this.saveFileWithPicker(t,n,"text/markdown")},generateTimelineReport(){let t=`# Time Tracker Timeline - ${this.periodLabel.replace("'s","")} Report

`;if(t+=`**Generated:** ${new Date().toLocaleString()}
`,t+=`**Period:** ${this.dateRangeText}

`,t+=`## Summary

`,t+=`- **Total Time Tracked:** ${this.formatDuration(this.totalTime)}
`,t+=`- **Total Entries:** ${this.entries.length}
`,this.entries.length>0){const i=this.totalTime/this.entries.length;t+=`- **Average Entry Duration:** ${this.formatDuration(i)}
`}t+=`
`;const n=this.calculateActivityBreakdown();if(n.length>0){t+=`## Activity Breakdown

`;for(const i of n){const u=this.totalTime>0?(i.totalTime/this.totalTime*100).toFixed(1):"0";t+=`- **${i.icon} ${i.name}:** ${this.formatDuration(i.totalTime)} (${u}%) - ${i.count} ${i.count===1?"entry":"entries"}
`}t+=`
`}const o=this.groupEntriesByDay();for(const[i,u]of o){const c=u.reduce((h,m)=>h+(m.duration||0),0);t+=`## ${this.formatDateHeader(i)}

`,t+=`**Daily Total:** ${this.formatDuration(c)}

`;const d=[...u].sort((h,m)=>h.startTime.getTime()-m.startTime.getTime());for(const h of d){const m=this.formatTime(h.rawStartTime||h.startTime),T=h.rawEndTime||h.endTime?this.formatTime(h.rawEndTime||h.endTime):"ongoing",O=this.getActivityIcon(h),C=this.formatDuration(h.duration||0);t+=`- **${m} - ${T}:** ${O} ${h.description} _(${C})_
`}t+=`
`}return t+=`## Raw Data

`,t+=`Total entries exported: ${this.entries.length}
`,t+=`Export date: ${new Date().toISOString()}
`,t},calculateActivityBreakdown(){const t=new Map;for(const n of this.entries){const o=n.category||"unknown",i=n.duration||0,u=this.getActivityIcon(n),c=n.description.split(":")[0]||n.description;t.has(o)||t.set(o,{name:c,icon:u,totalTime:0,count:0});const d=t.get(o);d.totalTime+=i,d.count++}return Array.from(t.values()).sort((n,o)=>o.totalTime-n.totalTime)},groupEntriesByDay(){const t=new Map;for(const o of this.entries){const i=o.startTime.toDateString();t.has(i)||t.set(i,[]),t.get(i).push(o)}return new Map([...t.entries()].sort((o,i)=>new Date(o[0]).getTime()-new Date(i[0]).getTime()))},formatDateHeader(t){return new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},async saveFileWithPicker(t,n,o){try{const i=this.getSettings();if(!(i.defaultExportPath&&i.defaultExportHandle)){await this.promptForExportLocation(t,n,o);return}const c=await this.showExportLocationDialog(i.defaultExportPath,n);if(c==="default")try{const h=await(await i.defaultExportHandle.getFileHandle(n,{create:!0})).createWritable();await h.write(t),await h.close(),window.Alpine.store("notifications").showSuccess(`Timeline exported to ${i.defaultExportPath}/${n}`);return}catch(d){console.warn("Default directory failed, falling back to picker:",d),window.Alpine.store("notifications").showWarning("Default folder not accessible, showing file picker"),await this.promptForExportLocation(t,n,o);return}else if(c==="choose"){await this.promptForExportLocation(t,n,o);return}}catch(i){console.error("Export dialog failed:",i),await this.promptForExportLocation(t,n,o)}},async showExportLocationDialog(t,n){return new Promise(o=>{const i=document.createElement("div");i.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",i.innerHTML=`
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md mx-4 shadow-xl">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Export Location</h3>
          <p class="text-sm text-gray-600 dark:text-gray-400 mb-6">Where would you like to export <strong>${n}</strong>?</p>
          
          <div class="space-y-3 mb-6">
            <button id="exportDefault" class="w-full p-3 text-left border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
              <div class="font-medium text-gray-900 dark:text-white">📁 Default Folder</div>
              <div class="text-sm text-gray-500 dark:text-gray-400 truncate">${t}</div>
            </button>
            
            <button id="exportChoose" class="w-full p-3 text-left border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
              <div class="font-medium text-gray-900 dark:text-white">🎯 Choose Location</div>
              <div class="text-sm text-gray-500 dark:text-gray-400">Pick a different folder</div>
            </button>
          </div>
          
          <div class="flex justify-end gap-2">
            <button id="exportCancel" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">Cancel</button>
          </div>
        </div>
      `,document.body.appendChild(i);const u=()=>{document.body.removeChild(i)};i.querySelector("#exportDefault")?.addEventListener("click",()=>{u(),o("default")}),i.querySelector("#exportChoose")?.addEventListener("click",()=>{u(),o("choose")}),i.querySelector("#exportCancel")?.addEventListener("click",()=>{u(),o("cancel")}),i.addEventListener("click",c=>{c.target===i&&(u(),o("cancel"))})})},async promptForExportLocation(t,n,o){if("showSaveFilePicker"in window)try{const u=await(await window.showSaveFilePicker({suggestedName:n,types:[{description:o.includes("json")?"JSON files":"Markdown files",accept:{[o]:[`.${n.split(".").pop()}`]}}]})).createWritable();await u.write(t),await u.close(),window.Alpine.store("notifications").showSuccess(`Timeline exported as ${n}`)}catch(i){i.name!=="AbortError"&&(console.warn("File picker failed, falling back to download:",i),this.downloadFile(t,n,o))}else this.downloadFile(t,n,o)},downloadFile(t,n,o){const i=new Blob([t],{type:o}),u=URL.createObjectURL(i),c=document.createElement("a");c.href=u,c.download=n,c.click(),URL.revokeObjectURL(u)},getSettings(){try{const t=localStorage.getItem("appSettings");return t?JSON.parse(t):{}}catch(t){return console.error("Error loading settings:",t),{}}}}}const cl=()=>({entries:[],activities:[],loading:!1,selectedPeriod:"week",customStartDate:"",customEndDate:"",summary:null,activityStats:[],dailyStats:[],hourlyStats:[],selectedChart:"activities",async init(){await this.loadSettings(),await this.loadData()},async loadSettings(){try{const t=JSON.parse(localStorage.getItem("appSettings")||"{}");this.activities=t.categories||[]}catch(t){console.error("Failed to load settings:",t),this.activities=[]}},async loadData(){this.loading=!0;try{const t=this.getDateRange();this.entries=await _t.entries.where("startTime").between(t.start,t.end).and(n=>!n.deletedAt).toArray(),await this.calculateAnalytics()}catch(t){console.error("Failed to load insights data:",t)}finally{this.loading=!1}},getDateRange(){const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(this.selectedPeriod){case"today":return{start:n,end:new Date(n.getTime()+1440*60*1e3)};case"week":const o=new Date(n);return o.setDate(n.getDate()-n.getDay()),{start:o,end:new Date(o.getTime()+10080*60*1e3)};case"month":const i=new Date(n.getFullYear(),n.getMonth(),1),u=new Date(n.getFullYear(),n.getMonth()+1,1);return{start:i,end:u};case"custom":return this.customStartDate&&this.customEndDate?{start:new Date(this.customStartDate),end:new Date(new Date(this.customEndDate).getTime()+1440*60*1e3)}:this.getDateRange();default:return this.getDateRange()}},async calculateAnalytics(){if(!this.entries.length){this.resetAnalytics();return}this.activityStats=this.calculateActivityStats(),this.dailyStats=this.calculateDailyStats(),this.hourlyStats=this.calculateHourlyStats(),this.summary=this.calculateSummary()},resetAnalytics(){this.summary=null,this.activityStats=[],this.dailyStats=[],this.hourlyStats=[]},calculateActivityStats(){const t=new Map;for(const i of this.entries){const u=i.category||"unknown",c=i.duration||0;t.has(u)||t.set(u,{totalSeconds:0,sessions:[],entryCount:0});const d=t.get(u);d.totalSeconds+=c,d.sessions.push(c),d.entryCount++}const n=Array.from(t.values()).reduce((i,u)=>i+u.totalSeconds,0),o=[];for(const[i,u]of t){const c=this.activities.find(d=>d.id===i)||{label:i==="unknown"?"Unknown":i,icon:"❓",color:"#6b7280"};o.push({id:i,label:c.label,icon:c.icon,color:c.color,totalSeconds:u.totalSeconds,entryCount:u.entryCount,percentage:n>0?u.totalSeconds/n*100:0,avgSessionDuration:u.sessions.length>0?u.totalSeconds/u.sessions.length:0,longestSession:Math.max(...u.sessions,0),shortestSession:Math.min(...u.sessions,0)})}return o.sort((i,u)=>u.totalSeconds-i.totalSeconds)},calculateDailyStats(){const t=new Map;for(const o of this.entries){const i=o.startTime.toDateString(),u=o.category||"unknown",c=o.duration||0;t.has(i)||t.set(i,{totalSeconds:0,entryCount:0,activities:{}});const d=t.get(i);d.totalSeconds+=c,d.entryCount++,d.activities[u]=(d.activities[u]||0)+c}const n=Math.max(...Array.from(t.values()).map(o=>o.totalSeconds),1);return Array.from(t.entries()).map(([o,i])=>({date:o,totalSeconds:i.totalSeconds,entryCount:i.entryCount,activities:i.activities,productivity:i.totalSeconds/n})).sort((o,i)=>new Date(o.date).getTime()-new Date(i.date).getTime())},calculateHourlyStats(){const t=new Map;for(const n of this.entries){const o=n.startTime.getHours(),i=n.category||"unknown",u=n.duration||0;t.has(o)||t.set(o,{totalSeconds:0,activityBreakdown:{}});const c=t.get(o);c.totalSeconds+=u,c.activityBreakdown[i]=(c.activityBreakdown[i]||0)+u}return Array.from({length:24},(n,o)=>({hour:o,totalSeconds:t.get(o)?.totalSeconds||0,activityBreakdown:t.get(o)?.activityBreakdown||{}}))},calculateSummary(){const t=this.entries.reduce((C,$)=>C+($.duration||0),0),n=new Set(this.entries.map(C=>C.startTime.toDateString())).size,o=n>0?t/n:0,u=this.dailyStats.map(C=>({date:C.date,total:C.totalSeconds})).reduce((C,$)=>$.total>C.total?$:C,{date:"",total:0}).date,c=this.activityStats.length>0?this.activityStats[0].label:"None",d=this.dailyStats.sort((C,$)=>new Date(C.date).getTime()-new Date($.date).getTime());let h=0,m=0,T=0;const O=new Date().toDateString();for(let C=0;C<d.length;C++)C===0||new Date(d[C].date).getTime()-new Date(d[C-1].date).getTime()<=1440*60*1e3+36e5?(T++,(d[C].date===O||C===d.length-1)&&(h=T)):(m=Math.max(m,T),T=1);return m=Math.max(m,T),{totalTracked:t,totalDays:n,avgDailyTracking:o,mostProductiveDay:u,favoriteActivity:c,longestStreak:m,currentStreak:h}},async selectPeriod(t){this.selectedPeriod=t,await this.loadData()},async applyCustomDateRange(){this.customStartDate&&this.customEndDate&&(this.selectedPeriod="custom",await this.loadData())},selectChart(t){this.selectedChart=t},formatDuration(t){if(t<60)return`${Math.round(t)}s`;const n=Math.floor(t/60);if(n<60)return`${n}m`;const o=Math.floor(n/60),i=n%60;return i>0?`${o}h ${i}m`:`${o}h`},formatTime(t){const n=Math.floor(t/3600),o=Math.floor(t%3600/60);return`${n.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`},formatDate(t){return new Date(t).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},formatPercentage(t){return`${Math.round(t)}%`},get insights(){const t=[];if(!this.summary||!this.activityStats.length)return["Start tracking time to see insights"];this.summary.avgDailyTracking>4*3600?t.push("🎯 Great consistency! You're averaging over 4 hours of tracked time per day"):this.summary.avgDailyTracking<2*3600&&t.push("📈 Try tracking more activities to get better insights into your time usage");const n=this.activityStats[0];n.percentage>60?t.push(`⚖️ You spend ${Math.round(n.percentage)}% of your time on ${n.label} - consider diversifying`):n.percentage<25&&this.activityStats.length>1&&t.push("🔄 Your time is well-distributed across multiple activities");const o=n.avgSessionDuration;o>2*3600?t.push("⏰ Your sessions tend to be long - consider taking breaks for better focus"):o<1800&&t.push("🎯 Your sessions are short - this can be great for maintaining focus"),this.summary.currentStreak>=7?t.push(`🔥 Amazing! You're on a ${this.summary.currentStreak}-day tracking streak!`):this.summary.currentStreak>=3&&t.push(`✨ Good momentum! ${this.summary.currentStreak} days tracked in a row`);const i=this.hourlyStats.slice(9,17).reduce((d,h)=>d+h.totalSeconds,0),u=this.hourlyStats.reduce((d,h)=>d+h.totalSeconds,0),c=u>0?i/u:0;return c>.8?t.push("🏢 Most of your tracked time is during standard working hours"):c<.4&&t.push("🌙 You do a lot of work outside standard business hours"),t.slice(0,4)},async exportInsights(){if(!this.summary){window.Alpine.store("notifications").showError("No data to export");return}const t=this.selectedPeriod==="custom"&&this.customStartDate&&this.customEndDate?`${this.customStartDate} to ${this.customEndDate}`:this.selectedPeriod.charAt(0).toUpperCase()+this.selectedPeriod.slice(1),n=this.generateInsightsReport(t);await this.saveFileWithPicker(n,`timetracker-insights-${this.selectedPeriod}-${new Date().toISOString().split("T")[0]}.md`,"text/markdown")},generateInsightsReport(t){const n=t,o=this.getDateRange();let i=`# Time Tracking Insights - ${n}

`;if(i+=`**Generated:** ${new Date().toLocaleString()}
`,i+=`**Period:** ${o.start.toLocaleDateString()} - ${o.end.toLocaleDateString()}

`,this.summary&&(i+=`## Summary

`,i+=`- **Total Time Tracked:** ${this.formatDuration(this.summary.totalTracked)}
`,i+=`- **Days with Activity:** ${this.summary.totalDays}
`,i+=`- **Average per Day:** ${this.formatDuration(this.summary.avgDailyTracking)}
`,i+=`- **Current Streak:** ${this.summary.currentStreak} days
`,i+=`- **Longest Streak:** ${this.summary.longestStreak} days
`,i+=`- **Favorite Activity:** ${this.summary.favoriteActivity}
`,this.summary.mostProductiveDay&&(i+=`- **Most Productive Day:** ${this.formatDate(this.summary.mostProductiveDay)}
`),i+=`
`),this.activityStats.length>0){i+=`## Activity Breakdown

`;for(const c of this.activityStats)i+=`### ${c.icon} ${c.label}
`,i+=`- **Total Time:** ${this.formatDuration(c.totalSeconds)} (${this.formatPercentage(c.percentage)})
`,i+=`- **Sessions:** ${c.entryCount}
`,i+=`- **Average Session:** ${this.formatDuration(c.avgSessionDuration)}
`,i+=`- **Longest Session:** ${this.formatDuration(c.longestSession)}
`,i+=`- **Shortest Session:** ${this.formatDuration(c.shortestSession)}

`}if(this.dailyStats.length>0){i+=`## Daily Patterns

`;const c=[...this.dailyStats].sort((d,h)=>new Date(d.date).getTime()-new Date(h.date).getTime());for(const d of c){const h=Math.round(d.productivity*100);i+=`- **${this.formatDate(d.date)}:** ${this.formatDuration(d.totalSeconds)} (${d.entryCount} sessions, ${h}% productivity)
`}i+=`
`}if(this.hourlyStats.length>0){const c=this.hourlyStats.filter(d=>d.totalSeconds>0);if(c.length>0){i+=`## Time Distribution

`,i+=`### Most Active Hours

`;const d=[...c].sort((T,O)=>O.totalSeconds-T.totalSeconds).slice(0,5);for(const T of d){const O=`${T.hour.toString().padStart(2,"0")}:00`,C=this.summary?(T.totalSeconds/this.summary.totalTracked*100).toFixed(1):"0";i+=`- **${O}:** ${this.formatDuration(T.totalSeconds)} (${C}%)
`}i+=`
`;const h=this.hourlyStats.slice(9,17).reduce((T,O)=>T+O.totalSeconds,0),m=this.hourlyStats.reduce((T,O)=>T+O.totalSeconds,0);if(m>0){const T=(h/m*100).toFixed(1);i+=`### Working Hours Analysis

`,i+=`- **9 AM - 5 PM:** ${this.formatDuration(h)} (${T}% of total)
`,i+=`- **Outside Hours:** ${this.formatDuration(m-h)} (${(100-parseFloat(T)).toFixed(1)}% of total)

`}}}const u=this.insights;if(u.length>0){i+=`## Key Insights

`;for(const c of u)i+=`- ${c}
`;i+=`
`}if(this.dailyStats.length>1){i+=`## Productivity Analysis

`;const c=this.dailyStats.reduce((h,m)=>h+m.productivity,0)/this.dailyStats.length,d=[...this.dailyStats].sort((h,m)=>m.productivity-h.productivity).slice(0,3);i+=`- **Average Daily Productivity:** ${Math.round(c*100)}%
`,i+=`- **Most Productive Days:**
`;for(const h of d)i+=`  - ${this.formatDate(h.date)}: ${Math.round(h.productivity*100)}% (${this.formatDuration(h.totalSeconds)})
`;i+=`
`}return i+=`## Data Summary

`,i+=`- **Total Entries:** ${this.entries.length}
`,i+=`- **Date Range:** ${o.start.toDateString()} to ${o.end.toDateString()}
`,i+=`- **Export Date:** ${new Date().toISOString()}
`,i+=`- **Period Type:** ${this.selectedPeriod}
`,i},async saveFileWithPicker(t,n,o){try{const i=this.getSettings();if(!(i.defaultExportPath&&i.defaultExportHandle)){await this.promptForExportLocation(t,n,o);return}const c=await this.showExportLocationDialog(i.defaultExportPath,n);if(c==="default")try{const h=await(await i.defaultExportHandle.getFileHandle(n,{create:!0})).createWritable();await h.write(t),await h.close(),window.Alpine.store("notifications").showSuccess(`Insights exported to ${i.defaultExportPath}/${n}`);return}catch(d){console.warn("Default directory failed, falling back to picker:",d),window.Alpine.store("notifications").showWarning("Default folder not accessible, showing file picker"),await this.promptForExportLocation(t,n,o);return}else if(c==="choose"){await this.promptForExportLocation(t,n,o);return}}catch(i){console.error("Export dialog failed:",i),await this.promptForExportLocation(t,n,o)}},async showExportLocationDialog(t,n){return new Promise(o=>{const i=document.createElement("div");i.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",i.innerHTML=`
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md mx-4 shadow-xl">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Export Location</h3>
          <p class="text-sm text-gray-600 dark:text-gray-400 mb-6">Where would you like to export <strong>${n}</strong>?</p>
          
          <div class="space-y-3 mb-6">
            <button id="exportDefault" class="w-full p-3 text-left border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
              <div class="font-medium text-gray-900 dark:text-white">📁 Default Folder</div>
              <div class="text-sm text-gray-500 dark:text-gray-400 truncate">${t}</div>
            </button>
            
            <button id="exportChoose" class="w-full p-3 text-left border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
              <div class="font-medium text-gray-900 dark:text-white">🎯 Choose Location</div>
              <div class="text-sm text-gray-500 dark:text-gray-400">Pick a different folder</div>
            </button>
          </div>
          
          <div class="flex justify-end gap-2">
            <button id="exportCancel" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">Cancel</button>
          </div>
        </div>
      `,document.body.appendChild(i);const u=()=>{document.body.removeChild(i)};i.querySelector("#exportDefault")?.addEventListener("click",()=>{u(),o("default")}),i.querySelector("#exportChoose")?.addEventListener("click",()=>{u(),o("choose")}),i.querySelector("#exportCancel")?.addEventListener("click",()=>{u(),o("cancel")}),i.addEventListener("click",c=>{c.target===i&&(u(),o("cancel"))})})},async promptForExportLocation(t,n,o){if("showSaveFilePicker"in window)try{const u=await(await window.showSaveFilePicker({suggestedName:n,types:[{description:o.includes("json")?"JSON files":"Markdown files",accept:{[o]:[`.${n.split(".").pop()}`]}}]})).createWritable();await u.write(t),await u.close(),window.Alpine.store("notifications").showSuccess(`Insights exported as ${n}`)}catch(i){i.name!=="AbortError"&&(console.warn("File picker failed, falling back to download:",i),this.downloadFile(t,n,o))}else this.downloadFile(t,n,o)},getSettings(){try{const t=localStorage.getItem("appSettings");return t?JSON.parse(t):{}}catch(t){return console.error("Error loading settings:",t),{}}},downloadFile(t,n,o){const i=new Blob([t],{type:o}),u=URL.createObjectURL(i),c=document.createElement("a");c.href=u,c.download=n,c.click(),URL.revokeObjectURL(u)}}),Qr=150,Ko=300,ll=[{value:2,label:"2s"},{value:5,label:"5s"},{value:10,label:"10s"},{value:15,label:"15s"},{value:20,label:"20s"},{value:30,label:"30s"},{value:60,label:"1m"},{value:90,label:"1.5m"},{value:120,label:"2m"},{value:150,label:"2.5m"},{value:180,label:"3m"},{value:300,label:"5m"},{value:600,label:"10m"},{value:900,label:"15m"}],dl=[{value:null,label:"Inherit default (12h)"},{value:0,label:"Unlimited"},{value:1,label:"1 hour"},{value:2,label:"2 hours"},{value:4,label:"4 hours"},{value:8,label:"8 hours"},{value:12,label:"12 hours"},{value:16,label:"16 hours"},{value:20,label:"20 hours"},{value:24,label:"24 hours"}],fl=[{value:null,label:"Default (no rounding)"},{value:0,label:"No rounding"},{value:1,label:"Round to seconds"},{value:30,label:"Snap to 30s slots (0s, 30s)"},{value:60,label:"Snap to minutes"},{value:300,label:"Snap to 5min slots"},{value:600,label:"Snap to 10min slots"},{value:900,label:"Snap to 15min slots"},{value:1200,label:"Snap to 20min slots"},{value:1500,label:"Snap to 25/30min slots"},{value:1800,label:"Snap to 30min slots"},{value:2700,label:"Snap to 45min slots"},{value:3300,label:"Snap to 55min slots"},{value:3600,label:"Snap to hours"}],hl=[{name:"Professional",description:"Work-focused categories with meetings and breaks",categories:[{id:"work",label:"Work",icon:"💼",color:"#6366f1",subcategories:["coding","planning","research","review"],subcategoriesText:"coding, planning, research, review",maxDuration:null},{id:"meeting",label:"Meeting",icon:"👥",color:"#f59e0b",subcategories:["standup","meeting planning","meeting review","call"],subcategoriesText:"standup, meeting planning, meeting review, call",maxDuration:null},{id:"break",label:"Break",icon:"☕",color:"#10b981",subcategories:["lunch","coffee","rest"],subcategoriesText:"lunch, coffee, rest",maxDuration:null},{id:"admin",label:"Admin",icon:"📋",color:"#8b5cf6",subcategories:["email","scheduling","documentation"],subcategoriesText:"email, scheduling, documentation",maxDuration:null}]},{name:"Personal Life",description:"Life balance with work, personal, and health activities",categories:[{id:"work",label:"Work",icon:"💼",color:"#6366f1",subcategories:["focused work","meetings","work admin"],subcategoriesText:"focused work, meetings, work admin",maxDuration:null},{id:"personal",label:"Personal",icon:"🏠",color:"#ec4899",subcategories:["life planning","personal reading","family","hobbies"],subcategoriesText:"life planning, personal reading, family, hobbies",maxDuration:null},{id:"health",label:"Health",icon:"🏃",color:"#06b6d4",subcategories:["exercise","meditation","meal prep"],subcategoriesText:"exercise, meditation, meal prep",maxDuration:null},{id:"break",label:"Break",icon:"☕",color:"#10b981",subcategories:["personal lunch","personal rest","social"],subcategoriesText:"personal lunch, personal rest, social",maxDuration:null}]},{name:"Student",description:"Study-focused with classes, homework, and breaks",categories:[{id:"study",label:"Study",icon:"📚",color:"#6366f1",subcategories:["study reading","notes","practice","study research"],subcategoriesText:"study reading, notes, practice, study research",maxDuration:null},{id:"class",label:"Class",icon:"🎓",color:"#f59e0b",subcategories:["lecture","lab","seminar","discussion"],subcategoriesText:"lecture, lab, seminar, discussion",maxDuration:null},{id:"assignment",label:"Assignment",icon:"✍️",color:"#ef4444",subcategories:["homework","project","essay","presentation"],subcategoriesText:"homework, project, essay, presentation",maxDuration:null},{id:"break",label:"Break",icon:"☕",color:"#10b981",subcategories:["student lunch","student rest","student social","exercise"],subcategoriesText:"student lunch, student rest, student social, exercise",maxDuration:null}]}],pl=()=>({durationThreshold:Qr,timeRounding:Ko,thresholdOptions:ll,maxDurationOptions:dl,timeRoundingOptions:fl,exportStartDate:"",exportEndDate:"",exportFormat:"json",exportCompression:"none",defaultExportPath:"",defaultExportHandle:null,categories:[],showAdvanced:!1,currentPreset:"Professional",settingsSnapshot:null,justSaved:!1,presets:hl,getThresholdLabel(){const t=this.thresholdOptions.find(n=>n.value===this.durationThreshold);return t?t.label:`${this.durationThreshold}s`},getMaxDurationLabel(t){if(t.maxDuration===null)return"Inherit default";if(t.maxDuration===0)return"Unlimited";const n=this.maxDurationOptions.find(o=>o.value===t.maxDuration);return n?n.label:`${t.maxDuration} hours`},getTimeRoundingLabel(){const t=this.timeRoundingOptions.find(n=>n.value===this.timeRounding);return t?t.label:"Custom"},getTimeRoundingSetting(){return this.timeRounding},init(){this.loadSettings(),this.createSnapshot(),this.watchForChanges()},createSnapshot(){this.settingsSnapshot={durationThreshold:this.durationThreshold,categories:JSON.parse(JSON.stringify(this.categories)),currentPreset:this.currentPreset}},watchForChanges(){this.$watch("durationThreshold",()=>this.autoSave()),this.$watch("categories",()=>this.autoSave(),{deep:!0})},autoSave(){const t=this.validateCategories();if(!t.isValid){window.Alpine.store("notifications").showError(t.message),this.cancelChanges();return}this.currentPreset=this.detectCurrentPreset(),this.saveSettings(!1),this.justSaved=!0,setTimeout(()=>{this.justSaved=!1},1500)},detectCurrentPreset(){for(const t of this.presets)if(this.categoriesMatchPreset(t))return t.name;return"Custom"},categoriesMatchPreset(t){return this.categories.length!==t.categories.length?!1:this.categories.every(n=>{const o=t.categories.find(i=>i.id===n.id);return o?n.label===o.label&&n.icon===o.icon&&n.color===o.color&&JSON.stringify(n.subcategories)===JSON.stringify(o.subcategories):!1})},loadSettings(){try{const t=localStorage.getItem("appSettings");if(t){const n=JSON.parse(t);this.durationThreshold=n.durationThreshold??Qr,this.timeRounding=n.timeRounding??Ko,this.categories=n.categories??this.getDefaultCategories(),this.categories.forEach(o=>{o.maxDuration===void 0&&(o.maxDuration=null),delete o.subcategoryBehavior,delete o.defaultSubcategory,delete o.lastUsedSubcategory}),this.currentPreset=this.detectCurrentPreset()}else this.applyPreset(this.presets[0])}catch(t){console.error("Error loading settings:",t),this.resetToDefaults()}},getDefaultCategories(){return JSON.parse(JSON.stringify(this.presets[0].categories))},applyPreset(t){this.categories=JSON.parse(JSON.stringify(t.categories)),this.currentPreset=t.name,this.showAdvanced=!1,this.createSnapshot(),this.saveSettings(!1),this.notifyActivitiesUpdate(),this.justSaved=!0,setTimeout(()=>{this.justSaved=!1},2e3)},addCategory(){const t={id:`custom_${Date.now()}`,label:"New Category",icon:"🔧",color:"#6b7280",subcategories:[],subcategoriesText:"",maxDuration:null};this.categories.push(t)},removeCategory(t){if(this.categories.length<=1){window.Alpine.store("notifications").showWarning("You must have at least one category");return}this.categories.splice(t,1)},toggleSubcategories(t){const n=this.categories.find(o=>o.id===t);n&&(n.showSub=!n.showSub)},updateSubcategories(t){const n=t.subcategoriesText.split(",").map(c=>c.trim().toLowerCase()).filter(c=>c.length>0),o=this.findDuplicateSubcategories(t.id,n),i=this.findCategoryNameConflicts(n),u=[...o,...i];if(u.length>0){const c=u.map(h=>h.type==="duplicate"?`"${h.name}" (already in ${h.categoryLabel})`:`"${h.name}" (matches category name)`).join(", ");window.Alpine.store("notifications").showError(`Invalid subcategories: ${c}. Subcategory names cannot match category names or be duplicated across categories.`);const d=n.filter(h=>!u.some(m=>m.name===h));t.subcategories=d,t.subcategoriesText=d.join(", ")}else t.subcategories=n},findDuplicateSubcategories(t,n){const o=[];for(const i of n)for(const u of this.categories)if(u.id!==t&&u.subcategories.map(d=>d.toLowerCase()).includes(i.toLowerCase())){o.push({name:i,categoryLabel:u.label,type:"duplicate"});break}return o},findCategoryNameConflicts(t){const n=[];for(const o of t)for(const i of this.categories)if(i.label.toLowerCase()===o.toLowerCase()){n.push({name:o,type:"category"});break}return n},validateCategories(){for(const o of this.categories)for(const i of this.categories)if(o.id!==i.id&&i.subcategories.map(c=>c.toLowerCase()).includes(o.label.toLowerCase()))return{isValid:!1,message:`Category name "${o.label}" conflicts with existing subcategory in ${i.label}. Category names cannot match any subcategory names.`};return this.categories.map(o=>o.label.toLowerCase()).filter((o,i,u)=>u.indexOf(o)!==i&&u.indexOf(o)!==-1).length>0?{isValid:!1,message:"Duplicate category names found. Each category must have a unique name."}:{isValid:!0,message:""}},saveSettings(t=!0){try{const n={durationThreshold:this.durationThreshold,timeRounding:this.timeRounding,categories:this.categories,currentPreset:this.currentPreset,savedAt:new Date().toISOString()};localStorage.setItem("appSettings",JSON.stringify(n)),this.notifyActivitiesUpdate(),t&&window.Alpine.store("notifications").showSuccess("Settings saved successfully")}catch(n){console.error("Error saving settings:",n),t&&window.Alpine.store("notifications").showError("Failed to save settings")}},cancelChanges(){this.settingsSnapshot&&(this.durationThreshold=this.settingsSnapshot.durationThreshold,this.categories=JSON.parse(JSON.stringify(this.settingsSnapshot.categories)),this.currentPreset=this.settingsSnapshot.currentPreset,this.saveSettings(!1),this.notifyActivitiesUpdate(),this.justSaved=!0,setTimeout(()=>{this.justSaved=!1},1500))},hasChanges(){return this.settingsSnapshot?this.durationThreshold!==this.settingsSnapshot.durationThreshold||JSON.stringify(this.categories)!==JSON.stringify(this.settingsSnapshot.categories):!1},resetToDefaults(){this.durationThreshold=Qr,this.categories=JSON.parse(JSON.stringify(this.presets[0].categories)),this.currentPreset=this.presets[0].name,this.showAdvanced=!1,this.createSnapshot(),this.saveSettings(!1),this.notifyActivitiesUpdate(),this.justSaved=!0,setTimeout(()=>{this.justSaved=!1},2e3)},notifyActivitiesUpdate(){window.dispatchEvent(new CustomEvent("activities-updated",{detail:{categories:this.categories,durationThreshold:this.durationThreshold}}))},async exportData(){try{const{db:t}=await Ae(async()=>{const{db:m}=await Promise.resolve().then(()=>yi);return{db:m}},void 0);let n=null,o=null;this.exportStartDate&&(n=new Date(this.exportStartDate),n.setHours(0,0,0,0)),this.exportEndDate&&(o=new Date(this.exportEndDate),o.setHours(23,59,59,999));let i=t.entries.orderBy("startTime");n&&o?i=i.and(m=>!m.deletedAt&&m.startTime>=n&&m.startTime<=o):n?i=i.and(m=>!m.deletedAt&&m.startTime>=n):o?i=i.and(m=>!m.deletedAt&&m.startTime<=o):i=i.and(m=>!m.deletedAt);const u=await i.toArray();if(u.length===0){window.Alpine.store("notifications").showWarning("No entries found for selected date range");return}let c,d,h;this.exportFormat==="json"?(c=await this.generateJSONExport(u),d=this.generateFilename("json"),h="application/json"):(c=await this.generateMarkdownExport(u),d=this.generateFilename("md"),h="text/markdown"),await this.saveFileWithPicker(c,d,h)}catch(t){console.error("Export failed:",t),window.Alpine.store("notifications").showError("Failed to export data")}},async generateJSONExport(t){const{db:n}=await Ae(async()=>{const{db:u}=await Promise.resolve().then(()=>yi);return{db:u}},void 0),o=await n.projects.toArray(),i={metadata:{exportDate:new Date().toISOString(),version:"2.0",appName:"Pragmatic Focus Time Tracker",dateRange:{start:this.exportStartDate||null,end:this.exportEndDate||null},totalEntries:t.length},entries:t,projects:o,settings:{categories:this.categories,durationThreshold:this.durationThreshold}};return JSON.stringify(i,null,2)},async generateMarkdownExport(t){const n={};t.forEach(h=>{const m=h.startTime.toDateString();n[m]||(n[m]=[]),n[m].push(h)});const o=this.getDateRangeString();let i=`# Time Tracking Export${o?` - ${o}`:""}

`;i+=`**Export Date:** ${new Date().toDateString()}
`,i+=`**Total Days:** ${Object.keys(n).length}
`,i+=`**Total Entries:** ${t.length}
`,(this.exportStartDate||this.exportEndDate)&&(i+=`**Date Range:** ${this.exportStartDate||"Beginning"} to ${this.exportEndDate||"End"}
`),i+=`
`;const u=t.reduce((h,m)=>h+(m.duration||0),0);i+=`## Overall Summary
`,i+=`- **Total Tracked Time:** ${this.formatDuration(u)}
`,i+=`- **Average per Day:** ${this.formatDuration(Math.round(u/Object.keys(n).length))}

`;const c={};t.forEach(h=>{let m="unknown",T="";h.category?(m=h.category,T=h.subcategory||this.categories.find(C=>C.id===h.category)?.label||h.category):(m="unknown",T="Unknown"),c[m]||(c[m]={total:0,subcategories:{}});const O=h.duration||0;c[m].total+=O,c[m].subcategories[T]=(c[m].subcategories[T]||0)+O}),i+=`## Overall Activity Breakdown
`;for(const h of this.categories){const m=c[h.id];if(m&&m.total>0){const T=(m.total/u*100).toFixed(1);i+=`- ${h.icon} **${h.label}**: ${this.formatDuration(m.total)} (${T}%)
`;const O=Object.entries(m.subcategories);if(O.length>1||O.length===1&&O[0][0]!==h.label)for(const[C,$]of O){const q=($/u*100).toFixed(1);i+=`  - ${C}: ${this.formatDuration($)} (${q}%)
`}}}if(c.unknown&&c.unknown.total>0){const h=(c.unknown.total/u*100).toFixed(1);i+=`- ❓ **Unknown**: ${this.formatDuration(c.unknown.total)} (${h}%)
`;const m=Object.entries(c.unknown.subcategories);if(m.length>1||m.length===1&&m[0][0]!=="Unknown")for(const[T,O]of m){const C=(O/u*100).toFixed(1);i+=`  - ${T}: ${this.formatDuration(O)} (${C}%)
`}}i+=`
---

`;const d=Object.keys(n).sort((h,m)=>new Date(m).getTime()-new Date(h).getTime());for(const h of d){const m=n[h],T=m.reduce(($,q)=>$+(q.duration||0),0);i+=`## ${h}
`,i+=`**Total:** ${this.formatDuration(T)} • **Entries:** ${m.length}

`;const O={};m.forEach($=>{let q="unknown",z="";$.category?(q=$.category,z=$.subcategory||this.categories.find(H=>H.id===$.category)?.label||$.category):(q="unknown",z="Unknown"),O[q]||(O[q]={total:0,subcategories:{}});const et=$.duration||0;O[q].total+=et,O[q].subcategories[z]=(O[q].subcategories[z]||0)+et}),i+=`### Activities
`;for(const $ of this.categories){const q=O[$.id];if(q&&q.total>0){i+=`- ${$.icon} ${$.label}: ${this.formatDuration(q.total)}
`;const z=Object.entries(q.subcategories);if(z.length>1||z.length===1&&z[0][0]!==$.label)for(const[et,H]of z)i+=`  - ${et}: ${this.formatDuration(H)}
`}}if(O.unknown&&O.unknown.total>0){i+=`- ❓ Unknown: ${this.formatDuration(O.unknown.total)}
`;const $=Object.entries(O.unknown.subcategories);if($.length>1||$.length===1&&$[0][0]!=="Unknown")for(const[q,z]of $)i+=`  - ${q}: ${this.formatDuration(z)}
`}i+=`
### Timeline
`;const C=m.sort(($,q)=>$.startTime.getTime()-q.startTime.getTime());for(const $ of C){const q=this.formatTime($.startTime),z=$.endTime?this.formatTime($.endTime):"ongoing";let et="Unknown";if($.category){const Y=this.categories.find(Z=>Z.id===$.category);Y&&(et=`${Y.icon} ${Y.label}`,$.subcategory&&(et+=` (${$.subcategory})`))}else if($.description){const Y=$.description.toLowerCase();let Z=!1;for(const ot of this.categories)if(Y===ot.label.toLowerCase()||ot.subcategories?.some(lt=>Y===lt.toLowerCase())||Y.includes(ot.label.toLowerCase())){et=`${ot.icon} ${$.description}`,Z=!0;break}Z||(et=$.description)}const H=this.formatDuration($.duration||0);i+=`- ${q} - ${z}: ${et} (${H})
`}i+=`
`}return i},generateFilename(t){const n=new Date().toISOString().split("T")[0],o=this.getDateRangeString();return`${o?`timetracker-${o}`:`timetracker-export-${n}`}.${t}`},async chooseExportDirectory(){try{if(!("showDirectoryPicker"in window)){window.Alpine.store("notifications").showError("Directory picker not supported in this browser. Files will download to default location.");return}const t=await window.showDirectoryPicker({id:"timetracker-export-dir",mode:"readwrite"});this.defaultExportHandle=t,this.defaultExportPath=t.name,this.saveSettings(),window.Alpine.store("notifications").showSuccess(`Default export directory set to: ${t.name}`)}catch(t){t.name!=="AbortError"&&(console.error("Failed to choose directory:",t),window.Alpine.store("notifications").showError("Failed to choose export directory"))}},clearExportDirectory(){this.defaultExportPath="",this.defaultExportHandle=null,this.saveSettings(),window.Alpine.store("notifications").showSuccess("Default export directory cleared")},async saveFileWithPicker(t,n,o){try{if(this.defaultExportHandle&&"showSaveFilePicker"in window)try{const u=await(await this.defaultExportHandle.getFileHandle(n,{create:!0})).createWritable();await u.write(t),await u.close(),window.Alpine.store("notifications").showSuccess(`File saved to ${this.defaultExportPath}/${n}`);return}catch(i){console.warn("Failed to save to default directory, falling back to picker:",i)}if("showSaveFilePicker"in window)try{const u=await(await window.showSaveFilePicker({suggestedName:n,types:[{description:o.includes("json")?"JSON files":"Markdown files",accept:{[o]:[`.${n.split(".").pop()}`]}}]})).createWritable();await u.write(t),await u.close(),window.Alpine.store("notifications").showSuccess(`File saved as ${n}`)}catch(i){i.name!=="AbortError"&&(console.warn("File picker failed, falling back to download:",i),this.downloadFile(t,n,o))}else this.downloadFile(t,n,o)}catch(i){console.error("File saving failed:",i),window.Alpine.store("notifications").showError("Failed to save file")}},getDateRangeString(){return this.exportStartDate&&this.exportEndDate?`${this.exportStartDate}_to_${this.exportEndDate}`:this.exportStartDate?`from_${this.exportStartDate}`:this.exportEndDate?`until_${this.exportEndDate}`:""},async downloadFile(t,n,o){let i=t,u=n,c=o;if(this.exportCompression==="zip")try{const C=(await Ae(async()=>{const{default:q}=await import("./jszip.min-JMtoijQ0.js").then(z=>z.j);return{default:q}},[])).default,$=new C;$.file(n,t),i=await $.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:6}}),u=n.replace(/\.(json|md)$/,".zip"),c="application/zip"}catch(C){console.error("ZIP compression failed:",C),window.Alpine.store("notifications").showError("ZIP compression failed - downloading uncompressed")}else if(this.exportCompression==="gzip")try{const $=(await Ae(()=>import("./pako.esm-CMINtMsn.js"),[])).gzip(t);i=new Uint8Array($),u=n+".gz",c="application/gzip"}catch(C){console.error("GZIP compression failed:",C),window.Alpine.store("notifications").showError("GZIP compression failed - downloading uncompressed")}const d=new Blob([i],{type:c}),h=URL.createObjectURL(d),m=document.createElement("a");m.href=h,m.download=u,m.click(),URL.revokeObjectURL(h);const T=this.exportFormat.toUpperCase(),O=this.exportCompression!=="none"?` (${this.exportCompression.toUpperCase()})`:"";window.Alpine.store("notifications").showSuccess(`Data exported as ${T}${O}`)},formatTime(t){return t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},formatDuration(t){if(t<60)return`${t}s`;const n=Math.floor(t/60);if(n<60)return`${n}m`;const o=Math.floor(n/60),i=n%60;return i>0?`${o}h ${i}m`:`${o}h`}});let Bo=!1;const gl=()=>({notifications:[],init(){if(Bo)return;Bo=!0;const t=n=>{const o=n,{type:i,message:u,importance:c="medium"}=o.detail;this.show(i,u,c)};window.addEventListener("show-notification",t)},show(t,n,o="medium",i){const u={id:crypto.randomUUID(),type:t,message:n,timestamp:new Date,importance:o,duration:i};this.notifications.push(u);const c=i??this.getAutoDuration(t,o);setTimeout(()=>{this.remove(u.id)},c)},showError(t,n="high"){this.show("error",t,n)},showSuccess(t,n="medium"){this.show("success",t,n)},showWarning(t,n="medium"){this.show("warning",t,n)},showInfo(t,n="low"){this.show("info",t,n)},get visibleNotifications(){return this.notifications.filter(t=>t.importance==="medium"||t.importance==="high"||t.importance==="critical")},getAutoDuration(t,n){return n==="critical"?8e3:n==="high"?6e3:n==="medium"?4e3:t==="success"?2e3:3e3},remove(t){this.notifications=this.notifications.filter(n=>n.id!==t)},clear(){this.notifications=[]},getTypeIcon(t){switch(t){case"success":return"✓";case"error":return"×";case"warning":return"!";case"info":return"i";default:return"i"}},getTypeClasses(t){switch(t){case"success":return"border-green-200 bg-green-50/50 text-green-700 dark:border-green-800 dark:bg-green-950/30 dark:text-green-300";case"error":return"border-red-200 bg-red-50/50 text-red-700 dark:border-red-800 dark:bg-red-950/30 dark:text-red-300";case"warning":return"border-yellow-200 bg-yellow-50/50 text-yellow-700 dark:border-yellow-800 dark:bg-yellow-950/30 dark:text-yellow-300";case"info":return"border-blue-200 bg-blue-50/50 text-blue-700 dark:border-blue-800 dark:bg-blue-950/30 dark:text-blue-300";default:return"border-gray-200 bg-gray-50/50 text-gray-600 dark:border-gray-700 dark:bg-gray-900/30 dark:text-gray-400"}}});window.Alpine=At;function ml(){const t=localStorage.getItem("theme");return t==="light"||t==="dark"?t:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}At.store("theme",{theme:ml(),init(){this.apply(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",n=>{localStorage.getItem("theme")||(this.theme=n.matches?"dark":"light",this.apply())})},set(t){this.theme=t,localStorage.setItem("theme",t),this.apply()},toggle(){this.set(this.theme==="dark"?"light":"dark")},apply(){document.documentElement.classList.toggle("dark",this.theme==="dark")}});At.store("notifications",{showError(t,n="high"){window.dispatchEvent(new CustomEvent("show-notification",{detail:{type:"error",message:t,importance:n}}))},showSuccess(t,n="medium"){window.dispatchEvent(new CustomEvent("show-notification",{detail:{type:"success",message:t,importance:n}}))},showWarning(t,n="medium"){window.dispatchEvent(new CustomEvent("show-notification",{detail:{type:"warning",message:t,importance:n}}))},showInfo(t,n="low"){window.dispatchEvent(new CustomEvent("show-notification",{detail:{type:"info",message:t,importance:n}}))}});At.data("appState",Vc);At.data("activities",Xc);At.data("timer",sl);At.data("timeline",ul);At.data("insights",cl);At.data("settings",pl);At.data("notifications",gl);At.start();export{Qc as c,Zc as g};
